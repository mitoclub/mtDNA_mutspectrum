medT_realm
rm(list = ls(all=TRUE))
library(ggplot2)
df_mtdna = read.csv('../Paper_materials/Birds_dataset_paper_extra.csv')
#Valya's new data
df_fly = read.csv('../Paper_materials/flying_birds.csv')
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('species_name', 'flightless', 'diving')
df_fly_mtdna = merge(df_mtdna, df_fly, by = 'species_name')
View(df_fly)
df_fly$diving_num = 0
df_fly_check = df_fly[df_fly$diving == 0,]
names_v = unique(df_mtdna$species_name)
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = sum(df1$Mass)/12
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
names(df_short) = c('species_name', 'GhAhSkew', 'ThChSkew', 'Mass')
View(df_short)
df_fly_check1 = df_fly[df_fly$diving != 0,]
df_fly_check1$diving_num = 1
df_fly_check = rbind(df_fly_check, df_fly_check1)
View(df_fly_check)
View(df_short)
df_median = merge(df_fly_check, df_short)
View(df_median)
ggplot(df_median(aes(x = diving_num, y = GhAhSkew)))+
geom_boxplot()
ggplot(df_median, (aes(x = diving_num, y = GhAhSkew)))+
geom_boxplot()
df_median$GhAhSkew = as.numeric(df_median$GhAhSkew)
ggplot(df_median, (aes(x = diving_num, y = GhAhSkew)))+
geom_boxplot()
ggplot(df_median, aes(x = diving_num, y = GhAhSkew))+
geom_boxplot()
df_median$diving_num = as.character(df_median$diving_num)
ggplot(df_median, aes(x = diving_num, y = GhAhSkew))+
geom_boxplot()
df_t1 = df_median[df_fly$median == '0',]
df_t1 = df_median[df_median$diving == '0',]
df_t2 = df_median[df_median$diving_num != '0',]
t.test(df_t1$GhAhSkew, df_t2$GhAhSkew)
ggplot(df_median, aes(x = diving_num, y = ThChSkew))+
geom_boxplot()
df_median$ThChSkew = as.numeric(df_median$ThChSkew)
ggplot(df_median, aes(x = diving_num, y = ThChSkew))+
geom_boxplot()
df_t1 = df_median[df_median$diving == '0',]
df_t2 = df_median[df_median$diving_num != '0',]
t.test(df_t1$GhAhSkew, df_t2$GhAhSkew)
t.test(df_t1$ThChSkew, df_t2$ThChSkew)
ggplot(df_median, aes(x = diving, y = GhAhSkew))+
geom_boxplot()
ggplot(df_median, aes(x = diving, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
View(df_mtdna)
df_mtdna[df_mtdna == 'Neognathae Charadriiformes Alcidae Aethia']
a = df_mtdna[df_mtdna$taxonomy == 'Neognathae Charadriiformes Alcidae Aethia']
a = df_mtdna[df_mtdna$taxonomy == 'Neognathae Charadriiformes Alcidae Aethia',]
View(a)
b = unique(a$taxonomy)
c1 = strsplit(b, split = ' ')
View(c1)
c1[1]
c1[2]
c1[1][1]
rm(list = ls(all=TRUE))
library(ggplot2)
df_mtdna = read.csv('../Paper_materials/Birds_dataset_paper_extra.csv')
names_v = unique(df_mtdna$species_name)
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = sum(df1$Mass)/12
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
View(df_short)
names(df_short) = c('species_name', 'GhAhSkew', 'ThChSkew', 'Mass')
df_short$Mass = as.numeric(df_short$Mass)
df_short$GhAhSkew = as.numeric(df_short$GhAhSkew)
df_short$ThChSkew = as.numeric(df_short$ThChSkew)
#Valya's new data
df_fly = read.csv('../Paper_materials/flying_birds.csv')
View(df_fly)
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('species_name', 'flightless', 'diving')
View(df_fly)
df_fly_clean1 = df_fly[df_fly$flightless =='Flightless',]
df_fly_clean= df_fly[df_fly$flightless == 'Almost_flightless',]
df_fly_clean = na.omit(df_fly_clean)
df_fly_clean1 = na.omit(df_fly_clean1)
df_fly = df_fly[df_fly$flightless != 'Flightless',]
df_fly = df_fly[df_fly$flightless != 'Almost_flightless',]
df_fly_clean$flightless = 'Tinamiformes'
df_fly_clean1$flightless = 'Tinamiformes'
df_fly = rbind(df_fly, df_fly_clean, df_fly_clean1)
df_eco = unique(df_eco)
df_eco = df_mtdna[,c('species_name','realm','Trophic_niche')]
df_eco = unique(df_eco)
df_fly = merge(df_fly, df_eco, by = 'species_name')
#Valya's new data
df_fly = read.csv('../Paper_materials/flying_birds.csv')
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('species_name', 'flightless', 'diving')
df_fly_clean1 = df_fly[df_fly$flightless =='Flightless',]
df_fly_clean= df_fly[df_fly$flightless == 'Almost_flightless',]
df_fly_clean = na.omit(df_fly_clean)
df_fly_clean1 = na.omit(df_fly_clean1)
df_fly = df_fly[df_fly$flightless != 'Flightless',]
df_fly = df_fly[df_fly$flightless != 'Almost_flightless',]
df_fly_clean$flightless = 'Tinamiformes'
df_fly_clean1$flightless = 'Tinamiformes'
View(df_eco)
df_fly = read.csv('../Paper_materials/flying_birds.csv')
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('species_name', 'flightless', 'diving')
df_fly_clean1 = df_fly[df_fly$flightless =='Flightless',]
df_fly_clean= df_fly[df_fly$flightless == 'Almost_flightless',]
df_fly_clean = na.omit(df_fly_clean)
df_fly_clean1 = na.omit(df_fly_clean1)
df_fly = df_fly[df_fly$flightless != 'Flightless',]
df_fly = df_fly[df_fly$flightless != 'Almost_flightless',]
df_fly_clean$flightless = 'Tinamiformes'
df_fly_clean1$flightless = 'Tinamiformes'
df_fly_big = rbind(df_fly, df_fly_clean, df_fly_clean1)
df_fly_big1 = merge(df_fly, df_eco)
View(df_fly_big1)
View(df_fly)
df_fly = read.csv('../Paper_materials/flying_birds.csv')
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('species_name', 'flightless', 'diving')
df_fly_clean1 = df_fly[df_fly$flightless =='Flightless',]
df_fly_clean= df_fly[df_fly$flightless == 'Almost_flightless',]
df_fly_clean = na.omit(df_fly_clean)
df_fly_clean1 = na.omit(df_fly_clean1)
df_fly = df_fly[df_fly$flightless != 'Flightless',]
df_fly = read.csv('../Paper_materials/flying_birds.csv')
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('species_name', 'flightless', 'diving')
df_fly_clean1 = df_fly[df_fly$flightless =='Flightless',]
df_fly_clean= df_fly[df_fly$flightless == 'Almost_flightless',]
df_fly_clean = na.omit(df_fly_clean)
df_fly_clean1 = na.omit(df_fly_clean1)
df_dive = df_fly
View(df_dive)
df_fly = df_fly[df_fly$flightless != 'Flightless',]
df_fly = df_fly[df_fly$flightless != 'Almost_flightless',]
df_fly_clean$flightless = 'Tinamiformes'
df_fly_clean1$flightless = 'Tinamiformes'
df_fly_big = rbind(df_fly, df_fly_clean, df_fly_clean1)
df_fly_big1 = merge(df_fly, df_eco)
df_fly_final = merge(df_fly_big1, df_short)
ggplot(df_fly_final, aes(x = flightless, y = ghahSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
ggplot(df_fly_final, aes(x = flightless, y = ThchSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
View(df_fly_final)
ggplot(df_fly_final, aes(x = flightless, y = ThChSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = ThChSkew))+
geom_boxplot(outlier.shape = NULL)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = ThChSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = ThChSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
df_dive_final = merge(df_dive. df_short)
df_dive_final = merge(df_dive. df_short, by = 'species_name')
df_dive_final = merge(df_dive, df_short, by = 'species_name')
ggplot(df_dive_final, aes(x = diving, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_dive_final, aes(x = diving, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
df_dive_final = df_dive_final[df_dive_final$diving != 'waterbird',]
ggplot(df_dive_final, aes(x = diving, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_dive_final, aes(x = diving, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
ggplot(df_dive_final, aes(x = diving, y = ThChSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
ggplot(df_dive_final, aes(x = diving, y = ThChSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_dive_final, aes(x = diving, y = ThChSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_dive_final, aes(x = diving, y = ThChSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
#stats
df_fly_zero = df_fly_final[df_fly_final$flightless == '0',]
View(df_fly_zero)
df_fly_no_zer0 = df_fly_final[df_fly_final$flightless != '0',]
t.test(df_fly_zero$GhAhSkew, df_fly_no_zer0$GhAhSkew)
View(df_fly_final)
df_fly_final$straus = '0'
unique(df_fly_final$diving)
unique(df_fly_final$flightless)
df_fly_straus = df_fly_final[df_fly_final$diving == 'Tinamiformes' | df_fly_final$diving == '"Casuariiformes' | df_fly_final$diving == 'Rheiformes' | df_fly_final$diving == 'Struthioniformes' | df_fly_final$diving == 'Apterygiformes',]
df_fly_straus = df_fly_final[(df_fly_final$diving == 'Tinamiformes') | (df_fly_final$diving == '"Casuariiformes') | (df_fly_final$diving == 'Rheiformes') | (df_fly_final$diving == 'Struthioniformes') | (df_fly_final$diving == 'Apterygiformes'),]
df_fly_straus1 = df_fly_final[df_fly_final$diving == 'Tinamiformes',]
df_fly_straus = df_fly_final[(df_fly_final$flightless == 'Tinamiformes') | (df_fly_final$flightless == '"Casuariiformes') | (df_fly_final$flightless == 'Rheiformes') | (df_fly_final$flightless == 'Struthioniformes') | (df_fly_final$flightless == 'Apterygiformes'),]
View(df_fly_straus)
df_fly_straus$straus = '1'
df_fly_no_straus = df_fly_final[(df_fly_final$flightless != 'Tinamiformes') | (df_fly_final$flightless != '"Casuariiformes') | (df_fly_final$flightless != 'Rheiformes') | (df_fly_final$flightless != 'Struthioniformes') | (df_fly_final$flightless != 'Apterygiformes'),]
df_fly_no_straus = df_fly_final[(df_fly_final$flightless != 'Tinamiformes') & (df_fly_final$flightless != '"Casuariiformes') & (df_fly_final$flightless != 'Rheiformes') & (df_fly_final$flightless != 'Struthioniformes') & (df_fly_final$flightless != 'Apterygiformes'),]
df_fly_no_straus1 = df_fly_final[df_fly_final$flightless != 'Tinamiformes',]
rm(df_fly_no_straus1)
rm(df_fly_straus1)
t.test(df_fly_straus$GhAhSkew, df_fly_no_straus$GhAhSkew)
df_fly_no_straus = df_fly_final[(df_fly_final$flightless != 'Tinamiformes') & (df_fly_final$flightless != '"Casuariiformes') & (df_fly_final$flightless != 'Rheiformes') & (df_fly_final$flightless != 'Struthioniformes') & (df_fly_final$flightless != 'Apterygiformes') & (df_fly_final$flightless != '0'),]
t.test(df_fly_straus$GhAhSkew, df_fly_no_straus$GhAhSkew)
unique(df_dive_final$diving)
t.test(df_dive_final[df_dive_final$diving =='Sphenisciformes']$GhAhSkew,df_dive_final[df_dive_final$diving =='Sphenisciformes']$0)
t.test(df_dive_final[df_dive_final$diving =='Sphenisciformes']$GhAhSkew,df_dive_final[df_dive_final$diving =='Sphenisciformes']$'0')
t.test(df_dive_final[df_dive_final$diving =='Sphenisciformes']$GhAhSkew,df_dive_final[df_dive_final$diving =='0']$GhAhSkew)
t.test(df_dive_final[df_dive_final$diving =='Sphenisciformes',]$GhAhSkew, df_dive_final[df_dive_final$diving =='0',]$GhAhSkew)
t.test(df_dive_final[df_dive_final$diving =='Anseriformes',]$GhAhSkew, df_dive_final[df_dive_final$diving =='0',]$GhAhSkew)
t.test(df_dive_final[(df_dive_final$diving !='Anseriformes') & (df_dive_final$diving !='Sphenisciformes'),]$GhAhSkew, df_dive_final[df_dive_final$diving =='0',]$GhAhSkew)
t.test(df_dive_final[(df_dive_final$diving !='Anseriformes') & (df_dive_final$diving !='Sphenisciformes') & (df_dive_final$diving !='0'),]$GhAhSkew, df_dive_final[df_dive_final$diving =='0',]$GhAhSkew)
rm(list = ls(all=TRUE))
library(ggplot2)
df_mtdna = read.csv('../Paper_materials/Birds_dataset_paper_extra.csv')
library(ggpubr)
graph1 = ggplot(data = df_mtdna, aes(x = gene_name, y = fTn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "Th")+
theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank(),
axis.title.y=element_blank(),axis.ticks.y=element_blank())
graph2 = ggplot(data = df_mtdna, aes(x = gene_name, y = fCn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "Ch")+
theme(axis.title.x=element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.title.y=element_blank(), axis.ticks.y=element_blank())
graph3 = ggplot(data = df_mtdna, aes(x = gene_name, y = fAn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "Ah")+
theme(axis.title.x=element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.title.y=element_blank(), axis.ticks.y=element_blank())
graph4 = ggplot(data = df_mtdna, aes(x = gene_name, y = fGn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "Gh")+
theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank(),
axis.title.y=element_blank(),axis.ticks.y=element_blank())
nd6fr= ggarrange(graph1, graph4, graph2, graph3,
ncol = 2, nrow = 2)
nd6fr
graph1 = ggplot(data = df_mtdna, aes(x = gene_name, y = fTn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "А")+
xlab('Митохондриальные гены')+
ylab('Частоты тимина')
graph2 = ggplot(data = df_mtdna, aes(x = gene_name, y = fCn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "В")+
xlab('Митохондриальные гены')+
ylab('Частоты цитозина')
graph3 = ggplot(data = df_mtdna, aes(x = gene_name, y = fAn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "Г")+
xlab('Митохондриальные гены')+
ylab('Частоты аденина')
graph4 = ggplot(data = df_mtdna, aes(x = gene_name, y = fGn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "Б")+
xlab('Митохондриальные гены')+
ylab('Частоты гуанина')
nd6fr= ggarrange(graph1, graph4, graph2, graph3,
ncol = 2, nrow = 2)
nd6fr
graph1 = ggplot(data = df_mtdna, aes(x = gene_name, y = fTn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "А")+
xlab('Митохондриальные гены')+
ylab('Частоты тимина')+
theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank(),
axis.title.y=element_blank(),axis.ticks.y=element_blank())
graph2 = ggplot(data = df_mtdna, aes(x = gene_name, y = fCn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "В")+
xlab('Митохондриальные гены')+
ylab('Частоты цитозина')+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
graph3 = ggplot(data = df_mtdna, aes(x = gene_name, y = fAn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "Г")+
xlab('Митохондриальные гены')+
ylab('Частоты аденина')+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
graph4 = ggplot(data = df_mtdna, aes(x = gene_name, y = fGn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "Б")+
xlab('Митохондриальные гены')+
ylab('Частоты гуанина')+
theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank(),
axis.title.y=element_blank(),axis.ticks.y=element_blank())
nd6fr= ggarrange(graph1, graph4, graph2, graph3,
ncol = 2, nrow = 2)
nd6fr
graph1 = ggplot(data = df_mtdna, aes(x = gene_name, y = fTn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "А")+
xlab('Митохондриальные гены')+
ylab('Частоты тимина')+
theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())        )
graph1 = ggplot(data = df_mtdna, aes(x = gene_name, y = fTn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "А")+
xlab('Митохондриальные гены')+
ylab('Частоты тимина')+
theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())
graph1
graph4 = ggplot(data = df_mtdna, aes(x = gene_name, y = fGn))+
geom_boxplot(notch = TRUE)+
xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB", "ND1","ND2"))+
ylim(0, 0.8)+
annotate("text", x=11, y=0.78, label= "Б")+
xlab('Митохондриальные гены')+
ylab('Частоты гуанина')+
theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())
nd6fr= ggarrange(graph1, graph4, graph2, graph3,
ncol = 2, nrow = 2)
nd6fr
names_v = unique(df_mtdna$species_name)
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = sum(df1$Mass)/12
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
names(df_short) = c('species_name', 'GhAhSkew', 'ThChSkew', 'Mass')
df_short$Mass = as.numeric(df_short$Mass)
df_short$GhAhSkew = as.numeric(df_short$GhAhSkew)
df_short$ThChSkew = as.numeric(df_short$ThChSkew)
#cleaning df_fly
rm(df_fly_clean)
df_fly = read.csv('../Paper_materials/flying_birds.csv')
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('species_name', 'flightless', 'diving')
df_fly_clean1 = df_fly[df_fly$flightless =='Flightless',]
df_fly_clean= df_fly[df_fly$flightless == 'Almost_flightless',]
df_fly_clean = na.omit(df_fly_clean)
df_fly_clean1 = na.omit(df_fly_clean1)
df_dive = df_fly
df_fly = df_fly[df_fly$flightless != 'Flightless',]
df_fly = df_fly[df_fly$flightless != 'Almost_flightless',]
df_fly_clean$flightless = 'Tinamiformes'
df_fly_clean1$flightless = 'Tinamiformes'
df_fly_big = rbind(df_fly, df_fly_clean, df_fly_clean1)
df_fly_big1 = merge(df_fly, df_eco)
df_fly_final = merge(df_fly_big1, df_short)
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df_eco = df_mtdna[,c('species_name','realm','Trophic_niche')]
df_fly_big1 = merge(df_fly, df_eco)
df_fly_final = merge(df_fly_big1, df_short)
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df_fly_final = df_fly_final[df_fly_final$flightless != 'Galliformes',]
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = ThChSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
ggplot(df_for_graph, aes(x = flightless, y = GhAhSkew, color=realm))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
View(df_fly_final)
df_fly_final = unique(df_fly_final)
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
#cleaning df_fly
rm(df_fly_clean)
df_fly = read.csv('../Paper_materials/flying_birds.csv')
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('species_name', 'flightless', 'diving')
df_fly_clean1 = df_fly[df_fly$flightless =='Flightless',]
df_fly_clean= df_fly[df_fly$flightless == 'Almost_flightless',]
df_fly_clean = na.omit(df_fly_clean)
df_fly_clean1 = na.omit(df_fly_clean1)
df_dive = df_fly
df_fly = df_fly[df_fly$flightless != 'Flightless',]
df_fly = df_fly[df_fly$flightless != 'Almost_flightless',]
df_fly_clean$flightless = 'Tinamiformes'
df_fly_clean1$flightless = 'Tinamiformes'
df_fly_big = rbind(df_fly, df_fly_clean, df_fly_clean1)
df_fly_big1 = merge(df_fly, df_eco)
df_fly_final = merge(df_fly_big1, df_short)
df_fly_final = unique(df_fly_final)
df_fly_final = df_fly_final[df_fly_final$flightless != 'Galliformes',]
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()+
ylab('Неспособность к полету')
ggplot(df_fly_final, aes(x = flightless, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()+
xlab('Неспособность к полету')
df_dive_final = merge(df_dive, df_short, by = 'species_name')
df_dive_final = df_dive_final[df_dive_final$diving != 'waterbird',]
ggplot(df_dive_final, aes(x = diving, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()
ggplot(df_dive_final, aes(x = diving, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()+
ylab('Способность к дайвингу')
ggplot(df_dive_final, aes(x = diving, y = GhAhSkew))+
geom_boxplot(outlier.shape = NA)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_jitter()+
xlab('Способность к дайвингу')
rm(list = ls(all=TRUE))
