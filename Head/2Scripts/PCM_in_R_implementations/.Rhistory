df_need = data.frame()
for (i in unique(df_names$species_name))
{
a = df_names[df_names$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
View(df_eco)
View(df_names)
View(df_need)
df_eco = df_eco[,c(2,3,4)]
names(df_eco) = c('species_name', 'Flight','Diving')
df_eco1 = merge(df_need, df_eco)
View(df_eco1)
df_eco1$species_name = gsub(' ', '_', df_eco$species_name)
df_eco1$species_name = gsub(' ', '_', df_eco1$species_name)
typeof(df_eco1$species_name)
df_eco1 = df_eco1[df_eco1$species_name != "Agapornis_pullarius",]
df_eco1 = df_eco1[df_eco1$species_name != "Mergus_squamatus",]
row.names(df_eco) = df_eco$species_name
row.names(df_eco1) = df_eco1$species_name
View(df_eco1)
name.check(birds_tree,df_eco1)
df_eco1 = na.omit(df_eco1)
name.check(birds_tree,df_eco1)
unique(df_eco1$Flight)
df_eco = df_eco1
df_eco0 = df_eco[df_eco$Flight == '0',]
df_eco1 = df_eco[df_eco$Flight == "Sphenisciformes",]
df_eco2 = df_eco[df_eco$Flight == "Apterygiformes",]
df_eco3 = df_eco[df_eco$Flight == "Gruiformes",]
df_eco4 = df_eco[df_eco$Flight == "Casuariiformes",]
df_eco5 = df_eco[df_eco$Flight == "Tinamiformes",]
df_eco6 = df_eco[df_eco$Flight == "Columbiformes",]
df_eco7 = df_eco[df_eco$Flight == "Rheiformes",]
df_eco8 = df_eco[df_eco$Flight == "Eurypygiformes",]
df_eco9 = df_eco[df_eco$Flight == "Psittaciformes",]
df_eco10 = df_eco[df_eco$Flight == "Struthioniformes",]
df_eco1$Flight = 1
df_eco2$Flight = 2
df_eco3$Flight = 3
df_eco4$Flight = 4
df_eco5$Flight = 5
df_eco6$Flight = 6
df_eco7$Flight = 7
df_eco8$Flight = 8
df_eco9$Flight = 9
df_eco10$Flight = 10
df_eco_cooler = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
unique(df_eco_cooler$Diving)
df_eco0 = df_eco_cooler[df_eco_cooler$Diving == '0',]
df_eco1 = df_eco_cooler[df_eco_cooler$Diving == "Charadriiformes",]
df_eco2 = df_eco_cooler[df_eco_cooler$Diving == "Anseriformes",]
df_eco3 = df_eco_cooler[df_eco_cooler$Diving == "Coraciiformes",]
df_eco4 = df_eco_cooler[df_eco_cooler$Diving == "Suliformes",]
df_eco5 = df_eco_cooler[df_eco_cooler$Diving == "Passeriformes",]
df_eco6 = df_eco_cooler[df_eco_cooler$Diving == "Procellariiformes",]
df_eco7 = df_eco_cooler[df_eco_cooler$Diving == "Gruiformes",]
df_eco8 = df_eco_cooler[df_eco_cooler$Diving == "Gaviiformes",]
df_eco9 = df_eco_cooler[df_eco_cooler$Diving == "Podicipediformes",]
df_eco10 = df_eco_cooler[df_eco_cooler$Diving == "Sphenisciformes",]
df_eco1$Diving = 1
df_eco2$Diving = 2
df_eco3$Diving = 3
df_eco4$Diving = 4
df_eco5$Diving = 5
df_eco6$Diving = 6
df_eco7$Diving = 7
df_eco8$Diving = 8
df_eco9$Diving = 9
df_eco10$Diving = 10
df_eco_cooler1 = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
View(df_eco_cooler)
#birds phyloPCA
rm(list = ls(all=TRUE))
#Reading and plotting tree
birds_tree<-read.tree(file="../../2Scripts/PCM_in_R_implementations/anc_kg.treefile")
birds_tree
plotTree(birds_tree,ftype="i", type = 'fan', fsize=0.4,lwd=1)
#Preparing data
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_eco = read.csv('flying_birds.csv')
df_names = df_mtdna[,c('species_name', 'ghahSkew')]
df_need = data.frame()
for (i in unique(df_names$species_name))
{
a = df_names[df_names$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_eco = df_eco[,c(2,3,4)]
names(df_eco) = c('species_name', 'Flight','Diving')
df_eco1 = merge(df_need, df_eco)
df_eco1$species_name = gsub(' ', '_', df_eco1$species_name)
typeof(df_eco1$species_name)
df_eco1 = df_eco1[df_eco1$species_name != "Agapornis_pullarius",]
df_eco1 = df_eco1[df_eco1$species_name != "Mergus_squamatus",]
row.names(df_eco1) = df_eco1$species_name
name.check(birds_tree,df_eco1)
df_eco1 = na.omit(df_eco1)
name.check(birds_tree,df_eco1)
unique(df_eco1$Flight)
df_eco = df_eco1
df_eco0 = df_eco[df_eco$Flight == '0',]
df_eco1 = df_eco[df_eco$Flight == "Sphenisciformes",]
df_eco2 = df_eco[df_eco$Flight == "Apterygiformes",]
df_eco3 = df_eco[df_eco$Flight == "Gruiformes",]
df_eco4 = df_eco[df_eco$Flight == "Casuariiformes",]
df_eco5 = df_eco[df_eco$Flight == "Tinamiformes",]
df_eco6 = df_eco[df_eco$Flight == "Columbiformes",]
df_eco7 = df_eco[df_eco$Flight == "Rheiformes",]
df_eco8 = df_eco[df_eco$Flight == "Eurypygiformes",]
df_eco9 = df_eco[df_eco$Flight == "Psittaciformes",]
df_eco10 = df_eco[df_eco$Flight == "Struthioniformes",]
df_eco1$Flight = 1
df_eco2$Flight = 1
df_eco3$Flight = 1
df_eco4$Flight = 1
df_eco5$Flight = 1
df_eco6$Flight = 1
df_eco7$Flight = 1
df_eco8$Flight = 1
df_eco9$Flight = 1
df_eco10$Flight = 1
df_eco_cooler = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
unique(df_eco_cooler$Diving)
df_eco0 = df_eco_cooler[df_eco_cooler$Diving == '0',]
df_eco1 = df_eco_cooler[df_eco_cooler$Diving == "Charadriiformes",]
df_eco2 = df_eco_cooler[df_eco_cooler$Diving == "Anseriformes",]
df_eco3 = df_eco_cooler[df_eco_cooler$Diving == "Coraciiformes",]
df_eco4 = df_eco_cooler[df_eco_cooler$Diving == "Suliformes",]
df_eco5 = df_eco_cooler[df_eco_cooler$Diving == "Passeriformes",]
df_eco6 = df_eco_cooler[df_eco_cooler$Diving == "Procellariiformes",]
df_eco7 = df_eco_cooler[df_eco_cooler$Diving == "Gruiformes",]
df_eco8 = df_eco_cooler[df_eco_cooler$Diving == "Gaviiformes",]
df_eco9 = df_eco_cooler[df_eco_cooler$Diving == "Podicipediformes",]
df_eco10 = df_eco_cooler[df_eco_cooler$Diving == "Sphenisciformes",]
df_eco1$Diving = 1
df_eco2$Diving = 1
df_eco3$Diving = 1
df_eco4$Diving = 1
df_eco5$Diving = 1
df_eco6$Diving = 1
df_eco7$Diving = 1
df_eco8$Diving = 1
df_eco9$Diving = 1
df_eco10$Diving = 1
df_eco_cooler1 = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
View(df_eco_cooler)
View(df_eco_cooler1)
df_flight_pca = df_eco_cooler[,c(2,3)]
df_dive_pca = df_eco_cooler1[,c(2,4)]
View(df_eco_cooler)
View(df_flight_pca)
View(df_eco_cooler)
a = setdiff(df_need$species_name, df_eco_cooler$species_name)
View(df_need)
df_need$species_name = gsub(' ', '_', df_need$species_name)
a = setdiff(df_need$species_name, df_eco_cooler$species_name)
not_fly_species = setdiff(df_need$species_name, df_eco_cooler$species_name)
flight_tree<-keep.tip(birds_tree,not_fly_species)
#birds phyloPCA
rm(list = ls(all=TRUE))
#Reading and plotting tree
birds_tree<-read.tree(file="../../2Scripts/PCM_in_R_implementations/anc_kg.treefile")
birds_tree
plotTree(birds_tree,ftype="i", type = 'fan', fsize=0.4,lwd=1)
#Preparing data
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_eco = read.csv('flying_birds.csv')
df_names = df_mtdna[,c('species_name', 'ghahSkew')]
df_need = data.frame()
for (i in unique(df_names$species_name))
{
a = df_names[df_names$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_eco = df_eco[,c(2,3,4)]
names(df_eco) = c('species_name', 'Flight','Diving')
df_eco1 = merge(df_need, df_eco)
df_eco1$species_name = gsub(' ', '_', df_eco1$species_name)
typeof(df_eco1$species_name)
df_eco1 = df_eco1[df_eco1$species_name != "Agapornis_pullarius",]
df_eco1 = df_eco1[df_eco1$species_name != "Mergus_squamatus",]
row.names(df_eco1) = df_eco1$species_name
name.check(birds_tree,df_eco1)
df_eco1 = na.omit(df_eco1)
name.check(birds_tree,df_eco1)
unique(df_eco1$Flight)
df_eco = df_eco1
df_eco0 = df_eco[df_eco$Flight == '0',]
df_eco1 = df_eco[df_eco$Flight == "Sphenisciformes",]
df_eco2 = df_eco[df_eco$Flight == "Apterygiformes",]
df_eco3 = df_eco[df_eco$Flight == "Gruiformes",]
df_eco4 = df_eco[df_eco$Flight == "Casuariiformes",]
df_eco5 = df_eco[df_eco$Flight == "Tinamiformes",]
df_eco6 = df_eco[df_eco$Flight == "Columbiformes",]
df_eco7 = df_eco[df_eco$Flight == "Rheiformes",]
df_eco8 = df_eco[df_eco$Flight == "Eurypygiformes",]
df_eco9 = df_eco[df_eco$Flight == "Psittaciformes",]
df_eco10 = df_eco[df_eco$Flight == "Struthioniformes",]
df_eco1$Flight = 1
df_eco2$Flight = 1
df_eco3$Flight = 1
df_eco4$Flight = 1
df_eco5$Flight = 1
df_eco6$Flight = 1
df_eco7$Flight = 1
df_eco8$Flight = 1
df_eco9$Flight = 1
df_eco10$Flight = 1
df_eco_cooler = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
unique(df_eco_cooler$Diving)
df_eco0 = df_eco_cooler[df_eco_cooler$Diving == '0',]
df_eco1 = df_eco_cooler[df_eco_cooler$Diving == "Charadriiformes",]
df_eco2 = df_eco_cooler[df_eco_cooler$Diving == "Anseriformes",]
df_eco3 = df_eco_cooler[df_eco_cooler$Diving == "Coraciiformes",]
df_eco4 = df_eco_cooler[df_eco_cooler$Diving == "Suliformes",]
df_eco5 = df_eco_cooler[df_eco_cooler$Diving == "Passeriformes",]
df_eco6 = df_eco_cooler[df_eco_cooler$Diving == "Procellariiformes",]
df_eco7 = df_eco_cooler[df_eco_cooler$Diving == "Gruiformes",]
df_eco8 = df_eco_cooler[df_eco_cooler$Diving == "Gaviiformes",]
df_eco9 = df_eco_cooler[df_eco_cooler$Diving == "Podicipediformes",]
df_eco10 = df_eco_cooler[df_eco_cooler$Diving == "Sphenisciformes",]
df_eco1$Diving = 1
df_eco2$Diving = 1
df_eco3$Diving = 1
df_eco4$Diving = 1
df_eco5$Diving = 1
df_eco6$Diving = 1
df_eco7$Diving = 1
df_eco8$Diving = 1
df_eco9$Diving = 1
df_eco10$Diving = 1
df_eco_cooler1 = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
df_flight_pca = df_eco_cooler[,c(2,3)]
df_need$species_name = gsub(' ', '_', df_need$species_name)
df_need = df_need[df_need$species_name != "Agapornis_pullarius",]
df_need = df_need[df_need$species_name != "Mergus_squamatus",]
not_fly_species = setdiff(df_need$species_name, df_eco_cooler$species_name)
flight_tree<-keep.tip(birds_tree,not_fly_species)
flight_tree
correct_not_fly_species = setdiff(df_need$species_name, not_fly_species)
flight_tree<-keep.tip(birds_tree,correct_not_fly_species)
flight_tree
write.tree(flight_tree ,file="flying_birds_tree.tre")
not_dive_species = setdiff(df_need$species_name, df_eco_cooler1$species_name)
correct_not_dive_species = setdiff(df_need$species_name, not_dive_species)
dive_tree<-keep.tip(birds_tree,correct_not_dive_species)
dive_tree
write.tree(dive_tree ,file="diving_birds_tree.tre")
View(df_eco_cooler)
View(df_flight_pca)
df_eco_cooler$Flight = as.numeric(as.character(df_eco_cooler$Flight))
df_eco_cooler1$Diving = as.numeric(as.character(df_eco_cooler1$Diving))
View(df_eco_cooler)
df_flight_pca = df_eco_cooler[,c(2,3)]
View(df_flight_pca)
View(df_eco_cooler1)
df_dive_pca = df_eco_cooler1[,c(2,4)]
df_flight_pca$Flight = as.numeric(as.character(df_flight_pca$Flight))
df_dive_pca$Diving = as.numeric(as.character(df_dive_pca$Diving))
#PhyloPCA flying birds
name.check(flight_tree, df_flight_pca)
flying_birds_pca<-phyl.pca(flight_tree,df_flight_pca)
View(df_flight_pca)
typeof(df_flight_pca$GhAhSkew)
df_flight_pca$GhAhSkew = as.numeric(as.character(df_flight_pca$GhAhSkew))
df_dive_pca$GhAhSkew = as.numeric(as.character(df_dive_pca$GhAhSkew))
#PhyloPCA flying birds
name.check(flight_tree, df_flight_pca)
flying_birds_pca<-phyl.pca(flight_tree,df_flight_pca)
flying_birds_pca
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(flying_birds_pca,main="")
flying_birds_pca$Evec[,1]<--flying_birds_pca$Evec[,1]
flying_birds_pca$L[,1]<--flying_birds_pca$L[,1]
flying_birds_pca$S<-scores(flying_birds_pca,
newdata=df_flight_pca)
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
#everything works until here
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
ecomorph<-read.csv(file="../../2Scripts/PCM_in_R_materials/ecomorph.csv",row.names=1,
header=TRUE,stringsAsFactors=TRUE)
View(ecomorph)
eco<-setNames(df_flight_pca[,c(1,2)],rownames(df_flight_pca))
eco<-setNames(flying_birds_pca[,1],rownames(flying_birds_pca))
eco<-setNames(flying_birds_pca[,2],rownames(flying_birds_pca))
#birds phyloPCA
rm(list = ls(all=TRUE))
#reading tree files
anolis.tree<-read.tree(file="../../2Scripts/PCM_in_R_materials/Anolis.tre.txt")
anolis.tree
plotTree(anolis.tree,ftype="i",fsize=0.4,lwd=1)
#Add arrows to a tree (pruning - extracting smaller tree)
pr.species<-c("cooki","poncensis",
"gundlachi","pulchellus","stratulus",
"krugi","evermanni","occultus","cuvieri",
"cristatellus")
nodes<-sapply(pr.species,grep,x=anolis.tree$tip.label)
nodes
plotTree(anolis.tree,type="fan",fsize=0.6,lwd=1,
ftype="i")
add.arrow(anolis.tree,tip=nodes,arrl=0.15,col="red",
offset=2)
anolis.noPR<-drop.tip(anolis.tree,pr.species)
plotTree(anolis.noPR,type="fan",fsize=0.6,lwd=1,
ftype="i")
#Extracting a clade
#MRCA - most recent common ancestor
node<-getMRCA(anolis.tree,pr.species[
-which(pr.species%in%c("cuvieri","occultus"))])
node
#Also painting tree
plot(paintSubTree(anolis.tree,node,"b","a"),
type="fan",fsize=0.6,lwd=2,
colors=setNames
(
c("gray","blue"),
c("a","b")),
ftype="i")
arc.cladelabels(anolis.tree,"clade to extract",node,
1.2,1.25,mark.node=FALSE,cex=0.6)
pr.clade<-extract.clade(anolis.tree,node)
pr.clade
pr.tree<-keep.tip(anolis.tree,pr.species)
pr.tree
par(mfrow=c(1,2))
plotTree(pr.clade,ftype="i",mar=c(1.1,1.1,3.1,1.1),
cex=1.1) #specific clad tree
mtext("(a)",line=0,adj=0)
plotTree(pr.tree,ftype="i",mar=c(1.1,1.1,3.1,1.1),
cex=1.1) #pruning tree
mtext("(b)",line=0,adj=0)
#Interactive pruning
anolis.pruned<-collapseTree(anolis.tree)
#multyphylo
anolis.trees<-c(anolis.tree,anolis.noPR,pr.clade,
pr.tree)
print(anolis.trees,details=TRUE)
#csv tree
anole.data<-read.csv(file="../../2Scripts/PCM_in_R_materials/anole.data.csv",row.names=1,
header=TRUE)
ecomorph<-read.csv(file="../../2Scripts/PCM_in_R_materials/ecomorph.csv",row.names=1,
header=TRUE,stringsAsFactors=TRUE)
View(ecomorph)
#comparing files then pruning
library(geiger)
name.check(anolis.tree,anole.data)
chk<-name.check(anolis.tree,ecomorph)
chk
ecomorph.tree<-drop.tip(anolis.tree,chk$tree_not_data)
ecomorph.tree
ecomorph.data<-anole.data[ecomorph.tree$tip.label,]
head(ecomorph.data)
name.check(ecomorph.tree,ecomorph.data)
View(ecomorph.data)
View(anole.data)
eco<-setNames(ecomorph[,1],rownames(ecomorph))
#phylopca!!!
ecomorph.pca<-phyl.pca(ecomorph.tree,ecomorph.data)
ecomorph.pca
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(ecomorph.pca,main="")
ecomorph.pca$Evec[,1]<--ecomorph.pca$Evec[,1]
ecomorph.pca$L[,1]<--ecomorph.pca$L[,1]
ecomorph.pca$S<-scores(ecomorph.pca,
newdata=ecomorph.data)
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(ecomorph.tree,
scores(ecomorph.pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1 (overall size)",
ylab=expression(paste("PC2 ("%up%"lamellae number, "
%down%"tail length)")))
eco<-setNames(ecomorph[,1],rownames(ecomorph))
#birds phyloPCA
rm(list = ls(all=TRUE))
#Reading and plotting tree
birds_tree<-read.tree(file="../../2Scripts/PCM_in_R_implementations/anc_kg.treefile")
birds_tree
plotTree(birds_tree,ftype="i", type = 'fan', fsize=0.4,lwd=1)
#Preparing data
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_eco = read.csv('flying_birds.csv')
df_names = df_mtdna[,c('species_name', 'ghahSkew')]
df_need = data.frame()
for (i in unique(df_names$species_name))
{
a = df_names[df_names$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_eco = df_eco[,c(2,3,4)]
names(df_eco) = c('species_name', 'Flight','Diving')
df_eco1 = merge(df_need, df_eco)
df_eco1$species_name = gsub(' ', '_', df_eco1$species_name)
typeof(df_eco1$species_name)
df_eco1 = df_eco1[df_eco1$species_name != "Agapornis_pullarius",]
df_eco1 = df_eco1[df_eco1$species_name != "Mergus_squamatus",]
row.names(df_eco1) = df_eco1$species_name
name.check(birds_tree,df_eco1)
df_eco1 = na.omit(df_eco1)
name.check(birds_tree,df_eco1)
unique(df_eco1$Flight)
df_eco = df_eco1
df_eco0 = df_eco[df_eco$Flight == '0',]
df_eco1 = df_eco[df_eco$Flight == "Sphenisciformes",]
df_eco2 = df_eco[df_eco$Flight == "Apterygiformes",]
df_eco3 = df_eco[df_eco$Flight == "Gruiformes",]
df_eco4 = df_eco[df_eco$Flight == "Casuariiformes",]
df_eco5 = df_eco[df_eco$Flight == "Tinamiformes",]
df_eco6 = df_eco[df_eco$Flight == "Columbiformes",]
df_eco7 = df_eco[df_eco$Flight == "Rheiformes",]
df_eco8 = df_eco[df_eco$Flight == "Eurypygiformes",]
df_eco9 = df_eco[df_eco$Flight == "Psittaciformes",]
df_eco10 = df_eco[df_eco$Flight == "Struthioniformes",]
df_eco1$Flight = 1
df_eco2$Flight = 1
df_eco3$Flight = 1
df_eco4$Flight = 1
df_eco5$Flight = 1
df_eco6$Flight = 1
df_eco7$Flight = 1
df_eco8$Flight = 1
df_eco9$Flight = 1
df_eco10$Flight = 1
df_eco_cooler = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
unique(df_eco_cooler$Diving)
df_eco0 = df_eco_cooler[df_eco_cooler$Diving == '0',]
df_eco1 = df_eco_cooler[df_eco_cooler$Diving == "Charadriiformes",]
df_eco2 = df_eco_cooler[df_eco_cooler$Diving == "Anseriformes",]
df_eco3 = df_eco_cooler[df_eco_cooler$Diving == "Coraciiformes",]
df_eco4 = df_eco_cooler[df_eco_cooler$Diving == "Suliformes",]
df_eco5 = df_eco_cooler[df_eco_cooler$Diving == "Passeriformes",]
df_eco6 = df_eco_cooler[df_eco_cooler$Diving == "Procellariiformes",]
df_eco7 = df_eco_cooler[df_eco_cooler$Diving == "Gruiformes",]
df_eco8 = df_eco_cooler[df_eco_cooler$Diving == "Gaviiformes",]
df_eco9 = df_eco_cooler[df_eco_cooler$Diving == "Podicipediformes",]
df_eco10 = df_eco_cooler[df_eco_cooler$Diving == "Sphenisciformes",]
df_eco1$Diving = 1
df_eco2$Diving = 1
df_eco3$Diving = 1
df_eco4$Diving = 1
df_eco5$Diving = 1
df_eco6$Diving = 1
df_eco7$Diving = 1
df_eco8$Diving = 1
df_eco9$Diving = 1
df_eco10$Diving = 1
df_eco_cooler1 = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
df_flight_pca = df_eco_cooler[,c(2,3)]
df_need$species_name = gsub(' ', '_', df_need$species_name)
df_need = df_need[df_need$species_name != "Agapornis_pullarius",]
df_need = df_need[df_need$species_name != "Mergus_squamatus",]
not_fly_species = setdiff(df_need$species_name, df_eco_cooler$species_name)
correct_not_fly_species = setdiff(df_need$species_name, not_fly_species)
flight_tree<-keep.tip(birds_tree,correct_not_fly_species)
flight_tree
not_dive_species = setdiff(df_need$species_name, df_eco_cooler1$species_name)
correct_not_dive_species = setdiff(df_need$species_name, not_dive_species)
dive_tree<-keep.tip(birds_tree,correct_not_dive_species)
dive_tree
df_flight_pca = df_eco_cooler[,c(2,3)]
df_dive_pca = df_eco_cooler1[,c(2,4)]
df_flight_pca$Flight = as.numeric(as.character(df_flight_pca$Flight))
df_dive_pca$Diving = as.numeric(as.character(df_dive_pca$Diving))
df_flight_pca$GhAhSkew = as.numeric(as.character(df_flight_pca$GhAhSkew))
df_dive_pca$GhAhSkew = as.numeric(as.character(df_dive_pca$GhAhSkew))
#PhyloPCA flying birds
name.check(flight_tree, df_flight_pca)
flying_birds_pca<-phyl.pca(flight_tree,df_flight_pca)
flying_birds_pca
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(flying_birds_pca,main="")
flying_birds_pca$Evec[,1]<--flying_birds_pca$Evec[,1]
flying_birds_pca$L[,1]<--flying_birds_pca$L[,1]
flying_birds_pca$S<-scores(flying_birds_pca,
newdata=df_flight_pca)
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
#everything works until here
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
View(flying_birds_pca)
View(df_flight_pca)
#color legend!!!!
eco<-setNames(df_flight_pca[,2],rownames(flying_birds_pca))
ECO<-to.matrix(eco,levels(eco))
legend(x="bottomright",legend=levels(eco),cex=0.8,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
tiplabels(pie=eco[flight_tree$tip.label,],cex=0.5)
#color legend!!!! do later
eco<-setNames(df_flight_pca[,2],rownames(df_flight_pca))
ECO<-to.matrix(eco,levels(eco))
#birds phyloPCA
rm(list = ls(all=TRUE))
