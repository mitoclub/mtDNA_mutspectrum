View(flying_birds_pca)
View(df_flight_pca)
#color legend!!!!
eco<-setNames(df_flight_pca[,2],rownames(flying_birds_pca))
ECO<-to.matrix(eco,levels(eco))
legend(x="bottomright",legend=levels(eco),cex=0.8,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
tiplabels(pie=eco[flight_tree$tip.label,],cex=0.5)
#color legend!!!! do later
eco<-setNames(df_flight_pca[,2],rownames(df_flight_pca))
ECO<-to.matrix(eco,levels(eco))
#birds phyloPCA
rm(list = ls(all=TRUE))
library(ape)
library(phangorn)
library(phytools)
library(geiger)
#Reading and plotting tree
birds_tree<-read.tree(file="../../2Scripts/PCM_in_R_implementations/anc_kg.treefile")
birds_tree
plotTree(birds_tree,ftype="i", type = 'fan', fsize=0.4,lwd=1)
#Preparing data
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_eco = read.csv('flying_birds.csv')
df_names = df_mtdna[,c('species_name', 'ghahSkew')]
df_need = data.frame()
for (i in unique(df_names$species_name))
{
a = df_names[df_names$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_eco = df_eco[,c(2,3,4)]
names(df_eco) = c('species_name', 'Flight','Diving')
df_eco1 = merge(df_need, df_eco)
df_eco1$species_name = gsub(' ', '_', df_eco1$species_name)
typeof(df_eco1$species_name)
df_eco1 = df_eco1[df_eco1$species_name != "Agapornis_pullarius",]
df_eco1 = df_eco1[df_eco1$species_name != "Mergus_squamatus",]
row.names(df_eco1) = df_eco1$species_name
name.check(birds_tree,df_eco1)
df_eco1 = na.omit(df_eco1)
name.check(birds_tree,df_eco1)
unique(df_eco1$Flight)
df_eco = df_eco1
df_eco0 = df_eco[df_eco$Flight == '0',]
df_eco1 = df_eco[df_eco$Flight == "Sphenisciformes",]
df_eco2 = df_eco[df_eco$Flight == "Apterygiformes",]
df_eco3 = df_eco[df_eco$Flight == "Gruiformes",]
df_eco4 = df_eco[df_eco$Flight == "Casuariiformes",]
df_eco5 = df_eco[df_eco$Flight == "Tinamiformes",]
df_eco6 = df_eco[df_eco$Flight == "Columbiformes",]
df_eco7 = df_eco[df_eco$Flight == "Rheiformes",]
df_eco8 = df_eco[df_eco$Flight == "Eurypygiformes",]
df_eco9 = df_eco[df_eco$Flight == "Psittaciformes",]
df_eco10 = df_eco[df_eco$Flight == "Struthioniformes",]
df_eco1$Flight = 1
df_eco2$Flight = 1
df_eco3$Flight = 1
df_eco4$Flight = 1
df_eco5$Flight = 1
df_eco6$Flight = 1
df_eco7$Flight = 1
df_eco8$Flight = 1
df_eco9$Flight = 1
df_eco10$Flight = 1
df_eco_cooler = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
unique(df_eco_cooler$Diving)
df_eco0 = df_eco_cooler[df_eco_cooler$Diving == '0',]
df_eco1 = df_eco_cooler[df_eco_cooler$Diving == "Charadriiformes",]
df_eco2 = df_eco_cooler[df_eco_cooler$Diving == "Anseriformes",]
df_eco3 = df_eco_cooler[df_eco_cooler$Diving == "Coraciiformes",]
df_eco4 = df_eco_cooler[df_eco_cooler$Diving == "Suliformes",]
df_eco5 = df_eco_cooler[df_eco_cooler$Diving == "Passeriformes",]
df_eco6 = df_eco_cooler[df_eco_cooler$Diving == "Procellariiformes",]
df_eco7 = df_eco_cooler[df_eco_cooler$Diving == "Gruiformes",]
df_eco8 = df_eco_cooler[df_eco_cooler$Diving == "Gaviiformes",]
df_eco9 = df_eco_cooler[df_eco_cooler$Diving == "Podicipediformes",]
df_eco10 = df_eco_cooler[df_eco_cooler$Diving == "Sphenisciformes",]
df_eco1$Diving = 1
df_eco2$Diving = 1
df_eco3$Diving = 1
df_eco4$Diving = 1
df_eco5$Diving = 1
df_eco6$Diving = 1
df_eco7$Diving = 1
df_eco8$Diving = 1
df_eco9$Diving = 1
df_eco10$Diving = 1
df_eco_cooler1 = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
df_flight_pca = df_eco_cooler[,c(2,3)]
df_need$species_name = gsub(' ', '_', df_need$species_name)
df_need = df_need[df_need$species_name != "Agapornis_pullarius",]
df_need = df_need[df_need$species_name != "Mergus_squamatus",]
not_fly_species = setdiff(df_need$species_name, df_eco_cooler$species_name)
correct_not_fly_species = setdiff(df_need$species_name, not_fly_species)
flight_tree<-keep.tip(birds_tree,correct_not_fly_species)
flight_tree
not_dive_species = setdiff(df_need$species_name, df_eco_cooler1$species_name)
correct_not_dive_species = setdiff(df_need$species_name, not_dive_species)
dive_tree<-keep.tip(birds_tree,correct_not_dive_species)
dive_tree
df_flight_pca = df_eco_cooler[,c(2,3)]
df_dive_pca = df_eco_cooler1[,c(2,4)]
df_flight_pca$Flight = as.numeric(as.character(df_flight_pca$Flight))
df_dive_pca$Diving = as.numeric(as.character(df_dive_pca$Diving))
df_flight_pca$GhAhSkew = as.numeric(as.character(df_flight_pca$GhAhSkew))
df_dive_pca$GhAhSkew = as.numeric(as.character(df_dive_pca$GhAhSkew))
#PhyloPCA flying birds
name.check(flight_tree, df_flight_pca)
flying_birds_pca<-phyl.pca(flight_tree,df_flight_pca)
flying_birds_pca
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(flying_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
View(df_eco_cooler)
#color legend!!!! do later
eco<-setNames(df_eco_cooler[,3],rownames(df_eco_cooler))
ECO<-to.matrix(eco,levels(eco))
#color legend!!!! do later
df_flight_names = df_eco_cooler[,c(1,3)]
View(df_flight_names)
df_flight_names[df_flight_names$Flight == '0',]$Flight = 'Flying'
df_eco = df_eco1
df_eco0 = df_eco[df_eco$Flight == '0',]
df_eco1 = df_eco[df_eco$Flight == "Sphenisciformes",]
df_eco2 = df_eco[df_eco$Flight == "Apterygiformes",]
df_eco3 = df_eco[df_eco$Flight == "Gruiformes",]
df_eco4 = df_eco[df_eco$Flight == "Casuariiformes",]
df_eco5 = df_eco[df_eco$Flight == "Tinamiformes",]
df_eco6 = df_eco[df_eco$Flight == "Columbiformes",]
df_eco7 = df_eco[df_eco$Flight == "Rheiformes",]
df_eco8 = df_eco[df_eco$Flight == "Eurypygiformes",]
df_eco9 = df_eco[df_eco$Flight == "Psittaciformes",]
df_eco10 = df_eco[df_eco$Flight == "Struthioniformes",]
df_flight_names = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
View(df_flight_names)
#birds phyloPCA
rm(list = ls(all=TRUE))
#Reading and plotting tree
birds_tree<-read.tree(file="../../2Scripts/PCM_in_R_implementations/anc_kg.treefile")
birds_tree
plotTree(birds_tree,ftype="i", type = 'fan', fsize=0.4,lwd=1)
#Preparing data
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_eco = read.csv('flying_birds.csv')
df_names = df_mtdna[,c('species_name', 'ghahSkew')]
df_need = data.frame()
for (i in unique(df_names$species_name))
{
a = df_names[df_names$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_eco = df_eco[,c(2,3,4)]
names(df_eco) = c('species_name', 'Flight','Diving')
df_eco1 = merge(df_need, df_eco)
df_eco1$species_name = gsub(' ', '_', df_eco1$species_name)
typeof(df_eco1$species_name)
df_eco1 = df_eco1[df_eco1$species_name != "Agapornis_pullarius",]
df_eco1 = df_eco1[df_eco1$species_name != "Mergus_squamatus",]
row.names(df_eco1) = df_eco1$species_name
name.check(birds_tree,df_eco1)
df_eco1 = na.omit(df_eco1)
name.check(birds_tree,df_eco1)
unique(df_eco1$Flight)
df_eco = df_eco1
df_eco0 = df_eco[df_eco$Flight == '0',]
df_eco1 = df_eco[df_eco$Flight == "Sphenisciformes",]
df_eco2 = df_eco[df_eco$Flight == "Apterygiformes",]
df_eco3 = df_eco[df_eco$Flight == "Gruiformes",]
df_eco4 = df_eco[df_eco$Flight == "Casuariiformes",]
df_eco5 = df_eco[df_eco$Flight == "Tinamiformes",]
df_eco6 = df_eco[df_eco$Flight == "Columbiformes",]
df_eco7 = df_eco[df_eco$Flight == "Rheiformes",]
df_eco8 = df_eco[df_eco$Flight == "Eurypygiformes",]
df_eco9 = df_eco[df_eco$Flight == "Psittaciformes",]
df_eco10 = df_eco[df_eco$Flight == "Struthioniformes",]
df_flight_names = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
df_eco1$Flight = 1
df_eco2$Flight = 1
df_eco3$Flight = 1
df_eco4$Flight = 1
df_eco5$Flight = 1
df_eco6$Flight = 1
df_eco7$Flight = 1
df_eco8$Flight = 1
df_eco9$Flight = 1
df_eco10$Flight = 1
df_eco_cooler = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
unique(df_eco_cooler$Diving)
df_eco0 = df_eco_cooler[df_eco_cooler$Diving == '0',]
df_eco1 = df_eco_cooler[df_eco_cooler$Diving == "Charadriiformes",]
df_eco2 = df_eco_cooler[df_eco_cooler$Diving == "Anseriformes",]
df_eco3 = df_eco_cooler[df_eco_cooler$Diving == "Coraciiformes",]
df_eco4 = df_eco_cooler[df_eco_cooler$Diving == "Suliformes",]
df_eco5 = df_eco_cooler[df_eco_cooler$Diving == "Passeriformes",]
df_eco6 = df_eco_cooler[df_eco_cooler$Diving == "Procellariiformes",]
df_eco7 = df_eco_cooler[df_eco_cooler$Diving == "Gruiformes",]
df_eco8 = df_eco_cooler[df_eco_cooler$Diving == "Gaviiformes",]
df_eco9 = df_eco_cooler[df_eco_cooler$Diving == "Podicipediformes",]
df_eco10 = df_eco_cooler[df_eco_cooler$Diving == "Sphenisciformes",]
df_dive_names = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
df_eco1$Diving = 1
df_eco2$Diving = 1
df_eco3$Diving = 1
df_eco4$Diving = 1
df_eco5$Diving = 1
df_eco6$Diving = 1
df_eco7$Diving = 1
df_eco8$Diving = 1
df_eco9$Diving = 1
df_eco10$Diving = 1
df_eco_cooler1 = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
df_flight_pca = df_eco_cooler[,c(2,3)]
df_need$species_name = gsub(' ', '_', df_need$species_name)
df_need = df_need[df_need$species_name != "Agapornis_pullarius",]
df_need = df_need[df_need$species_name != "Mergus_squamatus",]
not_fly_species = setdiff(df_need$species_name, df_eco_cooler$species_name)
correct_not_fly_species = setdiff(df_need$species_name, not_fly_species)
flight_tree<-keep.tip(birds_tree,correct_not_fly_species)
flight_tree
write.tree(flight_tree ,file="flying_birds_tree.tre")
not_dive_species = setdiff(df_need$species_name, df_eco_cooler1$species_name)
correct_not_dive_species = setdiff(df_need$species_name, not_dive_species)
dive_tree<-keep.tip(birds_tree,correct_not_dive_species)
dive_tree
df_flight_pca = df_eco_cooler[,c(2,3)]
df_dive_pca = df_eco_cooler1[,c(2,4)]
df_flight_pca$Flight = as.numeric(as.character(df_flight_pca$Flight))
df_dive_pca$Diving = as.numeric(as.character(df_dive_pca$Diving))
df_flight_pca$GhAhSkew = as.numeric(as.character(df_flight_pca$GhAhSkew))
df_dive_pca$GhAhSkew = as.numeric(as.character(df_dive_pca$GhAhSkew))
#PhyloPCA flying birds
name.check(flight_tree, df_flight_pca)
flying_birds_pca<-phyl.pca(flight_tree,df_flight_pca)
flying_birds_pca
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(flying_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_flight_names = df_eco_cooler[,c(1,3)]
df_flight_names[df_flight_names$Flight == '0',]$Flight = 'Flying'
View(df_flight_names)
#birds phyloPCA
rm(list = ls(all=TRUE))
#Reading and plotting tree
birds_tree<-read.tree(file="../../2Scripts/PCM_in_R_implementations/anc_kg.treefile")
birds_tree
plotTree(birds_tree,ftype="i", type = 'fan', fsize=0.4,lwd=1)
#Preparing data
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_eco = read.csv('flying_birds.csv')
df_names = df_mtdna[,c('species_name', 'ghahSkew')]
df_need = data.frame()
for (i in unique(df_names$species_name))
{
a = df_names[df_names$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_eco = df_eco[,c(2,3,4)]
names(df_eco) = c('species_name', 'Flight','Diving')
df_eco1 = merge(df_need, df_eco)
df_eco1$species_name = gsub(' ', '_', df_eco1$species_name)
typeof(df_eco1$species_name)
df_eco1 = df_eco1[df_eco1$species_name != "Agapornis_pullarius",]
df_eco1 = df_eco1[df_eco1$species_name != "Mergus_squamatus",]
row.names(df_eco1) = df_eco1$species_name
name.check(birds_tree,df_eco1)
df_eco1 = na.omit(df_eco1)
name.check(birds_tree,df_eco1)
unique(df_eco1$Flight)
df_eco = df_eco1
df_eco0 = df_eco[df_eco$Flight == '0',]
df_eco1 = df_eco[df_eco$Flight == "Sphenisciformes",]
df_eco2 = df_eco[df_eco$Flight == "Apterygiformes",]
df_eco3 = df_eco[df_eco$Flight == "Gruiformes",]
df_eco4 = df_eco[df_eco$Flight == "Casuariiformes",]
df_eco5 = df_eco[df_eco$Flight == "Tinamiformes",]
df_eco6 = df_eco[df_eco$Flight == "Columbiformes",]
df_eco7 = df_eco[df_eco$Flight == "Rheiformes",]
df_eco8 = df_eco[df_eco$Flight == "Eurypygiformes",]
df_eco9 = df_eco[df_eco$Flight == "Psittaciformes",]
df_eco10 = df_eco[df_eco$Flight == "Struthioniformes",]
df_flight_names = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
df_eco1$Flight = 1
df_eco2$Flight = 1
df_eco3$Flight = 1
df_eco4$Flight = 1
df_eco5$Flight = 1
df_eco6$Flight = 1
df_eco7$Flight = 1
df_eco8$Flight = 1
df_eco9$Flight = 1
df_eco10$Flight = 1
df_eco_cooler = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
unique(df_eco_cooler$Diving)
df_eco0 = df_eco_cooler[df_eco_cooler$Diving == '0',]
df_eco1 = df_eco_cooler[df_eco_cooler$Diving == "Charadriiformes",]
df_eco2 = df_eco_cooler[df_eco_cooler$Diving == "Anseriformes",]
df_eco3 = df_eco_cooler[df_eco_cooler$Diving == "Coraciiformes",]
df_eco4 = df_eco_cooler[df_eco_cooler$Diving == "Suliformes",]
df_eco5 = df_eco_cooler[df_eco_cooler$Diving == "Passeriformes",]
df_eco6 = df_eco_cooler[df_eco_cooler$Diving == "Procellariiformes",]
df_eco7 = df_eco_cooler[df_eco_cooler$Diving == "Gruiformes",]
df_eco8 = df_eco_cooler[df_eco_cooler$Diving == "Gaviiformes",]
df_eco9 = df_eco_cooler[df_eco_cooler$Diving == "Podicipediformes",]
df_eco10 = df_eco_cooler[df_eco_cooler$Diving == "Sphenisciformes",]
df_dive_names = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
df_eco1$Diving = 1
df_eco2$Diving = 1
df_eco3$Diving = 1
df_eco4$Diving = 1
df_eco5$Diving = 1
df_eco6$Diving = 1
df_eco7$Diving = 1
df_eco8$Diving = 1
df_eco9$Diving = 1
df_eco10$Diving = 1
df_eco_cooler1 = rbind(df_eco0, df_eco1, df_eco2, df_eco3, df_eco4, df_eco5, df_eco6, df_eco7, df_eco8, df_eco9, df_eco10)
df_flight_pca = df_eco_cooler[,c(2,3)]
df_need$species_name = gsub(' ', '_', df_need$species_name)
df_need = df_need[df_need$species_name != "Agapornis_pullarius",]
df_need = df_need[df_need$species_name != "Mergus_squamatus",]
not_fly_species = setdiff(df_need$species_name, df_eco_cooler$species_name)
correct_not_fly_species = setdiff(df_need$species_name, not_fly_species)
flight_tree<-keep.tip(birds_tree,correct_not_fly_species)
flight_tree
not_dive_species = setdiff(df_need$species_name, df_eco_cooler1$species_name)
correct_not_dive_species = setdiff(df_need$species_name, not_dive_species)
dive_tree<-keep.tip(birds_tree,correct_not_dive_species)
dive_tree
df_flight_pca = df_eco_cooler[,c(2,3)]
df_dive_pca = df_eco_cooler1[,c(2,4)]
df_flight_pca$Flight = as.numeric(as.character(df_flight_pca$Flight))
df_dive_pca$Diving = as.numeric(as.character(df_dive_pca$Diving))
df_flight_pca$GhAhSkew = as.numeric(as.character(df_flight_pca$GhAhSkew))
df_dive_pca$GhAhSkew = as.numeric(as.character(df_dive_pca$GhAhSkew))
#PhyloPCA flying birds
name.check(flight_tree, df_flight_pca)
flying_birds_pca<-phyl.pca(flight_tree,df_flight_pca)
flying_birds_pca
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(flying_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
df_flight_names[df_flight_names$Flight == '0',]$Flight = 'Flying'
View(df_flight_names)
eco<-setNames(df_flight_names[,3],rownames(df_flight_names))
ECO<-to.matrix(eco,levels(eco))
unique(df_flight_names$Flight)
df_flight_names$Flight = as.factor(df_flight_names$Flight)
eco<-setNames(df_flight_names[,3],rownames(df_flight_names))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=eco[flight_tree$tip.label,],cex=0.5)
tiplabels(pie=ECO[flight_tree$tip.label,],cex=0.5)
legend(x="bottomright",legend=levels(eco),cex=0.8,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
legend(x="bottomright",legend=levels(eco),cex=0.1,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
legend(x="bottomright",legend=levels(eco),cex=0.4,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
legend(x="bottomright",legend=levels(eco),cex=0.4,pch=15,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
legend(x="bottomright",legend=levels(eco),cex=0.4,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
legend(x="bottomright",legend=levels(eco),cex=0.4,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.0)
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
df_flight_names[df_flight_names$Flight == '0',]$Flight = 'Flying'
df_flight_names$Flight = as.factor(df_flight_names$Flight)
eco<-setNames(df_flight_names[,3],rownames(df_flight_names))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[flight_tree$tip.label,],cex=0.5)
legend(x="center",legend=levels(eco),cex=0.8,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
df_flight_names[df_flight_names$Flight == '0',]$Flight = 'Flying'
eco<-setNames(df_flight_names[,3],rownames(df_flight_names))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[flight_tree$tip.label,],cex=0.5)
View(df_mtdna)
#Correct PCA
df_mtdna$
df_metrics_AG = df_mtdna[,c('species_name','ghahSkew', 'fAn', 'fGn')]
df_metrics_AG = df_mtdna[,c('species_name','ghahSkew', 'fAn', 'fGn')]
View(df_metrics_AG)
df_metrics_AG_clean = data.frame()
for (i in unique(df_metrics_AG$species_name))
{
a = df_metrics_AG[df_metrics_AG$species_name == i,]
b = sum(a$ghahSkew)/12
c = sum(a$fAn)/12
d = sum(a$fGn)/12
ab = c(i,b,c,d)
df_metrics_AG_clean = rbind(df_metrics_AG_clean, ab)
}
View(df_flight_pca)
View(df_eco_cooler)
df_correct_flight_pca = merge(df_eco_cooler, df_metrics_AG_clean)
View(df_correct_flight_pca)
names(df_metrics_AG_clean) =c('species_name', 'GhAhSkew', 'fAn', 'fGn')
View(df_metrics_AG_clean)
df_metrics_AG_clean$species_name = gsub(' ', '_', df_metrics_AG_clean$species_name)
df_correct_flight_pca = merge(df_eco_cooler, df_metrics_AG_clean)
View(df_correct_flight_pca)
rownames(df_correct_flight_pca) = df_correct_flight_pca$species_name
name.check(flight_tree, df_correct_flight_pca)
df_correct_flight_pca = df_correct_flight_pca[,c(2,5,6)]
df_correct_flight_pca = df_correct_flight_pca[,c(2,5,6)]
flying_birds_pca<-phyl.pca(flight_tree,df_correct_flight_pca)
df_correct_flight_pca$GhAhSkew = as.numeric(as.character(df_correct_flight_pca$GhAhSkew))
df_correct_flight_pca$fAn= as.numeric(as.character(df_correct_flight_pca$fAn))
df_correct_flight_pca$fGn = as.numeric(as.character(df_correct_flight_pca$fGn))
flying_birds_pca<-phyl.pca(flight_tree,df_correct_flight_pca)
flying_birds_pca
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(flying_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
df_flight_names[df_flight_names$Flight == '0',]$Flight = 'Flying'
eco<-setNames(df_flight_names[,3],rownames(df_flight_names))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[flight_tree$tip.label,],cex=0.5)
tiplabels(pie=ECO[flight_tree$tip.label,],cex=0.1)
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
tiplabels(pie=ECO[flight_tree$tip.label,],cex=0.1)
tiplabels(pie=ECO[flight_tree$tip.label,],cex=0.2)
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
tiplabels(pie=ECO[flight_tree$tip.label,],cex=0.2)
phylomorphospace(flight_tree,
scores(flying_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
tiplabels(pie=ECO[flight_tree$tip.label,],cex=0.3)
legend(x="center",legend=levels(eco),cex=0.8,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
View(df_metrics_AG_clean)
View(df_dive_pca)
View(df_dive_names)
#diving PCA
df_correct_dive_pca = merge(df_metrics_AG_clean,  df_dive_names)
View(df_correct_dive_pca)
View(df_dive_names)
df_dive_names[df_dive_names$Diving == '0',]$Diving = 'Non-diving'
df_dive_names$Diving = as.factor(df_dive_names$Diving)
rownames(df_correct_dive_pca) = df_correct_dive_pca$species_name
df_correct_dive_pca = df_correct_dive_pca[,c(2,3,4)]
name.check(dive_tree, df_correct_dive_pca)
df_correct_dive_pca$GhAhSkew = as.numeric(as.character(df_correct_dive_pca$GhAhSkew))
df_correct_dive_pca$fAn= as.numeric(as.character(df_correct_dive_pca$fAn))
df_correct_dive_pca$fGn = as.numeric(as.character(df_correct_dive_pca$fGn))
diving_birds_pca<-phyl.pca(dive_tree,df_correct_dive_pca)
dive_birds_pca
diving_birds_pca
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(diving_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(dive_tree,
scores(diving_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
eco<-setNames(df_dive_names[,4],rownames(df_dive_names))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[dive_tree$tip.label,],cex=0.3)
legend(x="center",legend=levels(eco),cex=0.8,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
#birds phyloPCA
rm(list = ls(all=TRUE))
