df_temp_fly$Beak_depth = as.numeric(as.character(df_temp_fly$Beak_depth))
df_temp_fly$Tarsus_length = as.numeric(as.character(df_temp_fly$Tarsus_length))
df_temp_fly$Wing_length = as.numeric(as.character(df_temp_fly$Wing_length))
df_temp_fly$Kipps_distance = as.numeric(as.character(df_temp_fly$Kipps_distance))
df_temp_fly$Hand_wing_index = as.numeric(as.character(df_temp_fly$Hand_wing_index))
df_temp_fly$Tail_length = as.numeric(as.character(df_temp_fly$Tail_length))
df_temp_fly$Mass = as.numeric(as.character(df_temp_fly$Mass))
df_temp_fly$Latitude = as.numeric(as.character(df_temp_fly$Latitude))
df_temp_fly$AnnualTemp = as.numeric(as.character(df_temp_fly$AnnualTemp))
df_temp_fly$TempRange = as.numeric(as.character(df_temp_fly$TempRange))
df_temp_fly$AnnualPrecip = as.numeric(as.character(df_temp_fly$AnnualPrecip))
df_temp_fly$PrecipRange = as.numeric(as.character(df_temp_fly$PrecipRange))
df_temp_fly$Beak_length_Culmen = log10(df_temp_fly$Beak_length_Culmen)
df_temp_fly$Beak_length_Nares = log10(df_temp_fly$Beak_length_Nares)
df_temp_fly$Beak_width = log10(df_temp_fly$Beak_width)
df_temp_fly$Beak_depth = log10(df_temp_fly$Beak_depth)
df_temp_fly$Tarsus_length = log10(df_temp_fly$Tarsus_length)
df_temp_fly$Wing_length = log10(df_temp_fly$Wing_length)
df_temp_fly$Kipps_distance = log10(df_temp_fly$Kipps_distance)
df_temp_fly$Hand_wing_index = log10(df_temp_fly$Hand_wing_index)
df_temp_fly$Tail_length = log10(df_temp_fly$Tail_length)
df_temp_fly$Mass = log10(df_temp_fly$Mass)
df_temp_fly$TempRange = log10(df_temp_fly$TempRange)
df_temp_fly$AnnualPrecip = log10(df_temp_fly$AnnualPrecip)
df_temp_fly$PrecipRange = log10(df_temp_fly$PrecipRange)
View(df_temp_fly)
#SET ALMOST EVERYTHING TO LOG10
temp_birds_pca<-phyl.pca(temp_tree,df_temp_fly[,c(13,14)])
#SET ALMOST EVERYTHING TO LOG10
temp_birds_pca<-phyl.pca(temp_tree,df_temp_fly[,c(2:11)])
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(temp_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
legend(x="topright",legend=levels(eco),cex=0.6,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,3:4],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC3",
ylab="PC4")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,5:6],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC5",
ylab="PC6")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
legend(x="topright",legend=levels(eco),cex=0.6,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,5:6],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC5",
ylab="PC6")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,7:8],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC7",
ylab="PC9")
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,7:8],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC7",
ylab="PC8")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,9:10],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC7",
ylab="PC8")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,9:10],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC9",
ylab="PC10")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
plot(temp_birds_pca,main="")
a = as.data.frame(temp_birds_pca$S)
a$PC1 = a$PC1 - min(a$PC1) + 1
a$PC2 = a$PC2 - min(a$PC2) + 1
a$PC3 = a$PC3 - min(a$PC3) + 1
a$PC4 = a$PC4 - min(a$PC4) + 1
a$PC5 = a$PC5 - min(a$PC5) + 1
a$PC6 = a$PC6 - min(a$PC6) + 1
a$PC7 = a$PC7 - min(a$PC7) + 1
a$PC8 = a$PC8 - min(a$PC8) + 1
a$PC9 = a$PC9 - min(a$PC9) + 1
a$PC10 = a$PC10 - min(a$PC10) + 1
a$PC1 = log10(a$PC1)
a$PC2 = log10(a$PC2)
a$PC3 = log10(a$PC3)
a$PC4 = log10(a$PC4)
a$PC5 = log10(a$PC5)
a$PC6 = log10(a$PC6)
a$PC7 = log10(a$PC7)
a$PC8 = log10(a$PC8)
a$PC9 = log10(a$PC9)
a$PC10 = log10(a$PC10)
phylomorphospace(temp_tree,
a[,7:8],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC3",
ylab="PC4")
phylomorphospace(temp_tree,
a[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
a[,3:4],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC3",
ylab="PC4")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
legend(x="topleft",legend=levels(eco),cex=0.6,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
phylomorphospace(temp_tree,
a[,3:4],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC3",
ylab="PC4")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
a[,5:6],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC5",
ylab="PC6")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
legend(x="topleft",legend=levels(eco),cex=0.6,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
phylomorphospace(temp_tree,
a[,5:6],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC5",
ylab="PC6")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
a[,7:8],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC7",
ylab="PC8")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
a[,9:10],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC9",
ylab="PC10")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
legend(x="topleft",legend=levels(eco),cex=0.6,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
phylomorphospace(temp_tree,
a[,9:10],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC9",
ylab="PC10")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
#SET ALMOST EVERYTHING TO LOG10
temp_birds_pca<-phyl.pca(temp_tree,df_temp_fly[,c(2:16)])
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(temp_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,3:4],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,5:6],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,7:8],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,9:10],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
a = as.data.frame(temp_birds_pca$S)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,11:12],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,13:14],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
#SET ALMOST EVERYTHING TO LOG10
temp_birds_pca<-phyl.pca(temp_tree,df_temp_fly[,c(13:14)])
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(temp_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,13:14],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
#only non-flying
df_nf = df_temp_fly[df_temp_fly$ability_to_fly != 'Flying',]
View(df_nf)
not_fly_species = setdiff(df_temp_fly$species_name, df_nfr$species_name)
not_fly_species = setdiff(df_temp_fly$species_name, df_nf$species_name)
correct_not_fly_species = setdiff(df_temp_fly$species_name, not_fly_species)
not_fly_tree<-keep.tip(temp_tree,correct_not_fly_species)
not_fly_tree
write.tree(not_fly_tree ,file="non-flying_birds_tree.tre")
#not_fly_species = setdiff(df_temp_fly$species_name, df_nf$species_name)
#correct_not_fly_species = setdiff(df_temp_fly$species_name, not_fly_species)
#not_fly_tree<-keep.tip(temp_tree,correct_not_fly_species)
#not_fly_tree
write.tree(not_fly_tree ,file="non_flying_birds_tree.tre")
nf_tree = read.tree('non_flying_and_temp.tre')
nf_tree = read.tree('non_flying_birds_tree.tre')
nf_birds_pca<-phyl.pca(nf_tree,df_nf[,c(2:11)])
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(nf_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(nf_tree,
scores(nf_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_nf$ability_to_fly = as.factor(df_nf$ability_to_fly)
df_nf$species_name = as.factor(df_nf$species_name)
df_nf$realm = as.factor(df_nf$realm)
eco<-setNames(df_nf[,17],rownames(df_nf))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[nf_tree$tip.label,],cex=0.3)
legend(x="bottomright",legend=levels(eco),cex=0.6,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
phylomorphospace(nf_tree,
scores(nf_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_nf$ability_to_fly = as.factor(df_nf$ability_to_fly)
df_nf$species_name = as.factor(df_nf$species_name)
df_nf$realm = as.factor(df_nf$realm)
eco<-setNames(df_nf[,17],rownames(df_nf))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[nf_tree$tip.label,],cex=0.3)
legend(x="bottomright",legend=levels(eco),cex=0.6,pch=21,
pt.bg=rainbow(n=length(levels(eco))),pt.cex=1.5)
phylomorphospace(nf_tree,
scores(nf_birds_pca)[,3:4],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC3",
ylab="PC4")
#color legend!!!! do later
df_nf$ability_to_fly = as.factor(df_nf$ability_to_fly)
df_nf$species_name = as.factor(df_nf$species_name)
df_nf$realm = as.factor(df_nf$realm)
eco<-setNames(df_nf[,17],rownames(df_nf))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[nf_tree$tip.label,],cex=0.3)
phylomorphospace(nf_tree,
scores(nf_birds_pca)[,5:6],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC5",
ylab="PC6")
#color legend!!!! do later
df_nf$ability_to_fly = as.factor(df_nf$ability_to_fly)
df_nf$species_name = as.factor(df_nf$species_name)
df_nf$realm = as.factor(df_nf$realm)
eco<-setNames(df_nf[,17],rownames(df_nf))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[nf_tree$tip.label,],cex=0.3)
phylomorphospace(nf_tree,
scores(nf_birds_pca)[,7:8],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC7",
ylab="PC8")
#color legend!!!! do later
df_nf$ability_to_fly = as.factor(df_nf$ability_to_fly)
df_nf$species_name = as.factor(df_nf$species_name)
df_nf$realm = as.factor(df_nf$realm)
eco<-setNames(df_nf[,17],rownames(df_nf))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[nf_tree$tip.label,],cex=0.3)
phylomorphospace(nf_tree,
scores(nf_birds_pca)[,9:10],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC9",
ylab="PC10")
#color legend!!!! do later
df_nf$ability_to_fly = as.factor(df_nf$ability_to_fly)
df_nf$species_name = as.factor(df_nf$species_name)
df_nf$realm = as.factor(df_nf$realm)
eco<-setNames(df_nf[,17],rownames(df_nf))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[nf_tree$tip.label,],cex=0.3)
nf_birds_pca<-phyl.pca(nf_tree,df_nf[,c(2:16)])
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(nf_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(nf_tree,
scores(nf_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_nf$ability_to_fly = as.factor(df_nf$ability_to_fly)
df_nf$species_name = as.factor(df_nf$species_name)
df_nf$realm = as.factor(df_nf$realm)
eco<-setNames(df_nf[,17],rownames(df_nf))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[nf_tree$tip.label,],cex=0.3)
View(df_temp_fly)
#SET ALMOST EVERYTHING TO LOG10
temp_birds_pca<-phyl.pca(temp_tree,df_temp_fly[,c(2:16)])
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(temp_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
#color legend!!!! do later
df_temp_fly$ability_to_fly = as.factor(df_temp_fly$ability_to_fly)
df_temp_fly$species_name = as.factor(df_temp_fly$species_name)
df_temp_fly$realm = as.factor(df_temp_fly$realm)
eco<-setNames(df_temp_fly[,17],rownames(df_temp_fly))
ECO<-to.matrix(eco,levels(eco))
tiplabels(pie=ECO[temp_tree$tip.label,],cex=0.3)
#SET ALMOST EVERYTHING TO LOG10
temp_birds_pca<-phyl.pca(temp_tree,df_temp_fly[,c(2:11)])
par(mar=c(4.1,4.1,2.1,1.1),las=1) ## set margins
plot(temp_birds_pca,main="")
par(cex.axis=0.8,mar=c(5.1,5.1,1.1,1.1))
phylomorphospace(temp_tree,
scores(temp_birds_pca)[,1:2],
ftype="off",node.size=c(0,1),bty="n",las=1,
xlab="PC1",
ylab="PC2")
rm(list = ls(all=TRUE))
