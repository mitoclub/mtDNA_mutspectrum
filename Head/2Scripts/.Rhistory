#gene_stats$species_name = NA
gene_stats = gene_stats[, colSums(is.na(gene_stats)) < nrow(gene_stats)]
stats_pca = prcomp(gene_stats[c(2,3,4,5,6,7,8,9,10)], center = TRUE, scale. = TRUE)
summary(stats_pca)
library(ggbiplot)
bipl = ggbiplot(stats_pca, groups = gene_stats$flying, labels = gene_stats$species_name, labels.size = 2)
bipl
unique(gene_stats$flying)
ggplotly(bipl)
rm(list = ls(all=TRUE))
library(ggbiplot)
library(ggplot2)
library(plotly)
library(dplyr)
#Work with Valya's data
valya_data = read.csv('../../Head/2Scripts/Valyadata2.csv')
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
valya_data = na.omit(valya_data)
gene_data = df_mtdna[,c('species_name', 'ghahSkew', 'chthSkew', 'fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac', 'med_G', 'med_T')]
gene_data$species_name = gsub(' ', '_', gene_data$species_name)
valya_data["species_name"][valya_data["species_name"] == "Strigops_habroptilus"] = "Strigops_habroptila"
valya_gene = merge(gene_data, valya_data, by = 'species_name')
df_pca = df_mtdna[c('species_name','gene_name','fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac','ghahSkew', 'chthSkew', 'med_T', 'med_G')]
gene_vector = c('fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac','ghahSkew', 'chthSkew', 'med_T', 'med_G')
gene_stats = data.frame(unique(df_pca$species_name))
for ( char in gene_vector){
stats1 = aggregate(df_pca[,char], by = list(df_pca$species_name), FUN = 'sum')[2]
stats1 = stats1/12
gene_stats = cbind(gene_stats, stats1)
}
names(gene_stats) = c('species_name', gene_vector)
df_realm = df_mtdna[c('species_name', 'realm', 'Trophic_niche')]
gene_stats = merge(gene_stats, df_realm, by = 'species_name')
View(valya_data)
gene_stats = unique(gene_stats)
row.names(gene_stats) = gene_stats$species_name
gene_stats$species_name = gsub(' ', '_', gene_stats$species_name)
gene_stats = merge(gene_stats, valya_data, by = 'species_name')
#gene_stats$species_name = NA
gene_stats = gene_stats[, colSums(is.na(gene_stats)) < nrow(gene_stats)]
stats_pca = prcomp(gene_stats[c(2,3,4,5,6,7,8,9,10)], center = TRUE, scale. = TRUE)
summary(stats_pca)
View(gene_stats)
bipl = ggbiplot(stats_pca, groups = gene_stats$far_migration, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
bipl = ggbiplot(stats_pca, groups = gene_stats$wintering, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
bipl = ggbiplot(stats_pca, groups = gene_stats$diving, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
bipl = ggbiplot(stats_pca, groups = gene_stats$only_forest, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
rm(list = ls(all=TRUE))
library(ggbiplot)
library(ggplot2)
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
library(plotly)
library(dplyr)
#Work with Valya's data
valya_data = read.csv('../../Head/2Scripts/valyadata_final.csv')
View(valya_data)
valya_data = na.omit(valya_data)
gene_data = df_mtdna[,c('species_name', 'ghahSkew', 'chthSkew', 'fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac', 'med_G', 'med_T')]
gene_data$species_name = gsub(' ', '_', gene_data$species_name)
valya_data["species_name"][valya_data["species_name"] == "Strigops_habroptilus"] = "Strigops_habroptila"
valya_gene = merge(gene_data, valya_data, by = 'species_name')
df_pca = df_mtdna[c('species_name','gene_name','fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac','ghahSkew', 'chthSkew', 'med_T', 'med_G')]
gene_vector = c('fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac','ghahSkew', 'chthSkew', 'med_T', 'med_G')
gene_stats = data.frame(unique(df_pca$species_name))
for ( char in gene_vector){
stats1 = aggregate(df_pca[,char], by = list(df_pca$species_name), FUN = 'sum')[2]
stats1 = stats1/12
gene_stats = cbind(gene_stats, stats1)
}
names(gene_stats) = c('species_name', gene_vector)
df_realm = df_mtdna[c('species_name', 'realm', 'Trophic_niche')]
gene_stats = merge(gene_stats, df_realm, by = 'species_name')
gene_stats = unique(gene_stats)
row.names(gene_stats) = gene_stats$species_name
gene_stats$species_name = gsub(' ', '_', gene_stats$species_name)
gene_stats = merge(gene_stats, valya_data, by = 'species_name')
#gene_stats$species_name = NA
gene_stats = gene_stats[, colSums(is.na(gene_stats)) < nrow(gene_stats)]
stats_pca = prcomp(gene_stats[c(2,3,4,5,6,7,8,9,10)], center = TRUE, scale. = TRUE)
summary(stats_pca)
bipl = ggbiplot(stats_pca, groups = gene_stats$only_forest, labels = gene_stats$species_name, labels.size = 2)
bipl
View(gene_stats)
bipl = ggbiplot(stats_pca, groups = gene_stats$only_forest, labels = gene_stats$can_not_fly, labels.size = 2)
bipl
bipl = ggbiplot(stats_pca, groups = gene_stats$can_not_fly, labels = gene_stats$species_name, labels.size = 2)
bipl
bipl = ggbiplot(stats_pca, groups = gene_stats$only_forest, labels = gene_stats$species_name, labels.size = 2)
bipl
bipl = ggbiplot(stats_pca, groups = gene_stats$can_not_fly, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
bipl = ggbiplot(stats_pca, groups = gene_stats$divers, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
bipl = ggbiplot(stats_pca, groups = gene_stats$high_alt, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
bipl = ggbiplot(stats_pca, groups = gene_stats$far_migrtion, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
bipl = ggbiplot(stats_pca, groups = gene_stats$wintering_num, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
bipl = ggbiplot(stats_pca, groups = gene_stats$high_alt2, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
bipl = ggbiplot(stats_pca, groups = gene_stats$reference2, labels = gene_stats$species_name, labels.size = 2)
bipl
ggplotly(bipl)
rm(list = ls(all=TRUE))
library(ggbiplot)
library(ggplot2)
library(ggpubr)
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
library(plotly)
library(dplyr)
#Work with Valya's data
valya_data = read.csv('../../Head/2Scripts/valyadata_final.csv')
valya_data = na.omit(valya_data)
gene_data = df_mtdna[,c('species_name', 'ghahSkew', 'chthSkew', 'fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac', 'med_G', 'med_T')]
gene_data$species_name = gsub(' ', '_', gene_data$species_name)
valya_data["species_name"][valya_data["species_name"] == "Strigops_habroptilus"] = "Strigops_habroptila"
valya_gene = merge(gene_data, valya_data, by = 'species_name')
View(valya_gene)
#Valya's data boxplots
fly_box = ggplot(valya_gene, aes(x = flying, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('GhAhSkew')
fly_box
fly_box2 = ggplot(valya_gene, aes(x = wintering, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Wintering')+
ylab('GhAhSkew')
fly_box2
fly_box3 = ggplot(valya_gene, aes(x = diving, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('GhAhSkew')
fly_box3 = ggplot(valya_gene, aes(x = diving, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Diving')+
ylab('GhAhSkew')
fly_box3
fly_box4 = ggplot(valya_gene, aes(x = far_migration, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Diving')+
ylab('GhAhSkew')
fly_box4 = ggplot(valya_gene, aes(x = far_migration, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Far_migration')+
ylab('GhAhSkew')
fly_box4
fly_box5 = ggplot(valya_gene, aes(x = flying, y = chthSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('ChThSkew')
fly_box5
fly_box6 = ggplot(valya_gene, aes(x = wintering, y = chthSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Wintering')+
ylab('ChThSkew')
fly_box6
fly_box7 = ggplot(valya_gene, aes(x = diving, y = chthSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Diving')+
ylab('ChThSkew')
fly_box7
fly_box8 = ggplot(valya_gene, aes(x = far_migration, y = chthSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Far_migration')+
ylab('ChThSkew')
fly_box8
#Valya's data boxplots
fly_box1 = ggplot(valya_gene, aes(x = flying, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('GhAhSkew')
fly_box1
fly_box2 = ggplot(valya_gene, aes(x = wintering, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Wintering')+
ylab('GhAhSkew')
fly_box2
fly_box3 = ggplot(valya_gene, aes(x = diving, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Diving')+
ylab('GhAhSkew')
fly_box3
fly_box4 = ggplot(valya_gene, aes(x = far_migration, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Far_migration')+
ylab('GhAhSkew')
fly_box4
fly_box5 = ggplot(valya_gene, aes(x = flying, y = chthSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('ChThSkew')
fly_box5
fly_box6 = ggplot(valya_gene, aes(x = wintering, y = chthSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Wintering')+
ylab('ChThSkew')
fly_box6
fly_box7 = ggplot(valya_gene, aes(x = diving, y = chthSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Diving')+
ylab('ChThSkew')
fly_box7
fly_box8 = ggplot(valya_gene, aes(x = far_migration, y = chthSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Far_migration')+
ylab('ChThSkew')
fly_box8
install.packages("ggbiplot")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggpubr")
install.packages("ggpubr")
install.packages("ggpubr")
rm(list = ls(all=TRUE))
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
install.packages('plotly')
install.packages('dplyr')
install.packages('dplyr')
install.packages("dplyr")
#Work with Valya's data
valya_data = read.csv('../../Head/2Scripts/valyadata_final.csv')
valya_data = na.omit(valya_data)
gene_data = df_mtdna[,c('species_name', 'ghahSkew', 'chthSkew', 'fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac', 'med_G', 'med_T')]
gene_data$species_name = gsub(' ', '_', gene_data$species_name)
valya_data["species_name"][valya_data["species_name"] == "Strigops_habroptilus"] = "Strigops_habroptila"
valya_gene = merge(gene_data, valya_data, by = 'species_name')
View(valya_gene)
med1 = ggplot(valya_gene, aes(x = flying, y = med_G))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('med_G')
library(ggplot2)
med1 = ggplot(valya_gene, aes(x = flying, y = med_G))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('med_G')
med1
med2 = ggplot(valya_gene, aes(x = wintering, y = med_G))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Wintering')+
ylab('med_G')
med2
med3 = ggplot(valya_gene, aes(x = divers, y = med_G))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Divers')+
ylab('med_G')
med3
med3 = ggplot(valya_gene, aes(x = diving, y = med_G))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Divers')+
ylab('med_G')
med3
med4 = ggplot(valya_gene, aes(x = far_migration, y = med_G))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Far migration')+
ylab('med_G')
med4
med5 = ggplot(valya_gene, aes(x = flying, y = med_T))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('med_T')
med5
med6 = ggplot(valya_gene, aes(x = wintering, y = med_T))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Wintering')+
ylab('med_T')
med6
med7 = ggplot(valya_gene, aes(x = diving, y = med_T))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Divers')+
ylab('med_T')
med7
med8 = ggplot(valya_gene, aes(x = far_migration, y = med_T))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Far migration')+
ylab('med_T')
med8
med7
med1 = ggplot(valya_gene, aes(x = flying, y = med_G))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('med_G')
med1
med2 = ggplot(valya_gene, aes(x = wintering, y = med_G))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Wintering')+
ylab('med_G')
med2
med3 = ggplot(valya_gene, aes(x = diving, y = med_G))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Divers')+
ylab('med_G')
med3
med4 = ggplot(valya_gene, aes(x = far_migration, y = med_G))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Far migration')+
ylab('med_G')
med4
med5 = ggplot(valya_gene, aes(x = flying, y = med_T))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('med_T')
med5
med5 = ggplot(valya_gene, aes(x = flying, y = med_T))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Ability to fly')+
ylab('med_T')
med5
med6 = ggplot(valya_gene, aes(x = wintering, y = med_T))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Wintering')+
ylab('med_T')
med6
med7 = ggplot(valya_gene, aes(x = diving, y = med_T))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Divers')+
ylab('med_T')
med7
med8 = ggplot(valya_gene, aes(x = far_migration, y = med_T))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Far migration')+
ylab('med_T')
med8
library(ggbiplot)
library(ggplot2)
library(ggpubr)
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
rm(list = ls(all=TRUE))
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
View(df_mtdna)
df_sgc = df_mtdna[,c(1,2,3,4,5,8, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97)] #getting codon usage
View(df_sgc)
df_sgc = df_mtdna[,c(2, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95)] #getting codon usage
df_sgc = df_mtdna[,c(2, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95)] #getting codon usage
df_sgc = df_mtdna[,c(2, 6, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95)] #getting codon usage
vec_all = c('TTC','TTT','TCC','TCT','TAC','TAT','TGC','TGT',
'TTA','TTG','TCA','TCG','TAA','TAG','TGA','TGG',
'CTC','CTT','CCC','CCT','CAC','CAT','CGC','CGT',
'CTA','CTG','CCA','CCG','CAA','CAG','CGA','CGG',
'ATC','ATT','ACC','ACT','AAC','AAT','AGC','AGT',
'ATA','ATG','ACA','ACG','AAA','AAG','AGA','AGG',
'GTC','GTT','GCC','GCT','GAC','GAT','GGC','GGT',
'GTA','GTG','GCA','GCG','GAA','GAG','GGA','GGG')
needed_codons = c('TTC','TCC','TAC','TGC',
'TTA','TCA','TAA','TGA',
'CTC','CCC','CAC','CGC',
'CTA','CCA','CAA','CGA',
'ATC','ACC','AAC','AGC',
'ATA','ACA','AAA','AGA',
'GTC','GCC','GAC','GGC',
'GTA','GCA','GAA','GGA')
rm(needed_codons)
#df_out= data.frame(sp_sum_gen[i,]$Species)
#for (codon in seq(from = 2, to = 65, by = 2)){
#if (org_gen[1,codon] == 0) {df_out = cbind(df_out, 0)}
#else {
#norm_cod = org_gen[1,codon] / (org_gen[1,codon+1] + org_gen[1,codon])
#df_out = cbind(df_out, norm_cod)
#}
#}
#names(df_out) = c('Species', needed_codons)
#codon_norm = rbind(codon_norm,df_out)
}
for (i in 1:nrow(sp_sum_gen)){
org_gen = sp_sum_gen[i,]
#org_gen = as.vector(org_gen)
#df_out= data.frame(sp_sum_gen[i,]$Species)
#for (codon in seq(from = 2, to = 65, by = 2)){
#if (org_gen[1,codon] == 0) {df_out = cbind(df_out, 0)}
#else {
#norm_cod = org_gen[1,codon] / (org_gen[1,codon+1] + org_gen[1,codon])
#df_out = cbind(df_out, norm_cod)
#}
#}
#names(df_out) = c('Species', needed_codons)
#codon_norm = rbind(codon_norm,df_out)
}
for (i in 1:nrow(df_sgc)){
org_gen = df_sgc[i,]
#org_gen = as.vector(org_gen)
#df_out= data.frame(sp_sum_gen[i,]$Species)
#for (codon in seq(from = 2, to = 65, by = 2)){
#if (org_gen[1,codon] == 0) {df_out = cbind(df_out, 0)}
#else {
#norm_cod = org_gen[1,codon] / (org_gen[1,codon+1] + org_gen[1,codon])
#df_out = cbind(df_out, norm_cod)
#}
#}
#names(df_out) = c('Species', needed_codons)
#codon_norm = rbind(codon_norm,df_out)
}
View(org_gen)
org_gen = as.vector(org_gen)
for (i in 1:nrow(df_sgc)){
org_gen = df_sgc[i,]
org_gen = as.vector(org_gen)
#df_out= data.frame(sp_sum_gen[i,]$Species)
#for (codon in seq(from = 2, to = 65, by = 2)){
#if (org_gen[1,codon] == 0) {df_out = cbind(df_out, 0)}
#else {
#norm_cod = org_gen[1,codon] / (org_gen[1,codon+1] + org_gen[1,codon])
#df_out = cbind(df_out, norm_cod)
#}
#}
#names(df_out) = c('Species', needed_codons)
#codon_norm = rbind(codon_norm,df_out)
}
View(org_gen)
df_out= data.frame(df_sgc[i,]$species_name)
View(df_out)
View(df_out)
org_gen[1,4]
org_gen[1]
org_gen[1:4]
org_gen[1, 'TTT']
for (i in 1:nrow(df_sgc)){
org_gen = df_sgc[i,]
org_gen = as.vector(org_gen)
df_out= data.frame(df_sgc[i,]$species_name, df_sgc[i,]$gene_name)
for (codon in seq(from = 1, to = 65)){
if (org_gen[1,codon] == 0) {df_out = cbind(df_out, 0)}
else {
norm_cod = org_gen[1,codon] / (org_gen[1,codon+1] + org_gen[1,codon])
df_out = cbind(df_out, norm_cod)
}
}
names(df_out) = c('Species', needed_codons)
codon_norm = rbind(codon_norm,df_out)
}
View(df_out)
for (i in 1:nrow(df_sgc)){
org_gen = df_sgc[i,]
org_gen = as.vector(org_gen)
df_out= data.frame(df_sgc[i,]$species_name, df_sgc[i,]$gene_name)
for (codon in seq(from = 1, to = 65)){
if (org_gen[1,codon] == 0) {df_out = cbind(df_out, 0)}
else {
norm_cod = org_gen[1,codon] / (org_gen[1,codon+1] + org_gen[1,codon])
df_out = cbind(df_out, norm_cod)
}
}
names(df_out) = c('Species', needed_codons)
codon_norm = rbind(codon_norm,df_out)
}
rm(list = ls(all=TRUE))
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
df_sgc = df_mtdna[,c(2, 6, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95)] #getting codon usage
anti_vec_all = c('TTC','TTT','TCC','TCT','TAC','TAT','TGC','TGT',
'TTA','TTG','TCA','TCG','TAA','TAG','TGA','TGG',
'CTC','CTT','CCC','CCT','CAC','CAT','CGC','CGT',
'CTA','CTG','CCA','CCG','CAA','CAG','CGA','CGG',
'ATC','ATT','ACC','ACT','AAC','AAT','AGC','AGT',
'ATA','ATG','ACA','ACG','AAA','AAG','AGA','AGG',
'GTC','GTT','GCC','GCT','GAC','GAT','GGC','GGT',
'GTA','GTG','GCA','GCG','GAA','GAG','GGA','GGG')
vec_all = c('TTT','TTC','TCT','TCC','TAT','TAC','TGT','TGC',
'TTG','TTA','TCG','TCA','TAG','TAA','TGG','TGA',
'CTT','CTC','CCT','CCC','CAT','CAC','CGT','CGC',
'CTG','CTA','CCG','CCA','CAG','CAA','CGG','CGA',
'ATT','ATC','ACT','ACC','AAT','AAC','AGT','AGC',
'ATG','ATA','ACG','ACA','AAG','AAA','AGG','AGA',
'GTT','GTC','GCT','GCC','GAT','GAC','GGT','GGC',
'GTG','GTA','GCG','GCA','GAG','GAA','GGG','GGA')
df_aa = data.frame()
for (i in 1:nrow(df_sgc)){
org_gen = df_sgc[i,]
org_gen = as.vector(org_gen)
df_out= data.frame(df_sgc[i,]$species_name, df_sgc[i,]$gene_name)
for (codon in seq(from = 1, to = 64)){
if (as.numeric(as.character(unlist(org_gen[vec_all[codon]]))) + as.numeric(as.character(unlist(org_gen[anti_vec_all[codon]]))) == 0)
{
norm_cod = 0
df_out = cbind(df_out, norm_cod)
}
else
{
norm_cod = (as.numeric(as.character(unlist(org_gen[vec_all[codon]]))))/(as.numeric(as.character(unlist(org_gen[vec_all[codon]]))) + as.numeric(as.character(unlist(org_gen[anti_vec_all[codon]]))))
df_out = cbind(df_out, norm_cod)
}
}
df_aa = rbind(df_aa, df_out)
}
View(df_aa)
names(df_aa) = c('species_name', 'gene_name', vec_all)
write.csv(df_aa, file = 'Aminoacids_shift_birds')
write.csv(df_aa, file = 'Aminoacids_shift_birds.csv')
