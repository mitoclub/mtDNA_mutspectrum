xlab('Mitochondrial genes')+
ylab('Thymine frequence')+
ylim(0, 0.7)
f1 = f1 +xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND1","ND2"))
f1 = f1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f1 = f1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f2 = ggplot(data = df_mtdna, aes(x = gene_name, y = fCn))+
geom_boxplot(outlier.shape = NA)+
xlab('Mitochondrial genes')+
ylab('Cytosine frequence')+
ylim(0, 0.7)
f2 = f2 +xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND1","ND2"))
f2 = f2 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f3 = ggplot(data = df_mtdna, aes(x = gene_name, y = fGn))+
geom_boxplot(outlier.shape = NA)+
xlab('Mitochondrial genes')+
ylab('Guanine frequence')+
ylim(0, 0.7)
f3 = f3 +xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND1","ND2"))
f3 = f3 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f4 = ggplot(data = df_mtdna, aes(x = gene_name, y = fAn))+
geom_boxplot(outlier.shape = NA)+
xlab('Mitochondrial genes')+
ylab('Adenine frequence')+
ylim(0, 0.7)
f4 = f4 +xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND1","ND2"))
f4 = f4 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f5 = ggarrange(f1, f3, f2, f4,
ncol = 2, nrow = 2)
f5
install.packages("ggpubr")
library(ggpubr)
f5
f5 = ggarrange(f1, f3, f2, f4,
ncol = 2, nrow = 2)
f5
skew_all = ggplot(data = df_mtdna, aes(x = gene_name, y = ghahSkew))+
geom_boxplot(outlier.shape = NA, notch = T)+
xlab('Gene names')+
ylab('GhAhSkew')
skew_all = skew_all + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND1","ND2"))
skew_all
remove.packages('devtools')
install.packages('devtools')
install.packages("devtools")
library(devtools)
library(devtools)
install_github("vqv/ggbiplot")
library(ggbiplot)
df_pca = df_mtdna[c('species_name','gene_name','fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac','ghahSkew', 'chthSkew', 'med_T', 'med_G')]
gene_vector = c('fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac','ghahSkew', 'chthSkew', 'med_T', 'med_G')
gene_stats = data.frame(unique(df_pca$species_name))
for ( char in gene_vector){
stats1 = aggregate(df_pca[,char], by = list(df_pca$species_name), FUN = 'sum')[2]
stats1 = stats1/12
gene_stats = cbind(gene_stats, stats1)
}
names(gene_stats) = c('species_name', gene_vector)
df_realm = df_mtdna[c('species_name', 'realm', 'Trophic_niche')]
gene_stats = merge(gene_stats, df_realm, by = 'species_name')
gene_stats = unique(gene_stats)
row.names(gene_stats) = gene_stats$species_name
#gene_stats$species_name = NA
gene_stats = gene_stats[, colSums(is.na(gene_stats)) < nrow(gene_stats)]
stats_pca = prcomp(gene_stats[c(2,3,4,5,6,7,8,9,10)], center = TRUE, scale. = TRUE)
summary(stats_pca)
bipl = ggbiplot(stats_pca, groups = gene_stats$realm, labels = gene_stats$species_name, labels.size = 2)+
scale_colour_manual(name="Origin", values= c("black", "green", "black", "black", "black", "black", "black", "red", "black"))
bipl
remove.packages('plotly')
install.packages('plotly')
library(plotly)
ggplotly(bipl)
rm(list = ls(all=TRUE))
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
rm(list = ls(all=TRUE))
library(ggplot2)
library(ggpubr)
library(plotly)
library(ggbiplot)
rm(list=ls(all=TRUE))
library(ggplot2)
library(plotly)
#four-fold mutations
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
names(mut_data_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_ff = merge(mut_data_ff, ecozone_data, by = 'species_name')
mut_data_ff$MutSpec =  as.numeric(mut_data_ff$MutSpec)
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AG = mut_data_ff[mut_data_ff$Mut == 'A>G',]
AT = mut_data_ff[mut_data_ff$Mut == 'A>T',]
GC = mut_data_ff[mut_data_ff$Mut == 'G>C',]
GT = mut_data_ff[mut_data_ff$Mut == 'G>T',]
GA = mut_data_ff[mut_data_ff$Mut == 'G>A',]
CG = mut_data_ff[mut_data_ff$Mut == 'C>G',]
CT = mut_data_ff[mut_data_ff$Mut == 'C>T',]
CA = mut_data_ff[mut_data_ff$Mut == 'C>A',]
TG = mut_data_ff[mut_data_ff$Mut == 'T>G',]
TC = mut_data_ff[mut_data_ff$Mut == 'T>C',]
TA = mut_data_ff[mut_data_ff$Mut == 'T>A',]
AC = replace(AC, 'A>C', 'T>G')
AC = AC[,c(1,3,4,5,6,7,8,9,10)]
names(AC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AG = replace(AG, 'A>G', 'T>C')
AG = AG[,c(1,3,4,5,6,7,8,9,10)]
names(AG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AT = replace(AT, 'A>T', 'T>A')
AT = AT[,c(1,3,4,5,6,7,8,9,10)]
names(AT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GC = replace(GC, 'G>C', 'C>G')
GC = GC[,c(1,3,4,5,6,7,8,9,10)]
names(GC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GT = replace(GT, 'G>T', 'C>A')
GT = GT[,c(1,3,4,5,6,7,8,9,10)]
names(GT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GA = replace(GA, 'G>A', 'C>T')
GA = GA[,c(1,3,4,5,6,7,8,9,10)]
names(GA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CG = replace(CG, 'C>G', 'G>C')
CG = CG[,c(1,3,4,5,6,7,8,9,10)]
names(CG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CT = replace(CT, 'C>T', 'G>A')
CT = CT[,c(1,3,4,5,6,7,8,9,10)]
names(CT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CA = replace(CA, 'C>A', 'G>T')
CA = CA[,c(1,3,4,5,6,7,8,9,10)]
names(CA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TG = replace(TG, 'T>G', 'A>C')
TG = TG[,c(1,3,4,5,6,7,8,9,10)]
names(TG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TC = replace(TC, 'T>C', 'A>G')
TC = TC[,c(1,3,4,5,6,7,8,9,10)]
names(TC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TA = replace(TA, 'T>A', 'A>T')
TA = TA[,c(1,3,4,5,6,7,8,9,10)]
names(TA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
mut_data_ff1 = rbind(AC, AG, AT, GC, GT, GA, CT, CA, CG, TA, TG, TC)
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, fill = Trophic_niche))+
geom_boxplot()
fig <- plot_ly(mut_data_ff1, x = ~Mut, y = ~MutSpec, color = ~realm, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
#PCA work
library(ggbiplot)
remove.packages('data.table')
install.packages('data.table')
install.packages("data.table")
library(data.table)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
pca_data_shaped$`A>C` = as.numeric(pca_data_shaped$`A>C`)
pca_data_shaped$`A>G` = as.numeric(pca_data_shaped$`A>G`)
pca_data_shaped$`A>T` = as.numeric(pca_data_shaped$`A>T`)
pca_data_shaped$`C>A` = as.numeric(pca_data_shaped$`C>A`)
pca_data_shaped$`C>G` = as.numeric(pca_data_shaped$`C>G`)
pca_data_shaped$`C>T` = as.numeric(pca_data_shaped$`C>T`)
pca_data_shaped$`G>A` = as.numeric(pca_data_shaped$`G>A`)
pca_data_shaped$`G>C` = as.numeric(pca_data_shaped$`G>C`)
pca_data_shaped$`G>T` = as.numeric(pca_data_shaped$`G>T`)
pca_data_shaped$`T>A` = as.numeric(pca_data_shaped$`T>A`)
pca_data_shaped$`T>C` = as.numeric(pca_data_shaped$`T>C`)
pca_data_shaped$`T>G` = as.numeric(pca_data_shaped$`T>G`)
stats_pca = prcomp(pca_data_shaped[,c(4,5,6,7,8,9,10,11,12,13,14,15)], center = TRUE, scale. = TRUE)
summary(stats_pca)
bipl = ggbiplot(stats_pca, groups = pca_data_shaped$realm, labels = pca_data_shaped$species_name, labels.size = 2)
#PCA work
library(ggbiplot)
bipl = ggbiplot(stats_pca, groups = pca_data_shaped$realm, labels = pca_data_shaped$species_name, labels.size = 2)
bipl
ggplotly(bipl)
library(plotly)
ggplotly(bipl)
View(pca_data_shaped)
#A>G/T>C
pca_data_shaped$AG_TC = pca_data_shaped$`A>G`/pca_data_shaped$`T>C`
pca_data_shaped$GA_CT = pca_data_shaped$`G>A`/pca_data_shaped$`C>T`
ggplot(pca_data_shaped, aes(x = realm, y = AG_TC))+
geom_boxplot()
ggplot(pca_data_shaped, aes(x = realm, y = AG_TC))+
geom_boxplot(outlier.shape = FALSE)
ggplot(pca_data_shaped, aes(x = realm, y = AG_TC))+
geom_boxplot(outlier.size =  = FALSE)
ggplot(pca_data_shaped, aes(x = realm, y = AG_TC))+
geom_boxplot(outlier.size = FALSE)
ggplot(pca_data_shaped, aes(x = realm, y = AG_TC))+
geom_boxplot(outlier.fill = FALSE)
ggplot(pca_data_shaped, aes(x = realm, y = AG_TC))+
geom_boxplot(outlier.shape = NA)
min(pca_data_shaped$AG_TC)
#Valya's data
valya_data = read.csv('../../Head/2Scripts/valyadata_final.csv')
valya_data = na.omit(valya_data)
valya_data = valya_data[,c(1,3,4,5,6)]
valya_data["species_name"][valya_data["species_name"] == "Strigops_habroptilus"] = "Strigops_habroptila"
View(valya_data)
pca_data_shaped$far_migration = ' '
pca_data_shaped$far_migration = ' '
pca_data_shaped$wintering = ' '
pca_data_shaped$diving = ' '
pca_data_shaped$flying = ' '
View(pca_data_shaped)
pca_data_shaped$far_migration = 'U'
pca_data_shaped$wintering = 'U'
pca_data_shaped$diving = 'U'
pca_data_shaped$flying = 'U'
unique(valya_data$far_migration)
unique(valya_data$wintering)
unique(valya_data$diving)
unique(valya_data$flying)
rm(list=ls(all=TRUE))
library(ggplot2)
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
View(mut_data)
View(df_mtdna)
#3 nucleotide against four-fold
df_mtdna$G_ratio_3_position = df_mtdna$neutral_c/df_mtdna$nC
df_mtdna$C_ratio_3_position = df_mtdna$neutral_g/df_mtdna$nG
#3 nucleotide against four-fold
df_mtdna$G_ratio_3_position = df_mtdna$neutral_c/df_mtdna$nC
df_mtdna$C_ratio_3_position = df_mtdna$neutral_g/df_mtdna$nG
df_mtdna$A_ratio_3_position = df_mtdna$neutral_T/df_mtdna$nT
df_mtdna$G_ratio_3_position = df_mtdna$neutral_A/df_mtdna$nA
#3 nucleotide against four-fold
df_mtdna$G_ratio_3_position = df_mtdna$neutral_c/df_mtdna$nC
df_mtdna$C_ratio_3_position = df_mtdna$neutral_g/df_mtdna$nG
df_mtdna$A_ratio_3_position = df_mtdna$neutral_T/df_mtdna$nT
df_mtdna$T_ratio_3_position = df_mtdna$neutral_A/df_mtdna$nA
View(mut_data)
#Syn_mutations
mut_data_syn = mut_data[mut_data$Label == 'syn',]
mut_data_syn = mut_data_ff[,c(1,2,3,4,5,7,8)]
mut_data_syn = mut_data_syn[,c(1,2,3,4,5,7,8)]
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_syn = mut_data_syn[!grepl('Node', mut_data_syn$AltNode),]
names(mut_data_syn) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_syn = merge(mut_data_syn, ecozone_data, by = 'species_name')
mut_data_syn$MutSpec =  as.numeric(mut_data_syn$MutSpec)
AC = mut_data_syn[mut_data_syn$Mut == 'A>C',]
AG = mut_data_syn[mut_data_syn$Mut == 'A>G',]
AT = mut_data_syn[mut_data_syn$Mut == 'A>T',]
GC = mut_data_syn[mut_data_syn$Mut == 'G>C',]
GT = mut_data_syn[mut_data_syn$Mut == 'G>T',]
GA = mut_data_syn[mut_data_syn$Mut == 'G>A',]
CG = mut_data_syn[mut_data_syn$Mut == 'C>G',]
CT = mut_data_syn[mut_data_syn$Mut == 'C>T',]
CA = mut_data_syn[mut_data_syn$Mut == 'C>A',]
TG = mut_data_syn[mut_data_syn$Mut == 'T>G',]
TC = mut_data_syn[mut_data_syn$Mut == 'T>C',]
TA = mut_data_syn[mut_data_syn$Mut == 'T>A',]
AC = replace(AC, 'A>C', 'T>G')
AC = AC[,c(1,3,4,5,6,7,8,9,10)]
names(AC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AG = replace(AG, 'A>G', 'T>C')
AG = AG[,c(1,3,4,5,6,7,8,9,10)]
names(AG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AT = replace(AT, 'A>T', 'T>A')
AT = AT[,c(1,3,4,5,6,7,8,9,10)]
names(AT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GC = replace(GC, 'G>C', 'C>G')
GC = GC[,c(1,3,4,5,6,7,8,9,10)]
names(GC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GT = replace(GT, 'G>T', 'C>A')
GT = GT[,c(1,3,4,5,6,7,8,9,10)]
names(GT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GA = replace(GA, 'G>A', 'C>T')
GA = GA[,c(1,3,4,5,6,7,8,9,10)]
names(GA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CG = replace(CG, 'C>G', 'G>C')
CG = CG[,c(1,3,4,5,6,7,8,9,10)]
names(CG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CT = replace(CT, 'C>T', 'G>A')
CT = CT[,c(1,3,4,5,6,7,8,9,10)]
names(CT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CA = replace(CA, 'C>A', 'G>T')
CA = CA[,c(1,3,4,5,6,7,8,9,10)]
names(CA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TG = replace(TG, 'T>G', 'A>C')
TG = TG[,c(1,3,4,5,6,7,8,9,10)]
names(TG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TC = replace(TC, 'T>C', 'A>G')
TC = TC[,c(1,3,4,5,6,7,8,9,10)]
names(TC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TA = replace(TA, 'T>A', 'A>T')
TA = TA[,c(1,3,4,5,6,7,8,9,10)]
names(TA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
mut_data_syn1 = rbind(AC, AG, AT, GC, GT, GA, CT, CA, CG, TA, TG, TC)
View(mut_data_syn1)
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, fill = Trophic_niche))+
geom_boxplot()
ggplot(data = mut_data_syn1, aes(x = Mut, y = MutSpec, fill = Trophic_niche))+
geom_boxplot()
library(plotly)
fig <- plot_ly(mut_data_syn1, x = ~Mut, y = ~MutSpec, color = ~realm, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
fig <- plot_ly(mut_data_syn1, x = ~Mut, y = ~MutSpec, color = ~Trophic_niche, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
fig <- plot_ly(mut_data_syn1, x = ~Mut, y = ~MutSpec, color = ~realm, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
fig <- plot_ly(mut_data_syn1, x = ~Mut, y = ~MutSpec, color = ~Trophic_niche, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
ggplot(data = mut_data_syn1, aes(x = Mut, y = MutSpec, fill = Trophic_niche))+
geom_boxplot()
View(mut_data_syn1)
View(mut_data_syn1)
#TR/TS
library(data.table)
pca_data = mut_data_syn1[,c(1,5,7,8,9)]
View(pca_data)
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
View(pca_data_shaped)
pca_data_shaped$TR/TS = (pca_data_shaped$`A>G`+pca_data_shaped$`C>T`+pca_data_shaped$`G>A`+
pca_data_shaped$`T>C`)/(pca_data_shaped$`A>C`+pca_data_shaped$`A>T`+pca_data_shaped$`C>A`+
pca_data_shaped$`C>G`+pca_data_shaped$`G>C`+pca_data_shaped$`G>T`+
pca_data_shaped$`T>A`+pca_data_shaped$`T>G`)
pca_data_shaped$TR/TS = (pca_data_shaped$`A>G`+pca_data_shaped$`C>T`+pca_data_shaped$`G>A`+pca_data_shaped$`T>C`)/(pca_data_shaped$`A>C`+pca_data_shaped$`A>T`+pca_data_shaped$`C>A`+pca_data_shaped$`C>G`+pca_data_shaped$`G>C`+pca_data_shaped$`G>T`+pca_data_shaped$`T>A`+pca_data_shaped$`T>G`)
pca_data_shaped$TR/TS = (pca_data_shaped$`A>G`+pca_data_shaped$`C>T`+pca_data_shaped$`G>A`+pca_data_shaped$`T>C`) / (pca_data_shaped$`A>C`+pca_data_shaped$`A>T`+pca_data_shaped$`C>A`+pca_data_shaped$`C>G`+pca_data_shaped$`G>C`+pca_data_shaped$`G>T`+pca_data_shaped$`T>A`+pca_data_shaped$`T>G`)
pca_data_shaped$TR_TS = (pca_data_shaped$`A>G`+pca_data_shaped$`C>T`+pca_data_shaped$`G>A`+pca_data_shaped$`T>C`)/(pca_data_shaped$`A>C`+pca_data_shaped$`A>T`+pca_data_shaped$`C>A`+pca_data_shaped$`C>G`+pca_data_shaped$`G>C`+pca_data_shaped$`G>T`+pca_data_shaped$`T>A`+pca_data_shaped$`T>G`)
ggplot(data = pca_data_shaped, aes(x = realm, y = TR_TS))+
geom_boxplot()
ggplot(data = pca_data_shaped, aes(x = realm, y = TR_TS))+
geom_boxplot()+
ylim(0,100)
ggplot(data = pca_data_shaped, aes(x = realm, y = TR_TS))+
geom_boxplot()+
ylim(0,75)
a = ggplot(data = pca_data_shaped, aes(x = realm, y = TR_TS))+
geom_boxplot()+
ylim(0,75)
a + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
rm(a)
realm_tr_ts = ggplot(data = pca_data_shaped, aes(x = realm, y = TR_TS))+
geom_boxplot()+
ylim(0,75)
realm_tr_ts = realm_tr_ts + +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
realm_tr_ts = realm_tr_ts + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
realm_tr_ts
realm_tr_ts = ggplot(data = pca_data_shaped, aes(x = realm, y = TR_TS))+
geom_boxplot()+
ylim(0,75)
realm_tr_ts = realm_tr_ts + xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
realm_tr_ts = realm_tr_ts + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
realm_tr_ts
View(df_mtdna)
#3 nucleotide against four-fold
df_nuc_count = df_mtdna[c(2,3,32:95,120)]
View(df_nuc_count)
names(df_nuc_count)
#3 nucleotide against four-fold
df_mtdna$all_A_position_3 = df_mtdna$TTT + df_mtdna$TCT + df_mtdna$TAT + df_mtdna$TGT + df_mtdna$CTT + df_mtdna$CCT + df_mtdna$CAT + df_mtdna$CGT + df_mtdna$ATT + df_mtdna$ACT + df_mtdna$AAT + df_mtdna$AGT + df_mtdna$GTT + df_mtdna$GCT + df_mtdna$GAT + df_mtdna$GGT
#3 nucleotide against four-fold
df_mtdna$all_A_position_3 = df_mtdna$TTT + df_mtdna$TCT + df_mtdna$TAT + df_mtdna$TGT + df_mtdna$CTT + df_mtdna$CCT + df_mtdna$CAT + df_mtdna$CGT + df_mtdna$ATT + df_mtdna$ACT + df_mtdna$AAT + df_mtdna$AGT + df_mtdna$GTT + df_mtdna$GCT + df_mtdna$GAT + df_mtdna$GGT
df_mtdna$all_T_position_3 = df_mtdna$TTA + df_mtdna$TCA + df_mtdna$TAA + df_mtdna$TGA + df_mtdna$CTA + df_mtdna$CCA + df_mtdna$CAA + df_mtdna$CGA + df_mtdna$ATA + df_mtdna$ACA + df_mtdna$AAA + df_mtdna$AGA + df_mtdna$GTA + df_mtdna$GCA + df_mtdna$GAA + df_mtdna$GGA
df_mtdna$all_G_position_3 = df_mtdna$TTC + df_mtdna$TCC + df_mtdna$TAC + df_mtdna$TGC + df_mtdna$CTC + df_mtdna$CCC + df_mtdna$CAC + df_mtdna$CGC + df_mtdna$ATC + df_mtdna$ACC + df_mtdna$AAC + df_mtdna$AGC + df_mtdna$GTC + df_mtdna$GCC + df_mtdna$GAC + df_mtdna$GGC
df_mtdna$all_C_position_3 = df_mtdna$TTG + df_mtdna$TCG + df_mtdna$TAG + df_mtdna$TGG + df_mtdna$CTG + df_mtdna$CCG + df_mtdna$CAG + df_mtdna$CGG + df_mtdna$ATG + df_mtdna$ACG + df_mtdna$AAG + df_mtdna$AGG + df_mtdna$GTG + df_mtdna$GCG + df_mtdna$GAG + df_mtdna$GGG
df_mtdna$G_ratio_3_position = df_mtdna$all_G_position_3/df_mtdna$nC
df_mtdna$C_ratio_3_position = df_mtdna$all_C_position_3/df_mtdna$nG
df_mtdna$A_ratio_3_position = df_mtdna$all_A_position_3/df_mtdna$nT
df_mtdna$T_ratio_3_position = df_mtdna$all_T_position_3/df_mtdna$nA
library(ggpubr)
f1 = ggplot(data = df_mtdna, aes(x = realm, y = T_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Thymine ration in third positions')
f1
f1 = ggplot(data = df_mtdna, aes(x = realm, y = T_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Thymine ration in third positions')
f1 = f1 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f1 = f1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f1
f1 = ggplot(data = df_mtdna, aes(x = realm, y = T_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Thymine ratio in third positions')
f1 = f1 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f1 = f1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f1
f1 = ggplot(data = df_mtdna, aes(x = realm, y = T_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Thymine ratio in third positions')
f1
df_mtdna$G_ratio_3_position = df_mtdna$neutral_c/df_mtdna$all_G_position_3
df_mtdna$C_ratio_3_position = df_mtdna$neutral_g/df_mtdna$all_C_position_3
df_mtdna$A_ratio_3_position = df_mtdna$neutral_T/df_mtdna$all_A_position_3
df_mtdna$T_ratio_3_position = df_mtdna$neutral_A/df_mtdna$all_T_position_3
f1 = ggplot(data = df_mtdna, aes(x = realm, y = T_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Thymine ratio in third positions')
f1 = f1 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f1 = f1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f1
f1 = ggplot(data = df_mtdna, aes(x = realm, y = T_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Thymine ratio in third positions')
f1 = f1 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f1 = f1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f2 = ggplot(data = df_mtdna, aes(x = realm, y = A_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Adenine ratio in third positions')
f2 = f2 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f2 = f2 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f3 = ggplot(data = df_mtdna, aes(x = realm, y = G_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Guanine ratio in third positions')
f3 = f3 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f3 = f3 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f4 = ggplot(data = df_mtdna, aes(x = realm, y = C_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Cytosine ratio in third positions')
f4 = f4 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f4 = f4 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f5 = ggarrange(f1, f3, f2, f4,
ncol = 2, nrow = 2)
f5
f5 = ggarrange(f1, f3, f4, f2,
ncol = 2, nrow = 2)
f5
f1 = ggplot(data = df_mtdna, aes(x = realm, y = T_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Thymine ratio in third positions')+
ylim(0.4, 0.8)
f1 = f1 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f1 = f1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f2 = ggplot(data = df_mtdna, aes(x = realm, y = A_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Adenine ratio in third positions')+
ylim(0.4, 0.8)
f2 = f2 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f2 = f2 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f3 = ggplot(data = df_mtdna, aes(x = realm, y = G_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Guanine ratio in third positions')+
ylim(0.4, 0.8)
f3 = f3 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f3 = f3 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f4 = ggplot(data = df_mtdna, aes(x = realm, y = C_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Cytosine ratio in third positions')+
ylim(0.4, 0.8)
f4 = f4 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f4 = f4 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f5 = ggarrange(f1, f3, f4, f2,
ncol = 2, nrow = 2)
f5
df_look = df_mtdna[df_mtdna$realm == 'Antarctic',]
View(df_look)
f1 = ggplot(data = df_mtdna, aes(x = realm, y = T_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Thymine ratio in third positions')
f1 = f1 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f1 = f1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f2 = ggplot(data = df_mtdna, aes(x = realm, y = A_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Adenine ratio in third positions')
f2 = f2 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f2 = f2 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f3 = ggplot(data = df_mtdna, aes(x = realm, y = G_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Guanine ratio in third positions')
f3 = f3 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f3 = f3 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f4 = ggplot(data = df_mtdna, aes(x = realm, y = C_ratio_3_position))+
geom_boxplot(outlier.shape = NA)+
xlab('realms')+
ylab('Cytosine ratio in third positions')
f4 = f4 +xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
f4 = f4 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
f5 = ggarrange(f1, f3, f4, f2,
ncol = 2, nrow = 2)
f5
fig
pca_data = mut_data_syn1[,c(1,5,7,8,9)]
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
pca_data_shaped$TR_TS = (pca_data_shaped$`A>G`+pca_data_shaped$`C>T`+pca_data_shaped$`G>A`+pca_data_shaped$`T>C`)/(pca_data_shaped$`A>C`+pca_data_shaped$`A>T`+pca_data_shaped$`C>A`+pca_data_shaped$`C>G`+pca_data_shaped$`G>C`+pca_data_shaped$`G>T`+pca_data_shaped$`T>A`+pca_data_shaped$`T>G`)
realm_tr_ts = ggplot(data = pca_data_shaped, aes(x = realm, y = TR_TS))+
geom_boxplot()+
ylim(0,75)
realm_tr_ts = realm_tr_ts + xlim(c('Antarctic', 'Nearctic', 'Palearctic', 'Indo_Malay', 'Afrotropic', 'Madagascar', 'Neotropic', 'Australian', 'Oceania'))
realm_tr_ts = realm_tr_ts + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
realm_tr_ts
rm(list=ls(all=TRUE))
