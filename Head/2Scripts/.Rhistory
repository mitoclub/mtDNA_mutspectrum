for (i in 1:nrow(df_all))
{
if (df_all$realm == 'Antarctic',)
{
print(i)
#df_all[df_all$realm_num == 1,]
}
}
for (i in 1:nrow(df_all))
{
if (df[df_all$realm == 'Antarctic',])
{
print(i)
#df_all[df_all$realm_num == 1,]
}
}
if (df_all'[df_all$realm == 'Antarctic',])
{
print(i)
#df_all[df_all$realm_num == 1,]
}
}
for (i in 1:nrow(df_all))
{
if (df_all[df_all$realm == 'Antarctic',])
{
print(i)
#df_all[df_all$realm_num == 1,]
}
}
for (i in 1:nrow(df_all))
{
if (df_all[i][df_all$realm == 'Antarctic',])
{
print(i)
#df_all[df_all$realm_num == 1,]
}
}
df_all[1]
df_all[2]
df_all[1,]
df_all[1,][df$realm]
df_all[1,][df$realm,]
df_all[1,][df$realm = 'Antarctic',]
df_all[1,][df$realm == 'Antarctic',]
df_all[1,][df_all$realm == 'Antarctic',]
df_all[df_all$realm == 'Antarctic',]
for (i in 1:nrow(df_all))
{
if (df_all[df_all$realm == 'Antarctic',])
{
df[df_all$realm_num == 1,]
}
}
df_aa$realm_num = 1
df_af = df[df$realm == 'Afrotropic',]
df_af$realm_num = 0
df_all = rbind(df_aa, df_af)
rownames(df_all) = 1:nrow(df_all)
View(df_all)
library(ape)
library(geiger)
library(nlme)
library(phytools)
df_tree = read.tree('../../Body/3Results/phylo.treefile')
plot(df_tree)
name.check(df_all_df_tree)
name.check(df_all,df_tree)
pglsModel <- gls(Antarctic ~ neutral_c, correlation = corBrownian(phy = df_tree),
data = df_all, method = "ML")
pglsModel <- gls(realm_num ~ neutral_c, correlation = corBrownian(phy = df_tree),
data = df_all, method = "ML")
summary(pglsModel)
#trying smth else
df_na = df[df$realm != 'Antarctic',]
9958-9854
df_final = rbind(df_na, df_aa)
df_na$realm_num = 0
df_final = rbind(df_na, df_aa)
pglsModel <- gls(realm_num ~ neutral_c, correlation = corBrownian(phy = df_tree),
data = df_final, method = "ML")
rm(list = ls(all.names = TRUE))
gc()
library('ggplot2')
library('ggpubr')
chdf = read.csv("../../Bodey/3Results/For_Bogdan.csv")
chdf = read.csv("../../Body/3Results/For_Bogdan.csv")
chdf$GhAhSkew = ((chdf$neutral_c - chdf$neutral_T)/(chdf$neutral_c + chdf$neutral_T))
GhAhgraf = ggplot(data = chdf, aes(x = gene_name, y = GhAhSkew))+
geom_boxplot(aes(fill = trophic_level), notch = TRUE)
GhAhgraf + xlim(c("[COX1]","[COX2]","[ATP8]","[ATP6]","[COX3]", "[ND3]", "[ND4L]","[ND4]","[ND5]","[CYTB]","[ND6]","[ND1]","[ND2]"))
GhAhgraf = ggplot(data = chdf, aes(x = gene_name, y = GhAhSkew))+
geom_boxplot(aes(fill = trophic_level), notch = TRUE)
GhAhgraf + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
GhAhgraf1 = ggplot(data = chdf, aes(x = gene_name, y = GhAhSkew))+
geom_boxplot(aes(fill = realm), notch = TRUE)
GhAhgraf1 + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
chdf$frneuA = chdf$neutral_A/chdf$neutral_amount
chdf$frneuG = chdf$neutral_g/chdf$neutral_amount
chdf$frneuC = chdf$neutral_c/chdf$neutral_amount
chdf$frneuT = chdf$neutral_T/chdf$neutral_amount
chdf$Stg = ((chdf$frneuA + chdf$frneuC)-(chdf$frneuG+chdf$frneuT))
Stggraph = ggplot(data = chdf, aes(x = gene_name, y = Stg))+
geom_boxplot(aex(fill = trophic_level), notch = TRUE)
Stggraph = ggplot(data = chdf, aes(x = gene_name, y = Stg))+
geom_boxplot(aes(fill = trophic_level), notch = TRUE)
Stggraph + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Stggraph1 = ggplot(data = chdf, aes(x = gene_name, y = Stg))+
geom_boxplot(aes(fill = realm), notch = TRUE)
Stggraph1 + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Ab = ggplot(data = chdf, aes(x = gene_name, y = neutral_A))+
geom_boxplot()
Ab + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Ab = ggplot(data = chdf, aes(x = gene_name, y = frneuA))+
geom_boxplot()
Ab + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Gb = ggplot(data = chdf, aes(x = gene_name, y = frneuG))+
geom_boxplot()
Gb + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Cb = ggplot(data = chdf, aes(x = gene_name, y = frneuC))+
geom_boxplot()
Cb + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Tb = ggplot(data = chdf, aes(x = gene_name, y = frneuT))+
geom_boxplot()
Tb + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
ggarrange(Ab, Gb, Cb, Tb,
labels = c("A", "B", "C","D"),
ncol = 2, nrow = 2)
Ab = ggplot(data = chdf, aes(x = gene_name, y = frneuA))+
geom_boxplot()
Ab + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Gb = ggplot(data = chdf, aes(x = gene_name, y = frneuG))+
geom_boxplot()
Gb + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Cb = ggplot(data = chdf, aes(x = gene_name, y = frneuC))+
geom_boxplot()
Cb + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Tb = ggplot(data = chdf, aes(x = gene_name, y = frneuT))+
geom_boxplot()
Tb + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
ggarrange(Ab, Gb, Cb, Tb,
labels = c("A", "B", "C","D"),
ncol = 2, nrow = 2)
all = ggarrange(Ab, Gb, Cb, Tb,
labels = c("A", "B", "C","D"),
ncol = 2, nrow = 2)
all
all + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Ab
Ab = ggplot(data = chdf, aes(x = gene_name, y = frneuA))+
geom_boxplot()
Ab = Ab + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Gb = ggplot(data = chdf, aes(x = gene_name, y = frneuG))+
geom_boxplot()
Gb = Gb + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Cb = ggplot(data = chdf, aes(x = gene_name, y = frneuC))+
geom_boxplot()
Cb = Cb + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
Tb = ggplot(data = chdf, aes(x = gene_name, y = frneuT))+
geom_boxplot()
Tb = Tb + xlim(c("COX1","COX2","ATP8","ATP6","COX3", "ND3", "ND4L","ND4","ND5","CYTB","ND6","ND1","ND2"))
all = ggarrange(Ab, Gb, Cb, Tb,
labels = c("A", "B", "C","D"),
ncol = 2, nrow = 2)
all
#final math
rm(list = ls(all.names = TRUE))
df = read.csv('For_Bogdan.csv')
df = read.csv('../../Body/3Results/For_Bogdan.csv')
df = df[df$gene_name != 'ND6',] #deleting ND6
df_sgc = df[,c(1,2,3,4,5,8, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97)] #getting codon usage
vec_all = c('TTC','TTT','TCC','TCT','TAC','TAT','TGC','TGT',
'TTA','TTG','TCA','TCG','TAA','TAG','TGA','TGG',
'CTC','CTT','CCC','CCT','CAC','CAT','CGC','CGT',
'CTA','CTG','CCA','CCG','CAA','CAG','CGA','CGG',
'ATC','ATT','ACC','ACT','AAC','AAT','AGC','AGT',
'ATA','ATG','ACA','ACG','AAA','AAG','AGA','AGG',
'GTC','GTT','GCC','GCT','GAC','GAT','GGC','GGT',
'GTA','GTG','GCA','GCG','GAA','GAG','GGA','GGG')
needed_codons = c('TTC','TCC','TAC','TGC',
'TTA','TCA','TAA','TGA',
'CTC','CCC','CAC','CGC',
'CTA','CCA','CAA','CGA',
'ATC','ACC','AAC','AGC',
'ATA','ACA','AAA','AGA',
'GTC','GCC','GAC','GGC',
'GTA','GCA','GAA','GGA')
df_codons_realm = df_sgc %>% select(species_name, gene_name, realm,all_of(vec_all))
library(dplyr)
library(ggplot2)
df_codons_realm = df_sgc %>% select(species_name, gene_name, realm,all_of(vec_all))
sp_sum_gen = data.frame(unique(df_codons_realm$species_name))
for ( codon in vec_all)
{
sum_of_codon = aggregate(df_codons_realm[ ,codon], by = list(df_codons_realm$species_name), FUN = 'sum')[2]
sp_sum_gen = cbind(sp_sum_gen, sum_of_codon)
}
names(sp_sum_gen) = c('Species', vec_all)
codon_norm = data.frame()
for (i in 1:nrow(sp_sum_gen))
{
org_gen = sp_sum_gen[i,]
org_gen = as.vector(org_gen)
df_out= data.frame(sp_sum_gen[i,]$Species)
for (codon in seq(from = 2, to = 65, by = 2))
{
if (org_gen[1,codon] == 0) {df_out = cbind(df_out, 0)}
else {
norm_cod = org_gen[1,codon] / (org_gen[1,codon+1] + org_gen[1,codon])
df_out = cbind(df_out, norm_cod)
}
}
names(df_out) = c('Species', needed_codons)
codon_norm = rbind(codon_norm,df_out)
}
names(codon_norm) = c('species_name', needed_codons)
codon_norm = codon_norm %>% select(-c('TAA','AGA'))
df_eco = df_codons_realm[,c(1,3)]
codon_norm = merge(codon_norm, df_eco)
df_try = data.frame(unique(codon_norm))
final = data.frame()
for (org in 1:nrow(df_try))
{
sp_r = df_try[org,]
vec_of_c = sp_r %>% select(TTC, TCC, TAC, TGC, CTC, CCC, CAC, CGC,
ATC, ACC, AAC, AGC, GTC, GCC, GAC, GGC)
vec_of_a = sp_r %>% select(TTA, TCA, TGA, CTA, CCA, CAA, CGA,
ATA, ACA, AAA, GTA, GCA, GAA, GGA)
med_c = median(as.numeric(vec_of_c), na.rm = TRUE)
med_a = median(as.numeric(vec_of_a), na.rm = TRUE)
sp_out = data.frame(sp_r$species_name, med_c, med_a, sp_r$realm)
final = rbind(final,sp_out)
}
names(final) = c('species_name', 'med_c', 'med_a', 'realm')
View(final)
df_antarctic = final[final$realm = 'Antarctic']
df_antarctic = final[final$realm == 'Antarctic',]
View(df_antarctic)
df_afrotropic = final[final$realm == 'Afrotropic',]
View(df_afrotropic)
cor.test(df_antarctic$med_c,df_afrotropic$realm, method = 'spearman')
cor.test(df_antarctic$med_c,df_afrotropic$med_c, method = 'spearman')
df_afrotropic[sample(nrow(df_afrotropic), 3), ]
df_afrotropic[sample(df_afrotropic$med_c, 3), ]
sample(df_afrotropic$med_c, 3)
sample(df_afrotropic$med_c, 3)
sample(df_afrotropic$med_c, 8)
cor.test(df_antarctic$med_c,sample(df_afrotropic$med_c, 8), method = 'spearman')
cor.test(df_antarctic$med_c,sample(df_afrotropic$med_c, 8), method = 'spearman')
cor.test(df_antarctic$med_c,sample(df_afrotropic$med_c, 8), method = 'spearman')
cor.test(df_antarctic$med_c,sample(df_afrotropic$med_c, 8), method = 'spearman')
cor.test(df_antarctic$med_c,sample(df_afrotropic$med_c, 8), method = 'spearman')
cor.test(df_antarctic$med_c,sample(df_afrotropic$med_c, 8), method = 'spearman')
#changing data and PGLS analysis
#1 - antarctic 0 - afrotropic
rm(list=ls(all=T))
library(ape)
library(geiger)
library(caper)
install.packages('caper')
library(caper)
df = read.csv('../../Body/3Results/For_Bogdan.csv')
names(df)
#final math
rm(list = ls(all.names = TRUE))
library(dplyr)
library(ggplot2)
df = read.csv('../../Body/3Results/For_Bogdan.csv')
df = df[df$gene_name != 'ND6',] #deleting ND6
df_sgc = df[,c(1,2,3,4,5,8, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97)] #getting codon usage
vec_all = c('TTC','TTT','TCC','TCT','TAC','TAT','TGC','TGT',
'TTA','TTG','TCA','TCG','TAA','TAG','TGA','TGG',
'CTC','CTT','CCC','CCT','CAC','CAT','CGC','CGT',
'CTA','CTG','CCA','CCG','CAA','CAG','CGA','CGG',
'ATC','ATT','ACC','ACT','AAC','AAT','AGC','AGT',
'ATA','ATG','ACA','ACG','AAA','AAG','AGA','AGG',
'GTC','GTT','GCC','GCT','GAC','GAT','GGC','GGT',
'GTA','GTG','GCA','GCG','GAA','GAG','GGA','GGG')
needed_codons = c('TTC','TCC','TAC','TGC',
'TTA','TCA','TAA','TGA',
'CTC','CCC','CAC','CGC',
'CTA','CCA','CAA','CGA',
'ATC','ACC','AAC','AGC',
'ATA','ACA','AAA','AGA',
'GTC','GCC','GAC','GGC',
'GTA','GCA','GAA','GGA')
df_codons_realm = df_sgc %>% select(species_name, gene_name, realm,all_of(vec_all))
library(dplyr)
library(ggplot2)
df_codons_realm = df_sgc %>% select(species_name, gene_name, realm,all_of(vec_all))
#final math
rm(list = ls(all.names = TRUE))
library(dplyr)
library(ggplot2)
df = read.csv('../../Body/3Results/For_Bogdan.csv')
df = df[df$gene_name != 'ND6',] #deleting ND6
df_sgc = df[,c(1,2,3,4,5,8, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97)] #getting codon usage
vec_all = c('TTC','TTT','TCC','TCT','TAC','TAT','TGC','TGT',
'TTA','TTG','TCA','TCG','TAA','TAG','TGA','TGG',
'CTC','CTT','CCC','CCT','CAC','CAT','CGC','CGT',
'CTA','CTG','CCA','CCG','CAA','CAG','CGA','CGG',
'ATC','ATT','ACC','ACT','AAC','AAT','AGC','AGT',
'ATA','ATG','ACA','ACG','AAA','AAG','AGA','AGG',
'GTC','GTT','GCC','GCT','GAC','GAT','GGC','GGT',
'GTA','GTG','GCA','GCG','GAA','GAG','GGA','GGG')
needed_codons = c('TTC','TCC','TAC','TGC',
'TTA','TCA','TAA','TGA',
'CTC','CCC','CAC','CGC',
'CTA','CCA','CAA','CGA',
'ATC','ACC','AAC','AGC',
'ATA','ACA','AAA','AGA',
'GTC','GCC','GAC','GGC',
'GTA','GCA','GAA','GGA')
df_codons_realm = df_sgc %>% select(species_name, gene_name, realm,all_of(vec_all))
View(df_sgc)
df_codons_realm = df_sgc %>% select(species_name, gene_name, realm,all_of(vec_all))
#final math
rm(list = ls(all.names = TRUE))
library(dplyr)
library(ggplot2)
df = read.csv('../../Body/3Results/For_Bogdan.csv')
df = df[df$gene_name != 'ND6',] #deleting ND6
df_sgc = df[,c(1,2,3,4,5,8, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97)] #getting codon usage
vec_all = c('TTC','TTT','TCC','TCT','TAC','TAT','TGC','TGT',
'TTA','TTG','TCA','TCG','TAA','TAG','TGA','TGG',
'CTC','CTT','CCC','CCT','CAC','CAT','CGC','CGT',
'CTA','CTG','CCA','CCG','CAA','CAG','CGA','CGG',
'ATC','ATT','ACC','ACT','AAC','AAT','AGC','AGT',
'ATA','ATG','ACA','ACG','AAA','AAG','AGA','AGG',
'GTC','GTT','GCC','GCT','GAC','GAT','GGC','GGT',
'GTA','GTG','GCA','GCG','GAA','GAG','GGA','GGG')
needed_codons = c('TTC','TCC','TAC','TGC',
'TTA','TCA','TAA','TGA',
'CTC','CCC','CAC','CGC',
'CTA','CCA','CAA','CGA',
'ATC','ACC','AAC','AGC',
'ATA','ACA','AAA','AGA',
'GTC','GCC','GAC','GGC',
'GTA','GCA','GAA','GGA')
df_codons_realm = df_sgc %>% select(species_name, gene_name, realm,all_of(vec_all))
sp_sum_gen = data.frame(unique(df_codons_realm$species_name))
for ( codon in vec_all)
{
sum_of_codon = aggregate(df_codons_realm[ ,codon], by = list(df_codons_realm$species_name), FUN = 'sum')[2]
sp_sum_gen = cbind(sp_sum_gen, sum_of_codon)
}
names(sp_sum_gen) = c('Species', vec_all)
codon_norm = data.frame()
for (i in 1:nrow(sp_sum_gen))
{
org_gen = sp_sum_gen[i,]
org_gen = as.vector(org_gen)
df_out= data.frame(sp_sum_gen[i,]$Species)
for (codon in seq(from = 2, to = 65, by = 2))
{
if (org_gen[1,codon] == 0) {df_out = cbind(df_out, 0)}
else {
norm_cod = org_gen[1,codon] / (org_gen[1,codon+1] + org_gen[1,codon])
df_out = cbind(df_out, norm_cod)
}
}
names(df_out) = c('Species', needed_codons)
codon_norm = rbind(codon_norm,df_out)
}
names(codon_norm) = c('species_name', needed_codons)
codon_norm = codon_norm %>% select(-c('TAA','AGA'))
df_eco = df_codons_realm[,c(1,3)]
codon_norm = merge(codon_norm, df_eco)
df_try = data.frame(unique(codon_norm))
final = data.frame()
for (org in 1:nrow(df_try))
{
sp_r = df_try[org,]
vec_of_c = sp_r %>% select(TTC, TCC, TAC, TGC, CTC, CCC, CAC, CGC,
ATC, ACC, AAC, AGC, GTC, GCC, GAC, GGC)
vec_of_a = sp_r %>% select(TTA, TCA, TGA, CTA, CCA, CAA, CGA,
ATA, ACA, AAA, GTA, GCA, GAA, GGA)
med_c = median(as.numeric(vec_of_c), na.rm = TRUE)
med_a = median(as.numeric(vec_of_a), na.rm = TRUE)
sp_out = data.frame(sp_r$species_name, med_c, med_a, sp_r$realm)
final = rbind(final,sp_out)
}
names(final) = c('species_name', 'med_c', 'med_a', 'realm')
df_antarctic = final[final$realm == 'Antarctic',]
df_afrotropic = final[final$realm == 'Afrotropic',]
#Alya's PGLS
library(ape)
library(geiger)
library(caper)
df = read.csv('../../Body/3Results/For_Bogdan.csv')
tree <- read.tree('../../Body/1Raw/phylo.treelife')
tree <- read.tree('../../Body/3Results/phylo.treelife')
tree <- read.tree('../../Body/3Results/phylo.treefile')
View(df)
#changing data and PGLS analysis
#1 - antarctic 0 - afrotropic
rm(list=ls(all=T))
ibrary(dplyr)
library(dplyr)
library(ggplot2)
df = read.csv('../../Body/3Results/For_Bogdan.csv') #reading file
df = df[df$gene_name != 'ND6',] #deleting ND6
df_sgc = df[,c(1,2,3,4,5,8, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,
78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97)] #getting codon usage
vec_all = c('TTC','TTT','TCC','TCT','TAC','TAT','TGC','TGT',
'TTA','TTG','TCA','TCG','TAA','TAG','TGA','TGG',
'CTC','CTT','CCC','CCT','CAC','CAT','CGC','CGT',
'CTA','CTG','CCA','CCG','CAA','CAG','CGA','CGG',
'ATC','ATT','ACC','ACT','AAC','AAT','AGC','AGT',
'ATA','ATG','ACA','ACG','AAA','AAG','AGA','AGG',
'GTC','GTT','GCC','GCT','GAC','GAT','GGC','GGT',
'GTA','GTG','GCA','GCG','GAA','GAG','GGA','GGG')
needed_codons = c('TTC','TCC','TAC','TGC',
'TTA','TCA','TAA','TGA',
'CTC','CCC','CAC','CGC',
'CTA','CCA','CAA','CGA',
'ATC','ACC','AAC','AGC',
'ATA','ACA','AAA','AGA',
'GTC','GCC','GAC','GGC',
'GTA','GCA','GAA','GGA')
df_codons_realm = df_sgc %>% select(species_name, gene_name, realm,all_of(vec_all))
sp_sum_gen = data.frame(unique(df_codons_realm$species_name))
for ( codon in vec_all)
{
sum_of_codon = aggregate(df_codons_realm[ ,codon], by = list(df_codons_realm$species_name), FUN = 'sum')[2]
sp_sum_gen = cbind(sp_sum_gen, sum_of_codon)
}
names(sp_sum_gen) = c('Species', vec_all)
codon_norm = data.frame()
for (i in 1:nrow(sp_sum_gen))
{
org_gen = sp_sum_gen[i,]
org_gen = as.vector(org_gen)
df_out= data.frame(sp_sum_gen[i,]$Species)
for (codon in seq(from = 2, to = 65, by = 2))
{
if (org_gen[1,codon] == 0) {df_out = cbind(df_out, 0)}
else {
norm_cod = org_gen[1,codon] / (org_gen[1,codon+1] + org_gen[1,codon])
df_out = cbind(df_out, norm_cod)
}
}
names(df_out) = c('Species', needed_codons)
codon_norm = rbind(codon_norm,df_out)
}
names(codon_norm) = c('species_name', needed_codons)
codon_norm = codon_norm %>% select(-c('TAA','AGA'))
df_eco = df_codons_realm[,c(1,3)]
codon_norm = merge(codon_norm, df_eco)
df_try = data.frame(unique(codon_norm))
final = data.frame()
for (org in 1:nrow(df_try))
{
sp_r = df_try[org,]
vec_of_c = sp_r %>% select(TTC, TCC, TAC, TGC, CTC, CCC, CAC, CGC,
ATC, ACC, AAC, AGC, GTC, GCC, GAC, GGC)
vec_of_a = sp_r %>% select(TTA, TCA, TGA, CTA, CCA, CAA, CGA,
ATA, ACA, AAA, GTA, GCA, GAA, GGA)
med_c = median(as.numeric(vec_of_c), na.rm = TRUE)
med_a = median(as.numeric(vec_of_a), na.rm = TRUE)
sp_out = data.frame(sp_r$species_name, med_c, med_a, sp_r$realm)
final = rbind(final,sp_out)
}
names(final) = c('species_name', 'med_c', 'med_a', 'realm')
View(final)
df_antarctic = final[final$realm = 'Antarctic',]
df_antarctic = final[final$realm == 'Antarctic',]
View(df_antarctic)
df_every = final[final$realm != 'Antarctic', ]
df_antarctic$point = 1
df_every$point = 1
df_every$point = 0
View(df_every)
df_all = rbind(df_antarctic, df_all)
df_all = data.frame()
df_all = rbind(df_antarctic, df_all)
df_all = rbind(df_antarctic, every)
df_all = data.frame()
df_all = rbind(df_antarctic, df_every)
View(df_all)
#PGLS
library(ape)
read.tree('../../Body/3Results/phylo.treefile')
tree = read.tree('../../Body/3Results/phylo.treefile')
library(nlme)
mat = vcv(tree, corr = TRUE)
View(mat)
fit = gls(med_c ~ point, correlation = corSymm(mat[lower.tri(mat)], fixed = TRUE), data = df_every)
fit = gls(med_c ~ point, correlation = corSymm(mat[lower.tri(mat)], fixed = TRUE), weights = varFixed(~tip.heights), data = df_every)
tip.heights <- diag(mat)
fit = gls(med_c ~ point, correlation = corSymm(mat[lower.tri(mat)], fixed = TRUE), weights = varFixed(~tip.heights), data = df_every)
fit = gls(point ~ med_c, correlation = corSymm(mat[lower.tri(mat)], fixed = TRUE), weights = varFixed(~tip.heights), data = df_every)
fitPagel0 <- gls(point ~ med_c, correlation = corPagel(value = 0, phy = tree, fixed = TRUE), data = df_all)
tree
names(tree)
l = df(tree)
l = data.frame(tree)
fit = gls(med_a ~ med_c, correlation = corSymm(mat[lower.tri(mat)], fixed = TRUE), weights = varFixed(~tip.heights), data = df_every)
tree = read.tree('../../Body/3Results/phylo.treefile')
mat = vcv(tree, corr = TRUE)
tip.heights <- diag(mat)
fit = gls(med_a ~ med_c, correlation = corSymm(mat[lower.tri(mat)], fixed = TRUE), weights = varFixed(~tip.heights), data = df_every)
fitPagel0 <- gls(med_a ~ med_c, correlation = corPagel(value = 0, phy = tree, fixed = TRUE), data = df_all)
