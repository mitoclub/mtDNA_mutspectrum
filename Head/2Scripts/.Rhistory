DataFrame = c()
for (i in 1:length(Names))
{ # i = 1
seq=paste(unlist(Seq[i]), collapse = '')
name = Names[i]
DataFrame = rbind(DataFrame,c(name,seq))
}
DataFrame = data.frame(DataFrame)
names(DataFrame)=c('RefSeqId','WholeGenome')
#### looking for di-nucleotide patterns
for (i in 1:nrow(DataFrame))
{ # i = 1
Temp = unlist(strsplit(DataFrame$WholeGenome[i], split = ''))
FreqOfNuc=data.frame(table(Temp))
DataFrame$NucA[i] = FreqOfNuc[FreqOfNuc$Temp == 'a',]$Freq
DataFrame$NucT[i] = FreqOfNuc[FreqOfNuc$Temp == 't',]$Freq
DataFrame$NucG[i] = FreqOfNuc[FreqOfNuc$Temp == 'g',]$Freq
DataFrame$NucC[i] = FreqOfNuc[FreqOfNuc$Temp == 'c',]$Freq
TempWithShift = c('ZERO',Temp[1:(length(Temp)-1)])
data = data.frame(cbind(Temp,TempWithShift))
data=data[-1,]
data$TwoNeighbors = paste(data$Temp,data$TempWithShift,sep='')
FreqOfDinucl = data.frame(table(data$TwoNeighbors))
DataFrame$DinucAA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'aa',]$Freq
DataFrame$DinucTT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tt',]$Freq
DataFrame$DinucGG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gg',]$Freq
DataFrame$DinucCC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cc',]$Freq
}
# let's assume that ExpAA = fr(A)*fr(A)*GenomeLength
DataFrame$ObsExpAA = DataFrame$DinucAA/(((DataFrame$NucA/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpTT = DataFrame$DinucTT/(((DataFrame$NucT/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpGG = DataFrame$DinucGG/(((DataFrame$NucG/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpCC = DataFrame$DinucCC/(((DataFrame$NucC/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
summary(DataFrame$ObsExpAA) #
summary(DataFrame$ObsExpTT) #
summary(DataFrame$ObsExpGG) #
summary(DataFrame$ObsExpCC) #
rm(list=ls(all=TRUE))
library(seqinr)
#### read fasta file
MutSpec = read.fasta("../../Body/1Raw/AmphibiansMtDnaRefSeqs/sequence.fasta")  # Amphibians
# MutSpec = read.fasta("../../Body/1Raw/LepidosauriaMtDnaRefSeqs/sequence.fasta")  # Lepidosauria
Seq = getSequence(MutSpec)
Names = getName(MutSpec)
#### make simple data-frame with RefSeqId and WholeGenome
DataFrame = c()
for (i in 1:length(Names))
{ # i = 1
seq=paste(unlist(Seq[i]), collapse = '')
name = Names[i]
DataFrame = rbind(DataFrame,c(name,seq))
}
DataFrame = data.frame(DataFrame)
names(DataFrame)=c('RefSeqId','WholeGenome')
#### looking for di-nucleotide patterns
for (i in 1:nrow(DataFrame))
{ # i = 1
Temp = unlist(strsplit(DataFrame$WholeGenome[i], split = ''))
FreqOfNuc=data.frame(table(Temp))
DataFrame$NucA[i] = FreqOfNuc[FreqOfNuc$Temp == 'a',]$Freq
DataFrame$NucT[i] = FreqOfNuc[FreqOfNuc$Temp == 't',]$Freq
DataFrame$NucG[i] = FreqOfNuc[FreqOfNuc$Temp == 'g',]$Freq
DataFrame$NucC[i] = FreqOfNuc[FreqOfNuc$Temp == 'c',]$Freq
TempWithShift = c('ZERO',Temp[1:(length(Temp)-1)])
data = data.frame(cbind(Temp,TempWithShift))
data=data[-1,]
data$TwoNeighbors = paste(data$Temp,data$TempWithShift,sep='')
FreqOfDinucl = data.frame(table(data$TwoNeighbors))
DataFrame$DinucAA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'aa',]$Freq
DataFrame$DinucTT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tt',]$Freq
DataFrame$DinucGG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gg',]$Freq
DataFrame$DinucCC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cc',]$Freq
}
# let's assume that ExpAA = fr(A)*fr(A)*GenomeLength
DataFrame$ObsExpAA = DataFrame$DinucAA/(((DataFrame$NucA/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpTT = DataFrame$DinucTT/(((DataFrame$NucT/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpGG = DataFrame$DinucGG/(((DataFrame$NucG/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpCC = DataFrame$DinucCC/(((DataFrame$NucC/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
summary(DataFrame$ObsExpAA) # 1.0068 (Lep)
summary(DataFrame$ObsExpTT) # 1.0861 (Lep)
summary(DataFrame$ObsExpGG) # 1.611 (Lep)
summary(DataFrame$ObsExpCC) # 1.1058 (Lep)
rm(list=ls(all=TRUE))
library(seqinr)
#### read fasta file
# MutSpec = read.fasta("../../Body/1Raw/AmphibiansMtDnaRefSeqs/sequence.fasta")  # Amphibians
# MutSpec = read.fasta("../../Body/1Raw/LepidosauriaMtDnaRefSeqs/sequence.fasta")  # Lepidosauria
MutSpec = read.fasta("../../Body/1Raw/PrimatesMtDnaRefSeqs/sequence.fasta")  # Primates
Seq = getSequence(MutSpec)
Names = getName(MutSpec)
#### make simple data-frame with RefSeqId and WholeGenome
DataFrame = c()
for (i in 1:length(Names))
{ # i = 1
seq=paste(unlist(Seq[i]), collapse = '')
name = Names[i]
DataFrame = rbind(DataFrame,c(name,seq))
}
DataFrame = data.frame(DataFrame)
names(DataFrame)=c('RefSeqId','WholeGenome')
#### looking for di-nucleotide patterns
for (i in 1:nrow(DataFrame))
{ # i = 1
Temp = unlist(strsplit(DataFrame$WholeGenome[i], split = ''))
FreqOfNuc=data.frame(table(Temp))
DataFrame$NucA[i] = FreqOfNuc[FreqOfNuc$Temp == 'a',]$Freq
DataFrame$NucT[i] = FreqOfNuc[FreqOfNuc$Temp == 't',]$Freq
DataFrame$NucG[i] = FreqOfNuc[FreqOfNuc$Temp == 'g',]$Freq
DataFrame$NucC[i] = FreqOfNuc[FreqOfNuc$Temp == 'c',]$Freq
TempWithShift = c('ZERO',Temp[1:(length(Temp)-1)])
data = data.frame(cbind(Temp,TempWithShift))
data=data[-1,]
data$TwoNeighbors = paste(data$Temp,data$TempWithShift,sep='')
FreqOfDinucl = data.frame(table(data$TwoNeighbors))
DataFrame$DinucAA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'aa',]$Freq
DataFrame$DinucTT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tt',]$Freq
DataFrame$DinucGG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gg',]$Freq
DataFrame$DinucCC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cc',]$Freq
}
# let's assume that ExpAA = fr(A)*fr(A)*GenomeLength
DataFrame$ObsExpAA = DataFrame$DinucAA/(((DataFrame$NucA/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpTT = DataFrame$DinucTT/(((DataFrame$NucT/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpGG = DataFrame$DinucGG/(((DataFrame$NucG/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpCC = DataFrame$DinucCC/(((DataFrame$NucC/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
summary(DataFrame$ObsExpAA) # 1.0068 (Lep); 1.0395 (Amp);
summary(DataFrame$ObsExpTT) # 1.0861 (Lep); 1.1196 (Amp);
summary(DataFrame$ObsExpGG) # 1.611 (Lep);  1.489  (Amp);
summary(DataFrame$ObsExpCC) # 1.1058 (Lep); 1.2041 (Amp);
rm(list=ls(all=TRUE))
library(seqinr)
#### read fasta file
# MutSpec = read.fasta("../../Body/1Raw/AmphibiansMtDnaRefSeqs/sequence.fasta")  # Amphibians
# MutSpec = read.fasta("../../Body/1Raw/LepidosauriaMtDnaRefSeqs/sequence.fasta")  # Lepidosauria
MutSpec = read.fasta("../../Body/1Raw/PrimatesMtDnaRefSeqs/sequence.fasta")  # Primates
Seq = getSequence(MutSpec)
Names = getName(MutSpec)
#### make simple data-frame with RefSeqId and WholeGenome
DataFrame = c()
for (i in 1:length(Names))
{ # i = 1
seq=paste(unlist(Seq[i]), collapse = '')
name = Names[i]
DataFrame = rbind(DataFrame,c(name,seq))
}
DataFrame = data.frame(DataFrame)
names(DataFrame)=c('RefSeqId','WholeGenome')
#### looking for di-nucleotide patterns
for (i in 1:nrow(DataFrame))
{ # i = 1
Temp = unlist(strsplit(DataFrame$WholeGenome[i], split = ''))
FreqOfNuc=data.frame(table(Temp))
DataFrame$NucA[i] = FreqOfNuc[FreqOfNuc$Temp == 'a',]$Freq
DataFrame$NucT[i] = FreqOfNuc[FreqOfNuc$Temp == 't',]$Freq
DataFrame$NucG[i] = FreqOfNuc[FreqOfNuc$Temp == 'g',]$Freq
DataFrame$NucC[i] = FreqOfNuc[FreqOfNuc$Temp == 'c',]$Freq
TempWithShift = c('ZERO',Temp[1:(length(Temp)-1)])
data = data.frame(cbind(Temp,TempWithShift))
data=data[-1,]
data$TwoNeighbors = paste(data$Temp,data$TempWithShift,sep='')
FreqOfDinucl = data.frame(table(data$TwoNeighbors))
DataFrame$DinucAA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'aa',]$Freq
DataFrame$DinucAT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'at',]$Freq
DataFrame$DinucTA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'ta',]$Freq
DataFrame$DinucTT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tt',]$Freq
DataFrame$DinucTG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tg',]$Freq
DataFrame$DinucGT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gt',]$Freq
DataFrame$DinucGG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gg',]$Freq
DataFrame$DinucGC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gc',]$Freq
DataFrame$DinucCG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cg',]$Freq
DataFrame$DinucCC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cc',]$Freq
}
DataFrame$ObsExpAT = DataFrame$DinucAT/(((DataFrame$NucA/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))*(DataFrame$NucT/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpAT = DataFrame$DinucAT/(((DataFrame$NucA/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))*(DataFrame$NucT/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpAA = DataFrame$DinucAA/(((DataFrame$NucA/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpAA = DataFrame$DinucAA/(((DataFrame$NucA/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))^2)*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$ObsExpAT = DataFrame$DinucAT/((DataFrame$NucA/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))*(DataFrame$NucT/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))*(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC))
DataFrame$FrA = DataFrame$NucA/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC)
DataFrame$FrA = DataFrame$NucA/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC)
DataFrame$FrT = DataFrame$NucT/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC)
DataFrame$FrG = DataFrame$NucG/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC)
DataFrame$FrC = DataFrame$NucC/(DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC)
DataFrame$GenomeLength = DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC
DataFrame$FrA = DataFrame$NucA/DataFrame$GenomeLength
DataFrame$FrT = DataFrame$NucT/DataFrame$GenomeLength
DataFrame$FrG = DataFrame$NucG/DataFrame$GenomeLength
DataFrame$FrC = DataFrame$NucC/DataFrame$GenomeLength
rm(list=ls(all=TRUE))
library(seqinr)
#### read fasta file
# MutSpec = read.fasta("../../Body/1Raw/AmphibiansMtDnaRefSeqs/sequence.fasta")  # Amphibians
# MutSpec = read.fasta("../../Body/1Raw/LepidosauriaMtDnaRefSeqs/sequence.fasta")  # Lepidosauria
MutSpec = read.fasta("../../Body/1Raw/PrimatesMtDnaRefSeqs/sequence.fasta")  # Primates
Seq = getSequence(MutSpec)
Names = getName(MutSpec)
#### make simple data-frame with RefSeqId and WholeGenome
DataFrame = c()
for (i in 1:length(Names))
{ # i = 1
seq=paste(unlist(Seq[i]), collapse = '')
name = Names[i]
DataFrame = rbind(DataFrame,c(name,seq))
}
DataFrame = data.frame(DataFrame)
names(DataFrame)=c('RefSeqId','WholeGenome')
#### looking for di-nucleotide patterns
for (i in 1:nrow(DataFrame))
{ # i = 1
Temp = unlist(strsplit(DataFrame$WholeGenome[i], split = ''))
FreqOfNuc=data.frame(table(Temp))
DataFrame$NucA[i] = FreqOfNuc[FreqOfNuc$Temp == 'a',]$Freq
DataFrame$NucT[i] = FreqOfNuc[FreqOfNuc$Temp == 't',]$Freq
DataFrame$NucG[i] = FreqOfNuc[FreqOfNuc$Temp == 'g',]$Freq
DataFrame$NucC[i] = FreqOfNuc[FreqOfNuc$Temp == 'c',]$Freq
TempWithShift = c('ZERO',Temp[1:(length(Temp)-1)])
data = data.frame(cbind(Temp,TempWithShift))
data=data[-1,]
data$TwoNeighbors = paste(data$Temp,data$TempWithShift,sep='')
FreqOfDinucl = data.frame(table(data$TwoNeighbors))
DataFrame$DinucAA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'aa',]$Freq
DataFrame$DinucAT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'at',]$Freq
DataFrame$DinucTA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'ta',]$Freq
DataFrame$DinucTT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tt',]$Freq
DataFrame$DinucTG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tg',]$Freq
DataFrame$DinucGT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gt',]$Freq
DataFrame$DinucGG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gg',]$Freq
DataFrame$DinucGC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gc',]$Freq
DataFrame$DinucCG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cg',]$Freq
DataFrame$DinucCC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cc',]$Freq
}
# let's assume that ExpAA = fr(A)*fr(A)*GenomeLength etc..
DataFrame$GenomeLength = DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC
DataFrame$FrA = DataFrame$NucA/DataFrame$GenomeLength
DataFrame$FrT = DataFrame$NucT/DataFrame$GenomeLength
DataFrame$FrG = DataFrame$NucG/DataFrame$GenomeLength
DataFrame$FrC = DataFrame$NucC/DataFrame$GenomeLength
DataFrame$ObsExpAA = DataFrame$DinucAA/DataFrame$FrA*DataFrame$FrA*DataFrame$GenomeLength
DataFrame$ObsExpAT = DataFrame$DinucAT/DataFrame$FrA*DataFrame$FrT*DataFrame$GenomeLength
DataFrame$ObsExpTA = DataFrame$DinucTA/DataFrame$FrA*DataFrame$FrT*DataFrame$GenomeLength
DataFrame$ObsExpTT = DataFrame$DinucTT/DataFrame$FrT*DataFrame$FrT*DataFrame$GenomeLength
DataFrame$ObsExpTG = DataFrame$DinucTG/DataFrame$FrT*DataFrame$FrG*DataFrame$GenomeLength
DataFrame$ObsExpGT = DataFrame$DinucGT/DataFrame$FrT*DataFrame$FrG*DataFrame$GenomeLength
DataFrame$ObsExpGG = DataFrame$DinucGG/DataFrame$FrG*DataFrame$FrG*DataFrame$GenomeLength
DataFrame$ObsExpGC = DataFrame$DinucGC/DataFrame$FrG*DataFrame$FrC*DataFrame$GenomeLength
DataFrame$ObsExpCG = DataFrame$DinucCG/DataFrame$FrG*DataFrame$FrC*DataFrame$GenomeLength
DataFrame$ObsExpCC = DataFrame$DinucCC/DataFrame$FrC*DataFrame$FrC*DataFrame$GenomeLength
## Amphibia have excess of AA and TT  (as compared to Lepidosauria and Primates) which is the potential result of UV radiation
median(DataFrame$ObsExpAA) # 1.0068 (Lep); 1.0395 (Amp); 1.0076 (Primates)
median(DataFrame$ObsExpTT) # 1.0861 (Lep); 1.1196 (Amp); 1.0169 (Primates)
median(DataFrame$ObsExpGG) # 1.611 (Lep);  1.489  (Amp); 1.4848 (Primates)
median(DataFrame$ObsExpCC) # 1.1058 (Lep); 1.2041 (Amp); 1.1435 (Primates)
DataFrame$FrA
DataFrame$FrT
DataFrame$FrG
DataFrame$FrC
rm(list=ls(all=TRUE))
library(seqinr)
#### read fasta file
# MutSpec = read.fasta("../../Body/1Raw/AmphibiansMtDnaRefSeqs/sequence.fasta")  # Amphibians
# MutSpec = read.fasta("../../Body/1Raw/LepidosauriaMtDnaRefSeqs/sequence.fasta")  # Lepidosauria
MutSpec = read.fasta("../../Body/1Raw/PrimatesMtDnaRefSeqs/sequence.fasta")  # Primates
Seq = getSequence(MutSpec)
Names = getName(MutSpec)
#### make simple data-frame with RefSeqId and WholeGenome
DataFrame = c()
for (i in 1:length(Names))
{ # i = 1
seq=paste(unlist(Seq[i]), collapse = '')
name = Names[i]
DataFrame = rbind(DataFrame,c(name,seq))
}
DataFrame = data.frame(DataFrame)
names(DataFrame)=c('RefSeqId','WholeGenome')
#### looking for di-nucleotide patterns
for (i in 1:nrow(DataFrame))
{ # i = 1
Temp = unlist(strsplit(DataFrame$WholeGenome[i], split = ''))
FreqOfNuc=data.frame(table(Temp))
DataFrame$NucA[i] = FreqOfNuc[FreqOfNuc$Temp == 'a',]$Freq
DataFrame$NucT[i] = FreqOfNuc[FreqOfNuc$Temp == 't',]$Freq
DataFrame$NucG[i] = FreqOfNuc[FreqOfNuc$Temp == 'g',]$Freq
DataFrame$NucC[i] = FreqOfNuc[FreqOfNuc$Temp == 'c',]$Freq
TempWithShift = c('ZERO',Temp[1:(length(Temp)-1)])
data = data.frame(cbind(Temp,TempWithShift))
data=data[-1,]
data$TwoNeighbors = paste(data$Temp,data$TempWithShift,sep='')
FreqOfDinucl = data.frame(table(data$TwoNeighbors))
DataFrame$DinucAA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'aa',]$Freq
DataFrame$DinucAT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'at',]$Freq
DataFrame$DinucTA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'ta',]$Freq
DataFrame$DinucTT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tt',]$Freq
DataFrame$DinucTG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tg',]$Freq
DataFrame$DinucGT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gt',]$Freq
DataFrame$DinucGG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gg',]$Freq
DataFrame$DinucGC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gc',]$Freq
DataFrame$DinucCG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cg',]$Freq
DataFrame$DinucCC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cc',]$Freq
}
# let's assume that ExpAA = fr(A)*fr(A)*GenomeLength etc..
DataFrame$GenomeLength = DataFrame$NucA + DataFrame$NucT + DataFrame$NucG + DataFrame$NucC
DataFrame$FrA = DataFrame$NucA/DataFrame$GenomeLength
DataFrame$FrT = DataFrame$NucT/DataFrame$GenomeLength
DataFrame$FrG = DataFrame$NucG/DataFrame$GenomeLength
DataFrame$FrC = DataFrame$NucC/DataFrame$GenomeLength
DataFrame$ObsExpAA = DataFrame$DinucAA/(DataFrame$FrA*DataFrame$FrA*DataFrame$GenomeLength)
DataFrame$ObsExpAT = DataFrame$DinucAT/(DataFrame$FrA*DataFrame$FrT*DataFrame$GenomeLength)
DataFrame$ObsExpTA = DataFrame$DinucTA/(DataFrame$FrA*DataFrame$FrT*DataFrame$GenomeLength)
DataFrame$ObsExpTT = DataFrame$DinucTT/(DataFrame$FrT*DataFrame$FrT*DataFrame$GenomeLength)
DataFrame$ObsExpTG = DataFrame$DinucTG/(DataFrame$FrT*DataFrame$FrG*DataFrame$GenomeLength)
DataFrame$ObsExpGT = DataFrame$DinucGT/(DataFrame$FrT*DataFrame$FrG*DataFrame$GenomeLength)
DataFrame$ObsExpGG = DataFrame$DinucGG/(DataFrame$FrG*DataFrame$FrG*DataFrame$GenomeLength)
DataFrame$ObsExpGC = DataFrame$DinucGC/(DataFrame$FrG*DataFrame$FrC*DataFrame$GenomeLength)
DataFrame$ObsExpCG = DataFrame$DinucCG/(DataFrame$FrG*DataFrame$FrC*DataFrame$GenomeLength)
DataFrame$ObsExpCC = DataFrame$DinucCC/(DataFrame$FrC*DataFrame$FrC*DataFrame$GenomeLength)
## Amphibia have excess of AA and TT  (as compared to Lepidosauria and Primates) which is the potential result of UV radiation
median(DataFrame$ObsExpAA) # 1.0068 (Lep); 1.0395 (Amp); 1.0076 (Primates)
median(DataFrame$ObsExpTT) # 1.0861 (Lep); 1.1196 (Amp); 1.0169 (Primates)
median(DataFrame$ObsExpGG) # 1.611 (Lep);  1.489  (Amp); 1.4848 (Primates)
median(DataFrame$ObsExpCC) # 1.1058 (Lep); 1.2041 (Amp); 1.1435 (Primates)
## Can UV light go through the egg skin?
median(DataFrame$ObsExpAT)
median(DataFrame$ObsExpTA)
median(DataFrame$ObsExpGC)
median(DataFrame$ObsExpCG)
median(DataFrame$ObsExpGT)
median(DataFrame$ObsExpTG)
median(DataFrame$ObsExpGC)
median(DataFrame$ObsExpCG)
median(DataFrame$ObsExpGC)
median(DataFrame$ObsExpGG)
median(DataFrame$ObsExpGT)
rm(list=ls(all=TRUE))
library(seqinr)
# MutSpec = read.fasta("../../Body/1Raw/AmphibiansMtDnaRefSeqs/sequence.fasta")  # Amphibians
MutSpec = read.fasta("../../Body/1Raw/LepidosauriaMtDnaRefSeqs/sequence.fasta")  # Lepidosauria
View(MutSpec)
Seq = getSequence(MutSpec)
View(Seq)
View(Seq)
Names = getName(MutSpec)
Names
#### make simple data-frame with RefSeqId and WholeGenome
DataFrame = c()
for (i in 1:length(Names))
{ # i = 1
seq=paste(unlist(Seq[i]), collapse = '')
name = Names[i]
DataFrame = rbind(DataFrame,c(name,seq))
}
seq
name
View(DataFrame)
names(DataFrame)=c('RefSeqId','WholeGenome')
names(DataFrame)=c('RefSeqId','WholeGenome')
#### looking for di-nucleotide patterns
for (i in 1:nrow(DataFrame))
{ # i = 1
Temp = unlist(strsplit(DataFrame$WholeGenome[i], split = ''))
FreqOfNuc=data.frame(table(Temp))
DataFrame$NucA[i] = FreqOfNuc[FreqOfNuc$Temp == 'a',]$Freq
DataFrame$NucT[i] = FreqOfNuc[FreqOfNuc$Temp == 't',]$Freq
DataFrame$NucG[i] = FreqOfNuc[FreqOfNuc$Temp == 'g',]$Freq
DataFrame$NucC[i] = FreqOfNuc[FreqOfNuc$Temp == 'c',]$Freq
TempWithShift = c('ZERO',Temp[1:(length(Temp)-1)])
data = data.frame(cbind(Temp,TempWithShift))
data=data[-1,]
data$TwoNeighbors = paste(data$TempWithShift,data$Temp,sep='')  # this order will make a sence for light strand (from start to end)
FreqOfDinucl = data.frame(table(data$TwoNeighbors))
DataFrame$DinucAA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'aa',]$Freq
DataFrame$DinucAT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'at',]$Freq
DataFrame$DinucTA[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'ta',]$Freq
DataFrame$DinucTT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tt',]$Freq
DataFrame$DinucTG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tg',]$Freq
DataFrame$DinucTC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'tc',]$Freq
DataFrame$DinucGT[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gt',]$Freq
DataFrame$DinucGG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gg',]$Freq
DataFrame$DinucGC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'gc',]$Freq
DataFrame$DinucCG[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cg',]$Freq
DataFrame$DinucCC[i] = FreqOfDinucl[FreqOfDinucl$Var1 == 'cc',]$Freq
}
library('ggplot2')
library('heatmaply')
rm(list=ls(all=TRUE))
#frog
codus = read.table('AllGenesCodonUsageNoOverlap.txt', header = TRUE, sep = '\t')
aves_pheno = read.table('.../.../Body/1Raw/DataFromValya/ALL_PHENOTYPES.txt')
aves_pheno = read.table('../../Body/1Raw/DataFromValya/ALL_PHENOTYPES.txt')
View(aves_pheno)
anage = read.table('../../Body/1Raw/anage_data.txt')
anage = read.table('../../Body/1Raw/anage_data.txt', header = TRUE, sep = '\t')
View(anage)
anage$Species = paste(anage$Genus, anage$Species, sep = '_')
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip")
codon_usage = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
View(codon_usage)
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")) {file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")}
{file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")}
codono_usage[codon_usage$Gene = 'ND6',] = NA
codono_usage[codon_usage$Gene == 'ND6',] = NA
codon_usage[codon_usage$Gene == 'ND6',] = NA
codon_usage = na.omit(codon_usage)
codon_usage$ratioA = codus$NeutralA/(codus$NeutralA+codus$NeutralG+codus$NeutralC+codus$NeutralT)
codon_usage$ratioA = codon_usage$NeutralA/(codon_usage$NeutralA+codon_usage$NeutralG+codon_usage$NeutralC+codon_usage$NeutralT)
unique_names = unique(codon_usage$Species)
unique_names
codon_usage[codon_usage$Species == 'Abbottina_obtusirostris',]
counter = 1
RatioA = c()
RatioC = c()
RatioG = c()
RatioT = c()
for (i in unique_names)
{
df = codon_usage[codon_usage$Species == i,]
Ad = (sum(df$NeutralA))/(sum(df$NeutralA)+sum(df$NeutralG)+sum(df$NeutralC)+sum(df$NeutralT))
Gu = (sum(df$NeutralG))/(sum(df$NeutralA)+sum(df$NeutralG)+sum(df$NeutralC)+sum(df$NeutralT))
Ci = (sum(df$NeutralC))/(sum(df$NeutralA)+sum(df$NeutralG)+sum(df$NeutralC)+sum(df$NeutralT))
Ti = (sum(df$NeutralT))/(sum(df$NeutralA)+sum(df$NeutralG)+sum(df$NeutralC)+sum(df$NeutralT))
RatioA[counter] = Ad
RatioG[counter] = Gu
RatioC[counter] = Ci
RatioT[counter] = Ti
counter = counter + 1
}
aves_ratio = data.frame(c(unique_names, RatioA, RatioC, RatioG, RatioT))
View(aves_ratio)
aves_ratio = data.frame(unique_names)
View(aves_ratio)
names(aves_ratio) = 'Species'
aves_ratio$RatioA = RatioA
aves_ratio$RatioC = RatioC
aves_ratio$RatioG = RatioG
aves_ratio$RatioT = RatioT
rm(aves_ratio)
all_ratio = data.frame(unique_names)
names(alls_ratio) = 'Species'
all_ratio$RatioA = RatioA
all_ratio$RatioC = RatioC
all_ratio = data.frame(unique_names)
names(all_ratio) = 'Species'
all_ratio$RatioA = RatioA
all_ratio$RatioC = RatioC
all_ratio$RatioG = RatioG
all_ratio$RatioT = RatioT
View(all_ratio)
names(aves_pheno) = c('Speceis', 'Phenotype')
aves_ratio_and_pheno = merge(aves_pheno, all_ratio, by = 'Species' )
names(aves_pheno) = c('Species', 'Phenotype')
aves_ratio_and_pheno = merge(aves_pheno, all_ratio, by = 'Species' )
View(aves_ratio_and_pheno)
aves_ratio_and_pheno_and_anage = merge(aves_ratio_and_pheno, anage, by = 'Species')
View(aves_ratio_and_pheno_and_anage)
#statistics for birds with pheno, mutspec and AnAge
mutspec = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt')
View(mutspec)
#statistics for birds with pheno, mutspec and AnAge
mutspec = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
birds_mutspec_and_pheno = merge(mutspec, aves_pheno, by = 'Species')
View(birds_mutspec_and_pheno)
birds_mutspec_and_pheno_and_anage = merge(birds_mutspec_and_pheno, anage, by = 'Species')
View(birds_mutspec_and_pheno_and_anage)
cor.test(aves_ratio_and_pheno_and_anage$RatioA, aves_ratio_and_pheno_and_anage$Maximum.longevity..yrs., method = 'spearman')
cor.test(birds_mutspec_and_pheno_and_anage$G_A, birds_mutspec_and_pheno_and_anage$Maximum.longevity..yrs., method = 'spearman')
cor.test(aves_ratio_and_pheno_and_anage$RatioA, aves_ratio_and_pheno_and_anage$Maximum.longevity..yrs., method = 'spearman')
cor.test(aves_ratio_and_pheno_and_anage$RatioG, aves_ratio_and_pheno_and_anage$Maximum.longevity..yrs., method = 'spearman')
cor.test(aves_ratio_and_pheno_and_anage$RatioG, aves_ratio_and_pheno_and_anage$Adult.weight..g., method = 'spearman')
View(all_ratio)
View(codon_usage)
cor.test(birds_mutspec_and_pheno_and_anage$T_C, birds_mutspec_and_pheno_and_anage$Maximum.longevity..yrs., method = 'spearman')
#statistics for birds with ratio, mutspec and anage
aves_anage = anage[anage$Class == 'Aves',]
View(aves_anage)
aves_anage_and_ratio = merge(aves_anage, all_ratio, by = 'Species')
View(aves_anage_and_ratio)
View(mutspec)
aves_anage_and_ratio_and_mutspec = merge(aves_anage_and_ratio, mutspec, by = 'Species')
View(aves_anage_and_ratio_and_mutspec)
cor.test(aves_anage_and_ratio_and_mutspec$G_A, aves_anage_and_ratio_and_mutspec$Maximum.longevity..yrs., method = 'spearmen')
cor.test(aves_anage_and_ratio_and_mutspec$G_A, aves_anage_and_ratio_and_mutspec$Maximum.longevity..yrs., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$T_C, aves_anage_and_ratio_and_mutspec$Maximum.longevity..yrs., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioA, aves_anage_and_ratio_and_mutspec$Maximum.longevity..yrs., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioC, aves_anage_and_ratio_and_mutspec$Maximum.longevity..yrs., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioG, aves_anage_and_ratio_and_mutspec$Maximum.longevity..yrs., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioT, aves_anage_and_ratio_and_mutspec$Maximum.longevity..yrs., method = 'spearman')
View(aves_anage_and_ratio_and_mutspec)
cor.test(aves_anage_and_ratio_and_mutspec$G_A, aves_anage_and_ratio_and_mutspec$Metabolic.rate..W., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$T_C, aves_anage_and_ratio_and_mutspec$Metabolic.rate..W., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioA, aves_anage_and_ratio_and_mutspec$Metabolic.rate..W., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioC, aves_anage_and_ratio_and_mutspec$Metabolic.rate..W., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioG, aves_anage_and_ratio_and_mutspec$Metabolic.rate..W., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioG, aves_anage_and_ratio_and_mutspec$Metabolic.rate..W., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioT, aves_anage_and_ratio_and_mutspec$Metabolic.rate..W., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$G_A, aves_anage_and_ratio_and_mutspec$Body.mass..g., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$T_C, aves_anage_and_ratio_and_mutspec$Body.mass..g., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioA, aves_anage_and_ratio_and_mutspec$Body.mass..g., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioC, aves_anage_and_ratio_and_mutspec$Body.mass..g., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioG, aves_anage_and_ratio_and_mutspec$Body.mass..g., method = 'spearman')
cor.test(aves_anage_and_ratio_and_mutspec$RatioT, aves_anage_and_ratio_and_mutspec$Body.mass..g., method = 'spearman')
#statistics for birds with pheno, ratio and AnAge
rm(list=ls(all=TRUE))
aves_pheno = read.table('../../Body/1Raw/DataFromValya/ALL_PHENOTYPES.txt')
anage = read.table('../../Body/1Raw/anage_data.txt', header = TRUE, sep = '\t')
anage$Species = paste(anage$Genus, anage$Species, sep = '_')
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip")
codon_usage = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
rm(list=ls(all=TRUE))
MutSpec = read.table("../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt", header = TRUE)
anage = read.table('../../Body/1Raw/anage_data.txt', header = TRUE, sep = '\t')
anage$Species = paste(anage$Genus, anage$Species, sep = '_')
View(MutSpec)
View(anage)
table(anage$Class)
anage = anage[anage$Class == 'Aves',]
