g2
g3 = ggplot(gene_stats, aes(x=PC1, color=Trophic_niche)) +
geom_density(size = 1)+
theme_bw()+
theme(axis.title = element_text(size = 29), axis.text = element_text(size = 25))+
xlab('PC1 (48.0%)')
g3
g4 = ggplot(gene_stats, aes(x=PC2, color=Trophic_niche)) +
geom_density(size = 1)+
theme_bw()+
theme(axis.title = element_text(size = 29), axis.text = element_text(size = 25))+
xlab('PC2 (32.2%)')
g4
g5 = ggplot(gene_stats, aes(x=PC1, color=realm)) +
geom_density(size = 1)+
theme_bw()+
theme(axis.title = element_text(size = 29), axis.text = element_text(size = 25))+
xlab('PC1 (48.0%)')+
scale_colour_manual(name="Origin", values= c("black", "green", "black", "black", "black", "black", "black", "red", "black"))
g5 = ggplot(gene_stats, aes(x=PC1, color=realm)) +
geom_density(size = 1)+
theme_bw()+
theme(axis.title = element_text(size = 29), axis.text = element_text(size = 25))+
xlab('PC1 (48.0%)')+
scale_colour_manual(name="Origin", values= c("black", "red", "black", "black", "black", "black", "black", "black", "black"))
g5
g6 = ggplot(gene_stats, aes(x=PC1, color=realm)) +
geom_density(size = 1)+
theme_bw()+
theme(axis.title = element_text(size = 29), axis.text = element_text(size = 25))+
xlab('PC1 (48.0%)')+
scale_colour_manual(name="Origin", values= c("black", "red", "black", "black", "black", "black", "black", "black", "black"))
g6 = ggplot(gene_stats, aes(x=PC2, color=realm)) +
geom_density(size = 1)+
theme_bw()+
theme(axis.title = element_text(size = 29), axis.text = element_text(size = 25))+
xlab('PC2 (32.2%)')+
scale_colour_manual(name="Origin", values= c("black", "red", "black", "black", "black", "black", "black", "black", "black"))
g6
g4 = ggplot(gene_stats, aes(x=PC2, color=Trophic_niche)) +
geom_density(size = 1)+
theme_bw()+
theme(axis.title = element_text(size = 29), axis.text = element_text(size = 25))+
xlab('PC2 (32.2%)')
g4
g7 = ggplot(gene_stats, aes(x=PC1, color=Trophic_niche)) +
geom_density(size = 1)+
theme_bw()+
theme(axis.title = element_text(size = 29), axis.text = element_text(size = 25))+
xlab('PC1 (48.0%)')+
scale_colour_manual(name="Origin", values= c("black", "black", "black", "red", "black", "black", "black", "black", "black", 'black'))
g7
g8 = ggplot(gene_stats, aes(x=PC2, color=Trophic_niche)) +
geom_density(size = 1)+
theme_bw()+
theme(axis.title = element_text(size = 29), axis.text = element_text(size = 25))+
xlab('PC2 (32.2%)')+
scale_colour_manual(name="Origin", values= c("black", "black", "black", "red", "black", "black", "black", "black", "black", 'black'))
g8
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
unique(mut_data$AltNode)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
names(mut_data_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_ff = merge(mut_data_ff, ecozone_data, by = 'species_name')
mut_data_ff$MutSpec =  as.numeric(mut_data_ff$MutSpec)
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AG = mut_data_ff[mut_data_ff$Mut == 'A>G',]
AT = mut_data_ff[mut_data_ff$Mut == 'A>T',]
GC = mut_data_ff[mut_data_ff$Mut == 'G>C',]
GT = mut_data_ff[mut_data_ff$Mut == 'G>T',]
GA = mut_data_ff[mut_data_ff$Mut == 'G>A',]
CG = mut_data_ff[mut_data_ff$Mut == 'C>G',]
CT = mut_data_ff[mut_data_ff$Mut == 'C>T',]
CA = mut_data_ff[mut_data_ff$Mut == 'C>A',]
TG = mut_data_ff[mut_data_ff$Mut == 'T>G',]
TC = mut_data_ff[mut_data_ff$Mut == 'T>C',]
TA = mut_data_ff[mut_data_ff$Mut == 'T>A',]
AC = replace(AC, 'A>C', 'T>G')
AC = AC[,c(1,3,4,5,6,7,8,9,10)]
names(AC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AG = replace(AG, 'A>G', 'T>C')
AG = AG[,c(1,3,4,5,6,7,8,9,10)]
names(AG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AT = replace(AT, 'A>T', 'T>A')
AT = AT[,c(1,3,4,5,6,7,8,9,10)]
names(AT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GC = replace(GC, 'G>C', 'C>G')
GC = GC[,c(1,3,4,5,6,7,8,9,10)]
names(GC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GT = replace(GT, 'G>T', 'C>A')
GT = GT[,c(1,3,4,5,6,7,8,9,10)]
names(GT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GA = replace(GA, 'G>A', 'C>T')
GA = GA[,c(1,3,4,5,6,7,8,9,10)]
names(GA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CG = replace(CG, 'C>G', 'G>C')
CG = CG[,c(1,3,4,5,6,7,8,9,10)]
names(CG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CT = replace(CT, 'C>T', 'G>A')
CT = CT[,c(1,3,4,5,6,7,8,9,10)]
names(CT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CA = replace(CA, 'C>A', 'G>T')
CA = CA[,c(1,3,4,5,6,7,8,9,10)]
names(CA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TG = replace(TG, 'T>G', 'A>C')
TG = TG[,c(1,3,4,5,6,7,8,9,10)]
names(TG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TC = replace(TC, 'T>C', 'A>G')
TC = TC[,c(1,3,4,5,6,7,8,9,10)]
names(TC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TA = replace(TA, 'T>A', 'A>T')
TA = TA[,c(1,3,4,5,6,7,8,9,10)]
names(TA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
mut_data_ff1 = rbind(AC, AG, AT, GC, GT, GA, CT, CA, CG, TA, TG, TC)
library(data.table)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
pca_data_shaped$`A>C` = as.numeric(pca_data_shaped$`A>C`)
pca_data_shaped$`A>G` = as.numeric(pca_data_shaped$`A>G`)
pca_data_shaped$`A>T` = as.numeric(pca_data_shaped$`A>T`)
pca_data_shaped$`C>A` = as.numeric(pca_data_shaped$`C>A`)
pca_data_shaped$`C>G` = as.numeric(pca_data_shaped$`C>G`)
pca_data_shaped$`C>T` = as.numeric(pca_data_shaped$`C>T`)
pca_data_shaped$`G>A` = as.numeric(pca_data_shaped$`G>A`)
pca_data_shaped$`G>C` = as.numeric(pca_data_shaped$`G>C`)
pca_data_shaped$`G>T` = as.numeric(pca_data_shaped$`G>T`)
pca_data_shaped$`T>A` = as.numeric(pca_data_shaped$`T>A`)
pca_data_shaped$`T>C` = as.numeric(pca_data_shaped$`T>C`)
pca_data_shaped$`T>G` = as.numeric(pca_data_shaped$`T>G`)
stats_pca1 = prcomp(pca_data_shaped[,c(4,5,6,7,8,9,10,11,12,13,14,15)], center = TRUE, scale. = TRUE)
summary(stats_pca1)
bipl = ggbiplot(stats_pca, groups = pca_data_shaped$realm, labels = pca_data_shaped$species_name, labels.size = 2)
View(pca_data_shaped)
bipl
bipl = ggbiplot(stats_pca1, groups = pca_data_shaped$realm, labels = pca_data_shaped$species_name, labels.size = 2)
bipl
bipl = ggbiplot(stats_pca1, groups = pca_data_shaped$realm, labels.size = 2)
bipl
bipl1 = ggbiplot(stats_pca, groups = pca_data_shaped$Trophic_niche, labels.size = 2)
bipl1 = ggbiplot(stats_pca1, groups = pca_data_shaped$Trophic_niche, labels.size = 2)
bipl1
View(gene_stats)
View(pca_data_shaped)
View(stats_pca1)
birds_ms_pca = data.frame(stats_pca1$x)
birds_ms_pca = birds_ms_pca[,c(1,2)]
View(birds_ms_pca)
birds_pca$species_name = row.names(birds_pca)
birds_ms_pca$species_name = row.names(birds_ms_pca)
View(birds_pca)
View(birds_ms_pca)
birds_pca = data.frame(stats_pca$x)
View(birds_pca)
View(gene_stats)
View(gene_stats)
View(gene_stats)
rm(list = ls(all=TRUE))
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
df_pca = df_mtdna[c('species_name','gene_name','fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac','ghahSkew', 'chthSkew', 'med_T', 'med_G')]
gene_vector = c('fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac','ghahSkew', 'chthSkew', 'med_T', 'med_G')
gene_stats = data.frame(unique(df_pca$species_name))
for ( char in gene_vector){
stats1 = aggregate(df_pca[,char], by = list(df_pca$species_name), FUN = 'sum')[2]
stats1 = stats1/12
gene_stats = cbind(gene_stats, stats1)
}
names(gene_stats) = c('species_name', gene_vector)
View(gene_stats)
df_realm = df_mtdna[c('species_name', 'realm', 'Trophic_niche')]
gene_stats = merge(gene_stats, df_realm, by = 'species_name')
gene_stats = unique(gene_stats)
row.names(gene_stats) = gene_stats$species_name
#gene_stats$species_name = NA
gene_stats = gene_stats[, colSums(is.na(gene_stats)) < nrow(gene_stats)]
stats_pca = prcomp(gene_stats[c(2,3,4,5,6,7,8,9,10)], center = TRUE, scale. = TRUE)
summary(stats_pca)
birds_pca = data.frame(stats_pca$x)
birds_pca = birds_pca[,c(1,2)]
birds_pca$species_name = row.names(birds_pca)
gene_stats$species_name = row.names(gene_stats)
gene_stats = merge(gene_stats, birds_pca, by = 'species_name')
row.names(gene_stats) = gene_stats$species_name
gene_stats = gene_stats[,c(2:14)]
b_bipl = ggbiplot(stats_pca, groups = gene_stats$Trophic_niche, labels = gene_stats$species_name,labels.size = 2)
b_bipl
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
unique(mut_data$AltNode)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
names(mut_data_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_ff = merge(mut_data_ff, ecozone_data, by = 'species_name')
mut_data_ff$MutSpec =  as.numeric(mut_data_ff$MutSpec)
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AG = mut_data_ff[mut_data_ff$Mut == 'A>G',]
AT = mut_data_ff[mut_data_ff$Mut == 'A>T',]
GC = mut_data_ff[mut_data_ff$Mut == 'G>C',]
GT = mut_data_ff[mut_data_ff$Mut == 'G>T',]
GA = mut_data_ff[mut_data_ff$Mut == 'G>A',]
CG = mut_data_ff[mut_data_ff$Mut == 'C>G',]
CT = mut_data_ff[mut_data_ff$Mut == 'C>T',]
CA = mut_data_ff[mut_data_ff$Mut == 'C>A',]
TG = mut_data_ff[mut_data_ff$Mut == 'T>G',]
TC = mut_data_ff[mut_data_ff$Mut == 'T>C',]
TA = mut_data_ff[mut_data_ff$Mut == 'T>A',]
AC = replace(AC, 'A>C', 'T>G')
AC = AC[,c(1,3,4,5,6,7,8,9,10)]
names(AC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AG = replace(AG, 'A>G', 'T>C')
AG = AG[,c(1,3,4,5,6,7,8,9,10)]
names(AG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AT = replace(AT, 'A>T', 'T>A')
AT = AT[,c(1,3,4,5,6,7,8,9,10)]
names(AT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GC = replace(GC, 'G>C', 'C>G')
GC = GC[,c(1,3,4,5,6,7,8,9,10)]
names(GC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GT = replace(GT, 'G>T', 'C>A')
GT = GT[,c(1,3,4,5,6,7,8,9,10)]
names(GT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GA = replace(GA, 'G>A', 'C>T')
GA = GA[,c(1,3,4,5,6,7,8,9,10)]
names(GA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CG = replace(CG, 'C>G', 'G>C')
CG = CG[,c(1,3,4,5,6,7,8,9,10)]
names(CG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CT = replace(CT, 'C>T', 'G>A')
CT = CT[,c(1,3,4,5,6,7,8,9,10)]
names(CT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CA = replace(CA, 'C>A', 'G>T')
CA = CA[,c(1,3,4,5,6,7,8,9,10)]
names(CA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TG = replace(TG, 'T>G', 'A>C')
TG = TG[,c(1,3,4,5,6,7,8,9,10)]
names(TG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TC = replace(TC, 'T>C', 'A>G')
TC = TC[,c(1,3,4,5,6,7,8,9,10)]
names(TC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TA = replace(TA, 'T>A', 'A>T')
TA = TA[,c(1,3,4,5,6,7,8,9,10)]
names(TA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
mut_data_ff1 = rbind(AC, AG, AT, GC, GT, GA, CT, CA, CG, TA, TG, TC)
library(data.table)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
pca_data_shaped$`A>C` = as.numeric(pca_data_shaped$`A>C`)
pca_data_shaped$`A>G` = as.numeric(pca_data_shaped$`A>G`)
pca_data_shaped$`A>T` = as.numeric(pca_data_shaped$`A>T`)
pca_data_shaped$`C>A` = as.numeric(pca_data_shaped$`C>A`)
pca_data_shaped$`C>G` = as.numeric(pca_data_shaped$`C>G`)
pca_data_shaped$`C>T` = as.numeric(pca_data_shaped$`C>T`)
pca_data_shaped$`G>A` = as.numeric(pca_data_shaped$`G>A`)
pca_data_shaped$`G>C` = as.numeric(pca_data_shaped$`G>C`)
pca_data_shaped$`G>T` = as.numeric(pca_data_shaped$`G>T`)
pca_data_shaped$`T>A` = as.numeric(pca_data_shaped$`T>A`)
pca_data_shaped$`T>C` = as.numeric(pca_data_shaped$`T>C`)
pca_data_shaped$`T>G` = as.numeric(pca_data_shaped$`T>G`)
stats_pca1 = prcomp(pca_data_shaped[,c(4,5,6,7,8,9,10,11,12,13,14,15)], center = TRUE, scale. = TRUE)
summary(stats_pca1)
View(pca_data_shaped)
row.names(pca_data_shaped) = pca_data_shaped$species_name
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
pca_data_shaped$`A>C` = as.numeric(pca_data_shaped$`A>C`)
pca_data_shaped$`A>G` = as.numeric(pca_data_shaped$`A>G`)
pca_data_shaped$`A>T` = as.numeric(pca_data_shaped$`A>T`)
pca_data_shaped$`C>A` = as.numeric(pca_data_shaped$`C>A`)
pca_data_shaped$`C>G` = as.numeric(pca_data_shaped$`C>G`)
pca_data_shaped$`C>T` = as.numeric(pca_data_shaped$`C>T`)
pca_data_shaped$`G>A` = as.numeric(pca_data_shaped$`G>A`)
pca_data_shaped$`G>C` = as.numeric(pca_data_shaped$`G>C`)
pca_data_shaped$`G>T` = as.numeric(pca_data_shaped$`G>T`)
pca_data_shaped$`T>A` = as.numeric(pca_data_shaped$`T>A`)
pca_data_shaped$`T>C` = as.numeric(pca_data_shaped$`T>C`)
pca_data_shaped$`T>G` = as.numeric(pca_data_shaped$`T>G`)
row.names(pca_data_shaped) = pca_data_shaped$species_name
row.names(pca_data_shaped) = pca_data_shaped$species_name
View(pca_data_shaped)
stats_pca1 = prcomp(pca_data_shaped[,c(4,5,6,7,8,9,10,11,12,13,14,15)], center = TRUE, scale. = TRUE)
summary(stats_pca1)
birds_ms_pca = data.frame(stats_pca1$x)
View(birds_ms_pca)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
pca_data_shaped$`A>C` = as.numeric(pca_data_shaped$`A>C`)
pca_data_shaped$`A>G` = as.numeric(pca_data_shaped$`A>G`)
pca_data_shaped$`A>T` = as.numeric(pca_data_shaped$`A>T`)
pca_data_shaped$`C>A` = as.numeric(pca_data_shaped$`C>A`)
pca_data_shaped$`C>G` = as.numeric(pca_data_shaped$`C>G`)
pca_data_shaped$`C>T` = as.numeric(pca_data_shaped$`C>T`)
pca_data_shaped$`G>A` = as.numeric(pca_data_shaped$`G>A`)
pca_data_shaped$`G>C` = as.numeric(pca_data_shaped$`G>C`)
pca_data_shaped$`G>T` = as.numeric(pca_data_shaped$`G>T`)
pca_data_shaped$`T>A` = as.numeric(pca_data_shaped$`T>A`)
pca_data_shaped$`T>C` = as.numeric(pca_data_shaped$`T>C`)
pca_data_shaped$`T>G` = as.numeric(pca_data_shaped$`T>G`)
row.names(pca_data_shaped) = pca_data_shaped$species_name
row.names(pca_data_shaped) = pca_data_shaped$realm
row.names(pca_data_shaped) = pca_data_shaped$species_name
rm(list = ls(all=TRUE))
library(ggbiplot)
library(ggplot2)
library(ggpubr)
library(plotly)
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
df_pca = df_mtdna[c('species_name','gene_name','fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac','ghahSkew', 'chthSkew', 'med_T', 'med_G')]
gene_vector = c('fAn', 'fGn', 'fCn', 'fTn', 'Stg_Sac','ghahSkew', 'chthSkew', 'med_T', 'med_G')
gene_stats = data.frame(unique(df_pca$species_name))
for ( char in gene_vector){
stats1 = aggregate(df_pca[,char], by = list(df_pca$species_name), FUN = 'sum')[2]
stats1 = stats1/12
gene_stats = cbind(gene_stats, stats1)
}
names(gene_stats) = c('species_name', gene_vector)
df_realm = df_mtdna[c('species_name', 'realm', 'Trophic_niche')]
gene_stats = merge(gene_stats, df_realm, by = 'species_name')
gene_stats = unique(gene_stats)
row.names(gene_stats) = gene_stats$species_name
#gene_stats$species_name = NA
gene_stats = gene_stats[, colSums(is.na(gene_stats)) < nrow(gene_stats)]
stats_pca = prcomp(gene_stats[c(2,3,4,5,6,7,8,9,10)], center = TRUE, scale. = TRUE)
summary(stats_pca)
birds_pca = data.frame(stats_pca$x)
birds_pca = birds_pca[,c(1,2)]
birds_pca$species_name = row.names(birds_pca)
gene_stats$species_name = row.names(gene_stats)
gene_stats = merge(gene_stats, birds_pca, by = 'species_name')
row.names(gene_stats) = gene_stats$species_name
gene_stats = gene_stats[,c(2:14)]
b_bipl = ggbiplot(stats_pca, groups = gene_stats$Trophic_niche, labels = gene_stats$species_name,labels.size = 2)
b_bipl
b_bipl1 = ggbiplot(stats_pca, groups = gene_stats$realm, labels = gene_stats$species_name,labels.size = 2)
b_bipl1
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
unique(mut_data$AltNode)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
names(mut_data_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_ff = merge(mut_data_ff, ecozone_data, by = 'species_name')
mut_data_ff$MutSpec =  as.numeric(mut_data_ff$MutSpec)
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AG = mut_data_ff[mut_data_ff$Mut == 'A>G',]
AT = mut_data_ff[mut_data_ff$Mut == 'A>T',]
GC = mut_data_ff[mut_data_ff$Mut == 'G>C',]
GT = mut_data_ff[mut_data_ff$Mut == 'G>T',]
GA = mut_data_ff[mut_data_ff$Mut == 'G>A',]
CG = mut_data_ff[mut_data_ff$Mut == 'C>G',]
CT = mut_data_ff[mut_data_ff$Mut == 'C>T',]
CA = mut_data_ff[mut_data_ff$Mut == 'C>A',]
TG = mut_data_ff[mut_data_ff$Mut == 'T>G',]
TC = mut_data_ff[mut_data_ff$Mut == 'T>C',]
TA = mut_data_ff[mut_data_ff$Mut == 'T>A',]
AC = replace(AC, 'A>C', 'T>G')
AC = AC[,c(1,3,4,5,6,7,8,9,10)]
names(AC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AG = replace(AG, 'A>G', 'T>C')
AG = AG[,c(1,3,4,5,6,7,8,9,10)]
names(AG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AT = replace(AT, 'A>T', 'T>A')
AT = AT[,c(1,3,4,5,6,7,8,9,10)]
names(AT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GC = replace(GC, 'G>C', 'C>G')
GC = GC[,c(1,3,4,5,6,7,8,9,10)]
names(GC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GT = replace(GT, 'G>T', 'C>A')
GT = GT[,c(1,3,4,5,6,7,8,9,10)]
names(GT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GA = replace(GA, 'G>A', 'C>T')
GA = GA[,c(1,3,4,5,6,7,8,9,10)]
names(GA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CG = replace(CG, 'C>G', 'G>C')
CG = CG[,c(1,3,4,5,6,7,8,9,10)]
names(CG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CT = replace(CT, 'C>T', 'G>A')
CT = CT[,c(1,3,4,5,6,7,8,9,10)]
names(CT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CA = replace(CA, 'C>A', 'G>T')
CA = CA[,c(1,3,4,5,6,7,8,9,10)]
names(CA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TG = replace(TG, 'T>G', 'A>C')
TG = TG[,c(1,3,4,5,6,7,8,9,10)]
names(TG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TC = replace(TC, 'T>C', 'A>G')
TC = TC[,c(1,3,4,5,6,7,8,9,10)]
names(TC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TA = replace(TA, 'T>A', 'A>T')
TA = TA[,c(1,3,4,5,6,7,8,9,10)]
names(TA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
mut_data_ff1 = rbind(AC, AG, AT, GC, GT, GA, CT, CA, CG, TA, TG, TC)
library(data.table)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
pca_data_shaped$`A>C` = as.numeric(pca_data_shaped$`A>C`)
pca_data_shaped$`A>G` = as.numeric(pca_data_shaped$`A>G`)
pca_data_shaped$`A>T` = as.numeric(pca_data_shaped$`A>T`)
pca_data_shaped$`C>A` = as.numeric(pca_data_shaped$`C>A`)
pca_data_shaped$`C>G` = as.numeric(pca_data_shaped$`C>G`)
pca_data_shaped$`C>T` = as.numeric(pca_data_shaped$`C>T`)
pca_data_shaped$`G>A` = as.numeric(pca_data_shaped$`G>A`)
pca_data_shaped$`G>C` = as.numeric(pca_data_shaped$`G>C`)
pca_data_shaped$`G>T` = as.numeric(pca_data_shaped$`G>T`)
pca_data_shaped$`T>A` = as.numeric(pca_data_shaped$`T>A`)
pca_data_shaped$`T>C` = as.numeric(pca_data_shaped$`T>C`)
pca_data_shaped$`T>G` = as.numeric(pca_data_shaped$`T>G`)
View(pca_data_shaped)
row.names(pca_data_shaped) = pca_data_shaped$species_name
extra_data = pca_data_shaped
View(extra_data)
row.names(extra_data) = extra_data$species_name
row.names(extra_data) = extra_data$`A>C`
row.names(extra_data) = extra_data$`A>T`
row.names(extra_data) = extra_data$species_name
View(extra_data)
rownames(extra_data) = extra_data$species_name
row.names.data.frame(extra_data) = extra_data$species_name
rownames(extra_data) = extra_data$species_name
library(data.table)
View(pca_data)
rm(pca_data, pca_data_shaped)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
row.names(pca_data_shaped) = pca_data_shaped$species_name
View(pca_data_shaped)
pca_data_shaped$`A>C` = as.numeric(pca_data_shaped$`A>C`)
pca_data_shaped$`A>G` = as.numeric(pca_data_shaped$`A>G`)
pca_data_shaped$`A>T` = as.numeric(pca_data_shaped$`A>T`)
pca_data_shaped$`C>A` = as.numeric(pca_data_shaped$`C>A`)
pca_data_shaped$`C>G` = as.numeric(pca_data_shaped$`C>G`)
pca_data_shaped$`C>T` = as.numeric(pca_data_shaped$`C>T`)
pca_data_shaped$`G>A` = as.numeric(pca_data_shaped$`G>A`)
pca_data_shaped$`G>C` = as.numeric(pca_data_shaped$`G>C`)
pca_data_shaped$`G>T` = as.numeric(pca_data_shaped$`G>T`)
pca_data_shaped$`T>A` = as.numeric(pca_data_shaped$`T>A`)
pca_data_shaped$`T>C` = as.numeric(pca_data_shaped$`T>C`)
pca_data_shaped$`T>G` = as.numeric(pca_data_shaped$`T>G`)
stats_pca1 = prcomp(pca_data_shaped[,c(4,5,6,7,8,9,10,11,12,13,14,15)], center = TRUE, scale. = TRUE)
summary(stats_pca1)
birds_ms_pca = data.frame(stats_pca1$x)
birds_ms_pca = birds_ms_pca[,c(1,2)]
View(birds_ms_pca)
birds_ms_pca = cbind(birds_ms_pca,pca_data_shaped$species_name)
bipl = ggbiplot(stats_pca1, groups = pca_data_shaped$realm, labels.size = 2)
bipl
row.names(pca_d)
row.names(pca_data_shaped)
View(pca_data_shaped)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
row.names(pca_data_shaped) = pca_data_shaped$species_name
pca_data_shaped$`A>C` = as.numeric(pca_data_shaped$`A>C`)
pca_data_shaped$`A>G` = as.numeric(pca_data_shaped$`A>G`)
pca_data_shaped$`A>T` = as.numeric(pca_data_shaped$`A>T`)
pca_data_shaped$`C>A` = as.numeric(pca_data_shaped$`C>A`)
pca_data_shaped$`C>G` = as.numeric(pca_data_shaped$`C>G`)
pca_data_shaped$`C>T` = as.numeric(pca_data_shaped$`C>T`)
pca_data_shaped$`G>A` = as.numeric(pca_data_shaped$`G>A`)
pca_data_shaped$`G>C` = as.numeric(pca_data_shaped$`G>C`)
pca_data_shaped$`G>T` = as.numeric(pca_data_shaped$`G>T`)
pca_data_shaped$`T>A` = as.numeric(pca_data_shaped$`T>A`)
pca_data_shaped$`T>C` = as.numeric(pca_data_shaped$`T>C`)
pca_data_shaped$`T>G` = as.numeric(pca_data_shaped$`T>G`)
row.names(pca_data_shaped)
stats_pca1 = prcomp(pca_data_shaped[,c(4,5,6,7,8,9,10,11,12,13,14,15)], center = TRUE, scale. = TRUE)
summary(stats_pca1)
birds_ms_pca = data.frame(stats_pca1$x)
birds_ms_pca = birds_ms_pca[,c(1,2)]
birds_ms_pca$species_name = row.names(birds_ms_pca)
View(birds_ms_pca)
View(AC)
View(birds_ms_pca)
View(pca_data_shaped)
rm(pca_data, pca_data_shaped)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
row.names(pca_data_shaped) = pca_data_shaped$species_name
View(pca_data_shaped)
row.names(pca_data_shaped)
stats_pca1 = prcomp(pca_data_shaped[,c(4,5,6,7,8,9,10,11,12,13,14,15)], center = TRUE, scale. = TRUE)
summary(stats_pca1)
stats_pca1 = prcomp(pca_data_shaped[,c(4,5,6,7,8,9,10,11,12,13,14,15)], center = TRUE, scale. = TRUE)
summary(stats_pca1)
birds_ms_pca = data.frame(stats_pca1$x)
View(birds_ms_pca)
birds_ms_pca = birds_ms_pca[,c(1,2)]
View(birds_ms_pca)
birds_ms_pca$species_name = row.names(birds_ms_pca)
View(birds_ms_pca)
i = merge(pca_data_shaped, birds_ms_pca, by = 'species_name')
View(i)
