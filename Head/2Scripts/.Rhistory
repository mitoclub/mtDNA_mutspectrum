df = df_shift2[df_shift2$gene_name == i,]
df = data.frame((colSums(df[,-1]))/766)
names(df) = c('value')
df$codon = rownames(df)
df$gene_name = i
codons_for_graph = rbind(codons_for_graph, df)
print(length(df$codon))
df = data.frame()
}
View(df_shift2)
df1 = df_shift2[df_shift2$gene_name == 'ND1',]
View(df1)
df1 = data.frame((colSums(df1[,-1]))/766)
View(df1)
rm(df1)
View(codons_for_graph)
#preparing df for drawing
gene_vector = c('ND1', 'ND2', 'ND3', 'ND4', 'ND4L', 'ND5', 'ATP6', 'ATP8', 'COX1', 'COX2', 'COX3', 'CYTB')
codons_for_graph = data.frame()
for (i in gene_vector)
{
df = df_shift2[df_shift2$gene_name == i,]
df = data.frame((colSums(df[,-1]))/766)
names(df) = c('value')
df$codon = rownames(df)
df$gene_name = i
codons_for_graph = rbind(codons_for_graph, df)
df = data.frame()
}
View(codons_for_graph)
ggplot(codons_for_graph, aes(x = gene_name, y = value))+
geom_point()
ggplot(codons_for_graph, aes(x = gene_name, y = value))+
geom_line()+
geom_point()
ggplot(codons_for_graph, aes(x = gene_name, y = value))+
geom_line()
ggplot(codons_for_graph, aes(x = gene_name, y = value, group = codon))+
geom_line(aes(linetype = codon))+
geom_point()
#trying 3d
library(plotly)
plot_ly(data = codons_for_graph, type = 'surface', x = ~gene_name, y = ~codon, z = ~value)
plot_ly(data = codons_for_graph, x = ~gene_name, y = ~codon, z = ~value)
rm(list=ls(all=TRUE))
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE)
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE)
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
View(mut_data)
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
unique(mut_data$RefNode)
unique(mut_data$AltNode)
df = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/expected_mutations.tsv", header = TRUE, fill = TRUE)
View(df)
unique(df$Node)
View(df_mtdna)
rm(df)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
View(mut_data_ff)
mut_data_ff = mut_data[,c(1,2,3,4,5,7,8)]
ecozone_data = df_mtdna[,c('species_name', 'ecozone')]
ecozone_data = df_mtdna[,c('species_name', 'realm')]
View(ecozone_data)
ecozone_data = unique(ecozone_data)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
mut_data_ff = merge(mut_data_ff, ecozone_data)
View(mut_data_ff)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_ff = merge(mut_data_ff, ecozone_data)
View(mut_data_ff)
mut_data_ff[!grepl('Node', mut_data_ff$AltNode)]
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode)]
mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
mut_data_ff$AltNode = mut_data_ff$species_name
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
names(mut_data_ff$AltNode) = c('species_name')
names(mut_data_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_ff = merge(mut_data_ff, ecozone_data)
mut_data_ff = merge(mut_data_ff, ecozone_data, by = 'species_name')
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
names(mut_data_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_ff = merge(mut_data_ff, ecozone_data, by = 'species_name')
ecozone_data = df_mtdna[,c('species_name', 'realm', 'trophic_niche')]
View(df_mtdna)
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
unique(mut_data$AltNode)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
names(mut_data_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_ff = merge(mut_data_ff, ecozone_data, by = 'species_name')
library('ggplot2')
library(ggplot2)
ggplot(mut_data_ff, aex(x = Mut, y = MutSpec))+
geom_boxplot()
ggplot(mut_data_ff, axis(x = Mut, y = MutSpec))+
geom_boxplot()
ggplot(mut_data_ff, axis(x = 'Mut', y = 'MutSpec'))+
geom_boxplot()
ggplot(mut_data_ff, aes(x = 'Mut', y = 'MutSpec'))+
geom_boxplot()
ggplot(mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()
gc()
f1 = ggplot(mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()
f1
View(mut_data_ff)
unique(mut_data_ff$Mut)
ex1 = mut_data_ff[mut_data_ff$species_name == 'Acanthisitta_chloris',]
View(ex1)
ggplot(ex1, aes(x = Mut, y = MutSpec))+
geom_boxplot()
ggplot(mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()+
ylim(0, 1)
ggplot(mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()+
ylim(0, 0.9)
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()+
ylim(0, 0.9)
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()+
ylim(0.0, 0.9)
typeof(mut_data_ff$RawMutSpec)
is.na(mut_data_ff$RawMutSpec)
View(mut_data)
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = FALSE)
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff[mut_data_ff$RefNode == 'Lonchura_hunsteini']
mut_data_ff[mut_data_ff$RefNode == 'Lonchura_hunsteini',]
typeof(6.7)
typeof(mut_data_ff$RawMutSpec)
min(mut_data_ff$RawMutSpec)
max(mut_data_ff$RawMutSpec)
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()+
ylim(0.0, 0.5)
mut_data_ff$MutSpec =  as.numeric(mut_data_ff$MutSpec)
typeof(mut_data_ff$RawMutSpec)
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()+
ylim(0.0, 0.5)
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, fill = realm))+
geom_boxplot()
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, fill = 'realm'))+
geom_boxplot()
rm(list=ls(all=TRUE))
library(ggplot2)
#four-fold mutations
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
unique(mut_data$AltNode)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
names(mut_data_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_ff = merge(mut_data_ff, ecozone_data, by = 'species_name')
mut_data_ff$MutSpec =  as.numeric(mut_data_ff$MutSpec)
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, fill = 'realm'))+
geom_boxplot()
View(mut_data_ff)
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, color = 'realm'))+
geom_boxplot()
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, fill = realm))+
geom_boxplot()
library(plotly)
plot_ly(
data = mut_data_ff,
y = ~MutSpec,
x = ~Mut,
type = "box",
color = ~realm,
)
plot_ly(
data = mut_data_ff,
y = ~MutSpec,
x = ~Mut,
type = "box",
color = ~realm
)
fig <- plot_ly(ggplot2::mut_data_ff, x = ~Mut, y = ~MutSpec, color = ~realm, type = "box")
fig <- plot_ly(mut_data_ff, x = ~Mut, y = ~MutSpec, color = ~realm, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, fill = realm))+
geom_boxplot()
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec))+
geom_boxplot()
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, , fill = realm))+
geom_boxplot()
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, fill = realm))+
geom_boxplot()
ggplot(data = mut_data_ff, aes(x = Mut, y = MutSpec, fill = Trophic_niche))+
geom_boxplot()
fig <- plot_ly(mut_data_ff, x = ~Mut, y = ~MutSpec, type = "box")
fig
fig <- plot_ly(mut_data_ff, x = ~Mut, y = ~MutSpec, color = ~Trophic_niche, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
rm(list=ls(all=TRUE))
library(ggplot2)
library(plotly)
#four-fold mutations
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
unique(mut_data$AltNode)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
names(mut_data_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_ff = merge(mut_data_ff, ecozone_data, by = 'species_name')
mut_data_ff$MutSpec =  as.numeric(mut_data_ff$MutSpec)
View(mut_data_ff)
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AG = mut_data_ff[mut_data_ff$Mut == 'A>G',]
AT = mut_data_ff[mut_data_ff$Mut == 'A>T',]
GC = mut_data_ff[mut_data_ff$Mut == 'G>C',]
GT = mut_data_ff[mut_data_ff$Mut == 'G>T',]
GA = mut_data_ff[mut_data_ff$Mut == 'G>A',]
CG = mut_data_ff[mut_data_ff$Mut == 'C>G',]
CT = mut_data_ff[mut_data_ff$Mut == 'C>T',]
CA = mut_data_ff[mut_data_ff$Mut == 'C>A',]
TG = mut_data_ff[mut_data_ff$Mut == 'T>G',]
TC = mut_data_ff[mut_data_ff$Mut == 'T>C',]
TA = mut_data_ff[mut_data_ff$Mut == 'T>A',]
replace(AC$Mut, 'A>C', 'T>G')
AC$Mut = replace(AC$Mut, 'A>C', 'T>G')
View(AC)
AC = replace(AC, 'A>C', 'T>G')
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AC = replace(AC$Mut, 'A>C', 'T>G')
AC$mut = replace(AC, 'A>C', 'T>G')
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AC$mut = replace(AC, 'A>C', 'T>G')
View(AC)
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AC = replace(AC, 'A>C', 'T>G')
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AC = replace(AC$Mut, 'A>C', 'T>G')
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AC = AC[,c(1,3,4,5,6,7,8,9,10)]
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AC = replace(AC, 'A>C', 'T>G')
AC = AC[,c(1,3,4,5,6,7,8,9,10)]
names(AC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AC = replace(AC, 'A>C', 'T>G')
AC = AC[,c(1,3,4,5,6,7,8,9,10)]
names(AC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AG = mut_data_ff[mut_data_ff$Mut == 'A>G',]
AT = mut_data_ff[mut_data_ff$Mut == 'A>T',]
GC = mut_data_ff[mut_data_ff$Mut == 'G>C',]
GT = mut_data_ff[mut_data_ff$Mut == 'G>T',]
GA = mut_data_ff[mut_data_ff$Mut == 'G>A',]
CG = mut_data_ff[mut_data_ff$Mut == 'C>G',]
CT = mut_data_ff[mut_data_ff$Mut == 'C>T',]
CA = mut_data_ff[mut_data_ff$Mut == 'C>A',]
TG = mut_data_ff[mut_data_ff$Mut == 'T>G',]
TC = mut_data_ff[mut_data_ff$Mut == 'T>C',]
TA = mut_data_ff[mut_data_ff$Mut == 'T>A',]
AC = replace(AC, 'A>C', 'T>G')
AC = AC[,c(1,3,4,5,6,7,8,9,10)]
names(AC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AG = replace(AG, 'A>G', 'T>C')
AG = AG[,c(1,3,4,5,6,7,8,9,10)]
names(AG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AT = replace(AT, 'A>T', 'T>A')
AT = AT[,c(1,3,4,5,6,7,8,9,10)]
names(AT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GC = replace(GC, 'G>C', 'C>G')
GC = GC[,c(1,3,4,5,6,7,8,9,10)]
names(GC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GT = replace(GT, 'G>T', 'C>A')
GT = GT[,c(1,3,4,5,6,7,8,9,10)]
names(GT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GA = replace(GA, 'G>A', 'C>T')
GA = GA[,c(1,3,4,5,6,7,8,9,10)]
names(GA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CG = replace(CG, 'C>G', 'G>C')
CG = CG[,c(1,3,4,5,6,7,8,9,10)]
names(CG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CT = replace(CT, 'C>T', 'G>A')
CT = CT[,c(1,3,4,5,6,7,8,9,10)]
names(CT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CA = replace(CA, 'C>A', 'G>T')
CA = CA[,c(1,3,4,5,6,7,8,9,10)]
names(CA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TG = replace(TG, 'T>G', 'A>C')
TG = TG[,c(1,3,4,5,6,7,8,9,10)]
names(TG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TC = replace(TC, 'T>C', 'A>G')
TC = TC[,c(1,3,4,5,6,7,8,9,10)]
names(TC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TA = replace(TA, 'T>A', 'A>T')
TA = TA[,c(1,3,4,5,6,7,8,9,10)]
names(TA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
mut_data_ff1 = merge(AC, AG, AT, GC, GT, GA, CT, CA, CG, TA, TG, TC)
mut_data_ff1 = rbind(AC, AG, AT, GC, GT, GA, CT, CA, CG, TA, TG, TC)
View(mut_data_ff1)
fig <- plot_ly(mut_data_ff1, x = ~Mut, y = ~MutSpec, color = ~Trophic_niche, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
fig <- plot_ly(mut_data_ff1, x = ~Mut, y = ~MutSpec, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
fig <- plot_ly(mut_data_ff1, x = ~Mut, y = ~MutSpec, color = ~Trophic_niche, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
fig <- plot_ly(mut_data_ff1, x = ~Mut, y = ~MutSpec, color = ~realm, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
#PCA work
library(ggbiplot)
View(mut_data_ff1)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
View(pca_data)
stats_pca = prcomp(pca_data[c(2)], center = TRUE, scale. = TRUE)
View(stats_pca)
summary(stats_pca)
stats_pca = prcomp(pca_data[c(2, 5)], center = TRUE, scale. = TRUE)
rm(list=ls(all=TRUE))
library(ggplot2)
library(plotly)
#four-fold mutations
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
#192 mutspec
mut_data_192 = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec192.tsv", header = TRUE, fill = TRUE)
View(mut_data_192)
mut_data_192_ff = mut_data_192[mut_data_192$Label == 'ff',]
View(mut_data_192_ff)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
View(mut_data_ff)
mut_data_192_ff = mut_data_192_ff[[,c(1,2,3,4,5,7,8)]]
mut_data_192_ff = mut_data_192_ff[,c(1,2,3,4,5,7,8)]
View(mut_data_192_ff)
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_192_ff = mut_data_192_ff[!grepl('Node', mut_data_192_ff$AltNode),]
View(mut_data_ff)
View(mut_data_192_ff)
names(mut_data_192_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_192_ff = merge(mut_data_192_ff, ecozone_data, by = 'species_name')
mut_data_192_ff$MutSpec =  as.numeric(mut_data_192_ff$MutSpec)
fig <- plot_ly(mut_data_192_ff, x = ~Mut, y = ~MutSpec, color = ~realm, type = "box")
fig <- fig %>% layout(boxmode = "group")
fig
rm(list=ls(all=TRUE))
library(ggplot2)
library(plotly)
#four-fold mutations
df_mtdna = read.csv('../../Head/2Scripts/Birds_dataset_paper.csv')
mut_data = read.table("C:/Users/User/Desktop/Birds mutspec results from Bogdan/mutspec12.tsv", header = TRUE, fill = TRUE)
mut_data_ff = mut_data[mut_data$Label == 'ff',]
mut_data_ff = mut_data_ff[,c(1,2,3,4,5,7,8)]
ecozone_data = df_mtdna[,c('species_name', 'realm', 'Trophic_niche')]
ecozone_data = unique(ecozone_data)
ecozone_data$species_name = gsub(' ', '_', ecozone_data$species_name)
mut_data_ff = mut_data_ff[!grepl('Node', mut_data_ff$AltNode),]
names(mut_data_ff) = c('Mut', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'species_name', 'Label')
mut_data_ff = merge(mut_data_ff, ecozone_data, by = 'species_name')
mut_data_ff$MutSpec =  as.numeric(mut_data_ff$MutSpec)
AC = mut_data_ff[mut_data_ff$Mut == 'A>C',]
AG = mut_data_ff[mut_data_ff$Mut == 'A>G',]
AT = mut_data_ff[mut_data_ff$Mut == 'A>T',]
GC = mut_data_ff[mut_data_ff$Mut == 'G>C',]
GT = mut_data_ff[mut_data_ff$Mut == 'G>T',]
GA = mut_data_ff[mut_data_ff$Mut == 'G>A',]
CG = mut_data_ff[mut_data_ff$Mut == 'C>G',]
CT = mut_data_ff[mut_data_ff$Mut == 'C>T',]
CA = mut_data_ff[mut_data_ff$Mut == 'C>A',]
TG = mut_data_ff[mut_data_ff$Mut == 'T>G',]
TC = mut_data_ff[mut_data_ff$Mut == 'T>C',]
TA = mut_data_ff[mut_data_ff$Mut == 'T>A',]
AC = replace(AC, 'A>C', 'T>G')
AC = AC[,c(1,3,4,5,6,7,8,9,10)]
names(AC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AG = replace(AG, 'A>G', 'T>C')
AG = AG[,c(1,3,4,5,6,7,8,9,10)]
names(AG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
AT = replace(AT, 'A>T', 'T>A')
AT = AT[,c(1,3,4,5,6,7,8,9,10)]
names(AT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GC = replace(GC, 'G>C', 'C>G')
GC = GC[,c(1,3,4,5,6,7,8,9,10)]
names(GC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GT = replace(GT, 'G>T', 'C>A')
GT = GT[,c(1,3,4,5,6,7,8,9,10)]
names(GT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
GA = replace(GA, 'G>A', 'C>T')
GA = GA[,c(1,3,4,5,6,7,8,9,10)]
names(GA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CG = replace(CG, 'C>G', 'G>C')
CG = CG[,c(1,3,4,5,6,7,8,9,10)]
names(CG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CT = replace(CT, 'C>T', 'G>A')
CT = CT[,c(1,3,4,5,6,7,8,9,10)]
names(CT) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
CA = replace(CA, 'C>A', 'G>T')
CA = CA[,c(1,3,4,5,6,7,8,9,10)]
names(CA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TG = replace(TG, 'T>G', 'A>C')
TG = TG[,c(1,3,4,5,6,7,8,9,10)]
names(TG) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TC = replace(TC, 'T>C', 'A>G')
TC = TC[,c(1,3,4,5,6,7,8,9,10)]
names(TC) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
TA = replace(TA, 'T>A', 'A>T')
TA = TA[,c(1,3,4,5,6,7,8,9,10)]
names(TA) = c('species_name', 'ObsNum', 'ExpNum', 'RawMutSpec', 'MutSpec', 'Label', 'realm', 'Trophic_niche', 'Mut')
mut_data_ff1 = rbind(AC, AG, AT, GC, GT, GA, CT, CA, CG, TA, TG, TC)
View(mut_data_ff1)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
View(pca_data)
library(reshape2)
pca_data = mut_data_ff1[,c(1,5,9)]
pca_data = mut_data_ff1[,c(5,9)]
x2 = melt(pca_data)
View(x2)
x3 = cast(x2, variable ~ Mut)
#PCA work
install.packages(tidyr)
#PCA work
install.packages("tidyr")
install.packages("tidyr")
library(tidyr)
pca_data = mut_data_ff1[,c(5,9)]
x4 = spread(pca_data[-1], Mut, MutSpec)
#PCA work
install.packages("tidyverse")
install.packages("tidyverse")
pca_data = mut_data_ff1[,c(1,5,9)]
x4 = spread(pca_data[-1], Mut, MutSpec)
library(data.table)
x5 = dcast.data.table(setDT(pca_data), seq + detailed.name~Mut,
value.var='MutSpec')
x5 = dcast.data.table(setDT(pca_data), species_name + detailed.name~Mut,
value.var='MutSpec')
x5 = dcast.data.table(setDT(pca_data), species_name~Mut,
value.var='MutSpec')
View(x5)
pca_data = mut_data_ff1[,c(1,5,7,8,9)]
x5 = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
View(x5)
pca_data_shaped = dcast.data.table(setDT(pca_data), species_name+realm+Trophic_niche~Mut,
value.var='MutSpec')
stats_pca = prcomp(pca_data_shaped[c(4:15)], center = TRUE, scale. = TRUE)
typeof(pca_data_shaped$`A>C`)
pca_data_shaped$`A>C` = as.numeric(pca_data_shaped$`A>C`)
pca_data_shaped$`A>C` = as.numeric(pca_data_shaped$`A>C`)
pca_data_shaped$`A>G` = as.numeric(pca_data_shaped$`A>G`)
pca_data_shaped$`A>T` = as.numeric(pca_data_shaped$`A>T`)
pca_data_shaped$`C>A` = as.numeric(pca_data_shaped$`C>A`)
pca_data_shaped$`C>G` = as.numeric(pca_data_shaped$`C>G`)
pca_data_shaped$`C>T` = as.numeric(pca_data_shaped$`C>T`)
pca_data_shaped$`G>A` = as.numeric(pca_data_shaped$`G>A`)
pca_data_shaped$`G>C` = as.numeric(pca_data_shaped$`G>C`)
pca_data_shaped$`G>T` = as.numeric(pca_data_shaped$`G>T`)
pca_data_shaped$`T>A` = as.numeric(pca_data_shaped$`T>A`)
pca_data_shaped$`T>C` = as.numeric(pca_data_shaped$`T>C`)
pca_data_shaped$`T>G` = as.numeric(pca_data_shaped$`T>G`)
stats_pca = prcomp(pca_data_shaped[c(4:15)], center = TRUE, scale. = TRUE)
View(pca_data_shaped)
stats_pca = prcomp(pca_data_shaped[c(4,5,6,7,8,9,10,11,12,13,14,15)], center = TRUE, scale. = TRUE)
stats_pca = prcomp(pca_data_shaped[c(4,5,6,7,8,9,10,11,12,13,14,15),], center = TRUE, scale. = TRUE)
stats_pca = prcomp(pca_data_shaped[,c(4,5,6,7,8,9,10,11,12,13,14,15)], center = TRUE, scale. = TRUE)
summary(stats_pca)
bipl = ggbiplot(stats_pca, groups = pca_data_shaped$realm, labels = pca_data_shaped$species_name, labels.size = 2)
#PCA work
library(ggbiplot)
bipl = ggbiplot(stats_pca, groups = pca_data_shaped$realm, labels = pca_data_shaped$species_name, labels.size = 2)
bipl
ggplotly(bipl)
bipl1 = ggbiplot(stats_pca, groups = pca_data_shaped$Trophic_niche, labels = pca_data_shaped$species_name, labels.size = 2)
bipl1
ggplotly(bipl1)
bipl2 = ggbiplot(stats_pca, groups = pca_data_shaped$realm, labels.size = 2)
bipl2
ggplotly(bipl2)
bipl3 = ggbiplot(stats_pca, groups = pca_data_shaped$Trophic_niche, labels.size = 2)
bipl3
ggplotly(bipl3)
