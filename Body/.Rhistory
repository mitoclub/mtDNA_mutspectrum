rm(list=ls(all=TRUE))
if (!require(ggpubr)) install.packages("ggpubr")
library("ggpubr")
###########Taxonomy###################################################################
Taxa = read.table("../../Body/1Raw/TaxaFromKostya.Names.stat", sep = '\t',header = FALSE)
Taxa$Species = gsub(";.*",'',Taxa$V1);
for (i in (1:nrow(Taxa)))  {Taxa$Species[i] = paste(unlist(strsplit(as.character(Taxa$Species[i]),split = ' '))[1],unlist(strsplit(as.character(Taxa$Species[i]),split = ' '))[2], sep = '_')}
Taxa$Class = gsub(";Chordata;.*",'',Taxa$V1); Taxa$Class = gsub(".*;",'',Taxa$Class); table(Taxa$Class)
Taxa$Class = gsub('Actinopteri','Actinopterygii',Taxa$Class)
Taxa$Class = gsub("Testudines|Squamata|Crocodylia|Sphenodontia",'Reptilia',Taxa$Class)
length(unique(Taxa$Species)) # 1708
table(Taxa$Class)
Taxa = Taxa[,-1]
TaxaMore = read.table("../../Body/1Raw/TaxaFromKostya.2NeedTaxa.tax.txt", sep = '\t',header = FALSE)
TaxaMore$Species = ''
for (i in (1:nrow(TaxaMore)))
{TaxaMore$Species[i] = paste(unlist(strsplit(as.character(TaxaMore$V1[i]),split = ' '))[1],unlist(strsplit(as.character(TaxaMore$V1[i]),split = ' '))[2], sep = '_')}
TaxaMore$Class = gsub("; Chordata;.*",'',TaxaMore$V2);
TaxaMore$Class = gsub(".*; ",'',TaxaMore$Class);
TaxaMore$Class = gsub('Actinopteri','Actinopterygii',TaxaMore$Class)
TaxaMore$Class = gsub("Testudines|Squamata|Crocodylia",'Reptilia',TaxaMore$Class)
table(TaxaMore$Class)
TaxaMore = TaxaMore[,-c(1,2)]
Taxa = rbind(Taxa,TaxaMore); Taxa = unique(Taxa)
###########################MUT spectrum in Actinoptery##################################
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
MUTACTINOPTERITAXAFROMK = merge(MUT, Taxa)
MUTSPEC= MUTACTINOPTERITAXAFROMK
MUTACTINOPTERITAXAFROMK = MUTACTINOPTERITAXAFROMK[MUTACTINOPTERITAXAFROMK$Class == "Actinopterygii",]
MUTACTINOPTERITAXAFROMK=MUTACTINOPTERITAXAFROMK[,-c(1,14)]
temp = data.frame(t(MUTACTINOPTERITAXAFROMK))
a=c()
for(i in 1:ncol(temp)){
b = data.frame(temp[i], rownames(temp))
colnames(b)=c("Freq", "Sub")
a = rbind(a, b)
}
n=names(MUTACTINOPTERITAXAFROMK)
m=c()
i="A_T"
for(i in n){
t=c(i, gsub(":", "", strsplit(summary(MUTACTINOPTERITAXAFROMK[i])[4], split=" ")[[1]][4]))
m=rbind(m, t)
}
m=data.frame(m, row.names = NULL)
summary(MUTACTINOPTERITAXAFROMK)
ggbarplot(a, x = "Sub", y = "Freq", fill = "Sub", color = "Sub",
palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", add = "mean_se", legend = "none")
ggbarplot(a, x = "Sub", y = "Freq", fill = "Sub", color = "Sub",
palette = c("#bdbdbd", "#036A5B", "#bdbdbd", "#bdbdbd", "#bdbdbd", " #73514F", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9C3D37", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", add = "mean_se", legend = "none")
ggbarplot(a, x = "Sub", y = "Freq", fill = "Sub", color = "Sub",
palette = c("#bdbdbd", "#036A5B", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514F", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9C3D37", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", add = "mean_se", legend = "none")
#c("TH>GH", "TH>CH", "TH>AH", "GH>TH", "GH>CH", "GH>AH", "CH>TH", "CH>GH", "CH>AH", "AH>TH", "AH>GH", "AH>CH")
pdf("../../Body/4Figures/VertebratePolymorphisms.MutSpecComparisons.Analyses.Ecology.Actinopterygii.FishBaseData.FIGURE1A.pdf")
ggbarplot(a, x = "Sub", y = "Freq", fill = "Sub", color = "Sub",
palette = c("#bdbdbd", "#036A5B", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514F", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9C3D37", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", add = "mean_se", legend = "none")
dev.off()
rm(list=ls(all=TRUE))
if (!require(ggpubr)) install.packages("ggpubr")
library("ggpubr")
###########Taxonomy###################################################################
Taxa = read.table("../../Body/1Raw/TaxaFromKostya.Names.stat", sep = '\t',header = FALSE)
Taxa$Species = gsub(";.*",'',Taxa$V1);
for (i in (1:nrow(Taxa)))  {Taxa$Species[i] = paste(unlist(strsplit(as.character(Taxa$Species[i]),split = ' '))[1],unlist(strsplit(as.character(Taxa$Species[i]),split = ' '))[2], sep = '_')}
Taxa$Class = gsub(";Chordata;.*",'',Taxa$V1); Taxa$Class = gsub(".*;",'',Taxa$Class); table(Taxa$Class)
Taxa$Class = gsub('Actinopteri','Actinopterygii',Taxa$Class)
Taxa$Class = gsub("Testudines|Squamata|Crocodylia|Sphenodontia",'Reptilia',Taxa$Class)
length(unique(Taxa$Species)) # 1708
table(Taxa$Class)
Taxa = Taxa[,-1]
TaxaMore = read.table("../../Body/1Raw/TaxaFromKostya.2NeedTaxa.tax.txt", sep = '\t',header = FALSE)
TaxaMore$Species = ''
for (i in (1:nrow(TaxaMore)))
{TaxaMore$Species[i] = paste(unlist(strsplit(as.character(TaxaMore$V1[i]),split = ' '))[1],unlist(strsplit(as.character(TaxaMore$V1[i]),split = ' '))[2], sep = '_')}
TaxaMore$Class = gsub("; Chordata;.*",'',TaxaMore$V2);
TaxaMore$Class = gsub(".*; ",'',TaxaMore$Class);
TaxaMore$Class = gsub('Actinopteri','Actinopterygii',TaxaMore$Class)
TaxaMore$Class = gsub("Testudines|Squamata|Crocodylia",'Reptilia',TaxaMore$Class)
table(TaxaMore$Class)
TaxaMore = TaxaMore[,-c(1,2)]
Taxa = rbind(Taxa,TaxaMore); Taxa = unique(Taxa)
#########################################################################################
###########################MUT spectrum in Actinoptery##################################
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
MUTACTINOPTERITAXAFROMK = merge(MUT, Taxa)
MUTSPEC= MUTACTINOPTERITAXAFROMK
MUTACTINOPTERITAXAFROMK = MUTACTINOPTERITAXAFROMK[MUTACTINOPTERITAXAFROMK$Class == "Actinopterygii",]
#names(MUTACTINOPTERITAXAFROMK) = c("T_G", "T_C", "T_A", "G_T", "G_C", "G_A", "C_T", "C_G", "C_A", "A_T", "A_G", "A_C")
########Supplementary table 1
View(MUTACTINOPTERITAXAFROMK)
#names(MUTACTINOPTERITAXAFROMK) = c("T_G", "T_C", "T_A", "G_T", "G_C", "G_A", "C_T", "C_G", "C_A", "A_T", "A_G", "A_C")
########Supplementary table 1
MUTACTINOPTERITAXAFROMK = MUTACTINOPTERITAXAFROMK[order(MUTACTINOPTERITAXAFROMK$T_C),]
write.table(MUTACTINOPTERITAXAFROMK, file = "../../Body/2Derived/Supplementary_table_3_ordered_by_A_G.txt", row.names = FALSE)
source("https://bioconductor.org/biocLite.R")
biocLite("Biostrings")
library("Biostrings")
library("seqinr")
rm(list=ls(all=TRUE))
library("Biostrings")
biocLite("Biostrings")
source("https://bioconductor.org/biocLite.R")
biocLite("Biostrings")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.13")
library("Biostrings")
library(BiocManager)
CytBRefSeq <- readDNAStringSet('Body/1Raw/CytB.fasta')
BiocManager::install("Biostrings")
CytBRefSeq <- readDNAStringSet('Body/1Raw/CytB.fasta')
library("Biostrings")
CytBRefSeq <- readDNAStringSet('Body/1Raw/CytB.fasta')
CytBRefSeq <- 'Body/1Raw/CytB.fasta'
CytBRefSeq <- readDNAStringSet(CytBRefSeq)
file <- system.file("extdata", "Body/1Raw/CytB.fasta", package="Biostrings")
CytBRefSeq <- readDNAStringSet(file)
file <- system.file(package="Biostrings", "extdata", "Body/1Raw/CytB.fasta")
CytBRefSeq <- readDNAStringSet(file)
file
file <- system.file("Body/1Raw/CytB.fasta")
file
file <- "Body/1Raw/CytB.fasta"
CytBRefSeq <- readDNAStringSet(file)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
library("Biostrings")
file <- "Body/1Raw/CytB.fasta"
CytBRefSeq <- readDNAStringSet(file)
getwd()
file <- "../../CytB.fasta"
CytBRefSeq <- readDNAStringSet(file)
test <- read.table("AminoAcidTranslation.txt")
test <- read.table("Body/1Raw/AminoAcidTranslation.txt")
getwd()
test <- read.table("C:/Users/polar/Documents/mtDNA_mutspectrum/1Raw/AminoAcidTranslation.txt")
test <- read.table("C://Users/polar/Documents/mtDNA_mutspectrum/1Raw/AminoAcidTranslation.txt")
test <- read.table("C:\Users\polar\Documents\mtDNA_mutspectrum\1Raw\AminoAcidTranslation.txt")
test <- read.table("C:\\Users\\polar\\Documents\\mtDNA_mutspectrum\\1Raw\\AminoAcidTranslation.txt")
getwd()
setwd("C:/Users/polar/Documents/mtDNA_mutspectrum/Body")
getwd()
test <- read.table("1Raw/AminoAcidTranslation.txt")
file <- "1Raw/CytB.fasta"
CytBRefSeq <- readDNAStringSet(file)
CytBRefSeq
View(CytBRefSeq)
CytBRefSeq <- data.frame(CytBRefSeq)
View(CytBRefSeq)
View(CytBRefSeq)
CytBRefSeq <- readBStringSet(file)
View(CytBRefSeq)
CytBRefSeq <- data.frame(CytBRefSeq); names(CytBRefSeq) = c('Sequence')
View(CytBRefSeq)
CytBRefSeq <- read.table(file)
CytBRefSeq <- read.table(file)
View(CytBRefSeq)
CytBRefSeq <- read.table(file, sep = ">")
View(CytBRefSeq)
CytBRefSeq <- read.table(file, sep = ">")
CytBRefSeq <- read.table(file, sep = "/n")
CytBRefSeq <- read.table(file, sep = "\n")
View(CytBRefSeq)
library("seqinr")
install.packages("seqinr")
library("seqinr")
CytBRefSeq <- read.fasta(file)
View(CytBRefSeq)
CytBRefSeq <- data.frame(CytBRefSeq);
View(CytBRefSeq)
CytBRefSeq <- data.frame(CytBRefSeq)
table(CytBRefSeq)
CytBRefSeq <- read.fasta(file)
table(CytBRefSeq)
View(CytBRefSeq)
name(CytBRefSeq)
View(CytBRefSeq)
CytBRefSeq[1]
CytBRefSeq[1][1]
CytBRefSeq[[1][1]
CytBRefSeq[[1]][1]
View(CytBRefSeq)
CytBRefSeq[[2]]
str(CytBRefSeq)
CytBRefSeq$Abalistes_stellaris
unlist(CytBRefSeq$Abalistes_stellaris)
a <- unlist(CytBRefSeq$Abalistes_stellaris)
a
a <- collapse(CytBRefSeq$Abalistes_stellaris)
a <- CytBRefSeq$Abalistes_stellaris
a
a <- length(CytBRefSeq$Abalistes_stellaris)
a
l <- length(CytBRefSeq$Abalistes_stellaris)
c(1:l)
CytBRefSeq$Abalistes_stellaris[c(1:l)]
v
v <- collapse(CytBRefSeq$Abalistes_stellaris[c(1:l)])
v <- paste(CytBRefSeq$Abalistes_stellaris[c(1:l)], collapse = "")
v
CytBRefSeq[[1,2]]
CytBRefSeq[[с(1,2)]]
с(1,2
CytBRefSeq[[c(1,2)]]
CytBRefSeq["names"]
CytBRefSeq <- read.fasta(file, seqtype = "AA", as.string = TRUE, set.attributes = FALSE)
CytBRefSeq
names(CytBRefSeq)
CytBRefSeq[1]
CytBRefSeq <- read.fasta(file, as.string = TRUE, set.attributes = FALSE)
names(CytBRefSeq)
CytBRefSeq[1]
test <- translate(CytBRefSeq[1])
CytBRefSeq[1]
str(CytBRefSeq[1])
test <- translate(unlist(CytBRefSeq[1]))
unlist(CytBRefSeq[1])
unlist(CytBRefSeq)
unlist(CytBRefSeq[1])
CytBRefSeq[1]
a <- CytBRefSeq[1]
a
str(a)
test <- translate(а)
str(a)
a <- unlist(a)
str(a)
a
a <- CytBRefSeq[1]
test <- translate(а)
а
a <- CytBRefSeq[1]
test <- translate(а)
a
test <- translate(а)
attr(*, "names")
attr(CytBRefSeq, "names")
names(CytBRefSeq)
SpNames <- names(CytBRefSeq)
SpNames
CytBRefSeq$Abalistes_stellaris
Data=c()
Data=c()
SpNames = "Abalistes_stellaris"
SpNames
CytBRefSeq[Abalistes_stellaris]
CytBRefSeq["Abalistes_stellaris"]
SpNames = "Abalistes_stellaris"
CytBRefSeq[i]
i = "Abalistes_stellaris"
newrow <- c(i, CytBRefSeq[i])
newrow
unlist(newrow)
unlist(newrow)
newrow <- unlist(newrow)
newrow
newrow <- c(i, CytBRefSeq[i])
CytBRefSeq[i]
CytBRefSeq$i
unname(CytBRefSeq[i])
unlist(unname(CytBRefSeq[i]))
newrow <- c(i, unlist(unname(CytBRefSeq[i])))
newrow <- c(i, unlist(unname(CytBRefSeq[i])))
newrow
Data = rbind(Data, newrow)
Data
Data=c()
for (i in SpNames){
Data <- rbind(Data, c(i, unlist(unname(CytBRefSeq[i]))))
}
Data
View(Data)
SpNames
SpNames <- names(CytBRefSeq)
for (i in SpNames){
Data <- rbind(Data, c(i, unlist(unname(CytBRefSeq[i]))))
}
View(Data)
Data = data.frame(Data)
View(Data)
names(Data) <- ("SpeciesName", "AAseq" )
names(Data) <- ("SpeciesName", "AAseq")
names(Data) <- c("SpeciesName", "AAseq")
Data$GeneName <- "CytB"
View(Data)
View(CytBRefSeq)
View(Data)
View(Data)
View(CytBRefSeq)
View(Data)
rm(list=ls(all=TRUE))
setwd("C:/Users/polar/Documents/mtDNA_mutspectrum/Body")
file <- "1Raw/CytB.fasta"
CytBRefSeq <- read.fasta(file, as.string = TRUE, set.attributes = FALSE)
SpNames <- names(CytBRefSeq)
Data=c()
for (i in SpNames){
Data <- rbind(Data, c(i, unlist(unname(CytBRefSeq[i]))))
}
Data = data.frame(Data)
Data
View(Data)
View(CytBRefSeq)
names(Data) <- c("SpeciesName", "AAseq")
Data$SpeciesName[1]
CytBRefSeq$Abalistes_stellaris == Data$SpeciesName[,1]
Data$SpeciesName[,1]
Data[,1]
Data[1,]
Data[1,][2]
Data[1,2]
CytBRefSeq$Abalistes_stellaris
CytBRefSeq$Abalistes_stellaris == Data[1,2]
SpNames
CytBRefSeq$Cynoglossus_abbreviatus == Data[Data$SpeciesName == "Cynoglossus_abbreviatus",]$AAseq
Data$GeneName <- "CytB"
write.table(Data, file = "C:/Users/polar/Documents/mtDNA_mutspectrum/Body/2Derived/AllSpRefseqCytB.txt"
write.table(Data, file = "C:/Users/polar/Documents/mtDNA_mutspectrum/Body/2Derived/AllSpRefseqCytB.txt")
write.table(Data, file = "C:/Users/polar/Documents/mtDNA_mutspectrum/Body/2Derived/AllSpRefseqCytB.txt")
write.table(Data, file = "C:/Users/polar/Documents/mtDNA_mutspectrum/Body/2Derived/AllSpRefseqCytB.txt", row.names = F)
write.table(Data, file = "C:/Users/polar/Documents/mtDNA_mutspectrum/Body/2Derived/VertebratePolymorphisms.AllSpRefseqCytB.txt", row.names = F)
